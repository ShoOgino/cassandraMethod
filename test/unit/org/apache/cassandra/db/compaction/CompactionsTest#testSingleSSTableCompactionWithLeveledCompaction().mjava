    @Test
    public void testSingleSSTableCompactionWithLeveledCompaction() throws Exception
    {
        ColumnFamilyStore store = testSingleSSTableCompaction(LeveledCompactionStrategy.class.getCanonicalName());
        CompactionStrategyManager strategyManager = store.getCompactionStrategyManager();
        // tombstone removal compaction should not promote level
        assert strategyManager.getSSTableCountPerLevel()[0] == 1;
    }

