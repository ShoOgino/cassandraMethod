    private void readParameters(ByteBuf in, ByteBufDataInputPlus inputPlus, int parameterLength, Map<ParameterType, Object> parameters) throws IOException
    {
        // makes the assumption we have all the bytes required to read the headers
        final int endIndex = in.readerIndex() + parameterLength;
        while (in.readerIndex() < endIndex)
        {
            String key = DataInputStream.readUTF(inputPlus);
            ParameterType parameterType = ParameterType.byName.get(key);
            long valueLength =  VIntCoding.readUnsignedVInt(in);
            byte[] value = new byte[Ints.checkedCast(valueLength)];
            in.readBytes(value);
            try (DataInputBuffer buffer = new DataInputBuffer(value))
            {
                parameters.put(parameterType, parameterType.serializer.deserialize(buffer, messagingVersion));
            }
        }
    }

