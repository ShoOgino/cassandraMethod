    private static void assertBytes(ColumnFamilyStore cfs, int gcBefore) throws IOException
    {
        Collection<SSTableReader> sstables = cfs.getSSTables();

        // compare eager and lazy compactions
        AbstractCompactionIterable eager = new CompactionIterable(OperationType.UNKNOWN,
                                                                  sstables,
                                                                  new PreCompactingController(cfs, sstables, gcBefore, false));
        AbstractCompactionIterable lazy = new CompactionIterable(OperationType.UNKNOWN,
                                                                 sstables,
                                                                 new LazilyCompactingController(cfs, sstables, gcBefore, false));
        assertBytes(sstables, eager, lazy);

        // compare eager and parallel-lazy compactions
        eager = new CompactionIterable(OperationType.UNKNOWN,
                                       sstables,
                                       new PreCompactingController(cfs, sstables, gcBefore, false));
        AbstractCompactionIterable parallel = new ParallelCompactionIterable(OperationType.UNKNOWN,
                                                                             sstables,
                                                                             new CompactionController(cfs, sstables, gcBefore, false),
                                                                             0);
        assertBytes(sstables, eager, parallel);
    }

