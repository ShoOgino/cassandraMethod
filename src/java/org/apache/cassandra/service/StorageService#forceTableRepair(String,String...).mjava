    /**
     * Trigger proactive repair for a table and column families.
     * @param tableName
     * @param columnFamilies
     * @throws IOException
     */
    public void forceTableRepair(final String tableName, final String... columnFamilies) throws IOException
    {
        List<AntiEntropyService.RepairSession> sessions = new ArrayList<AntiEntropyService.RepairSession>();
        for (Range range : getLocalRanges(tableName))
        {
            sessions.add(forceTableRepair(range, tableName, columnFamilies));
        }

        boolean failedSession = false;

        // block until all repair sessions have completed
        for (AntiEntropyService.RepairSession sess : sessions)
        {
            try
            {
                sess.join();
            }
            catch (InterruptedException e)
            {
                logger_.error("Repair session " + sess + " failed.", e);
                failedSession = true;
            }
        }

        if (failedSession)
            throw new IOException("Some Repair session(s) failed.");
    }

