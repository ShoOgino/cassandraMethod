    @Test
    public void testCreate() throws UnknownHostException
    {
        AbstractCommutativeType type = CounterColumnType.instance;
        long delta = 3L;
        CounterColumn column = (CounterColumn)type.createColumn(ByteBufferUtil.bytes("x"), FBUtilities.toByteBuffer(delta), 1L);
        assert delta == column.value().getLong(column.value().arrayOffset());
        assert 0 == column.partitionedCounter().length;

        InetAddress node = InetAddress.getByAddress(FBUtilities.toByteArray(1));
        column.update(node);
        assert delta == column.value().getLong(column.value().arrayOffset());
        assert  1 == FBUtilities.byteArrayToInt( column.partitionedCounter(), 0*stepLength);
        assert 1L == FBUtilities.byteArrayToLong(column.partitionedCounter(), 0*stepLength + idLength);
        assert 3L == FBUtilities.byteArrayToLong(column.partitionedCounter(), 0*stepLength + idLength + clockLength);
    }

