    /**
     * usage: java -Dstorage-config="confpath" org.apache.cassandra.client.TestRingCache
     * @param args
     * @throws Exception
     */
    public static void main(String[] args) throws Throwable
    {
        String table = "Keyspace1";
        for (int nRows=1; nRows<10; nRows++)
        {
            String row = "row" + nRows;
            ColumnPath col = createColumnPath("Standard1", null, "col1".getBytes());

            List<InetAddress> endPoints = ringCache.getEndPoint(row);
            String hosts="";
            for (int i = 0; i < endPoints.size(); i++)
                hosts = hosts + ((i > 0) ? "," : "") + endPoints.get(i);
            System.out.println("hosts with key " + row + " : " + hosts + "; choose " + endPoints.get(0));
        
            // now, read the row back directly from the host owning the row locally
            setup(endPoints.get(0).getHostAddress(), DatabaseDescriptor.getThriftPort());
            thriftClient.insert(table, row, col, "val1".getBytes(), 1, ConsistencyLevel.ONE);
            Column column=thriftClient.get(table, row, col, ConsistencyLevel.ONE).column;
            System.out.println("read row " + row + " " + new String(column.name) + ":" + new String(column.value) + ":" + column.timestamp);
        }
        System.exit(1);
    }

