    /**
     * Authenticates a user given a Map<String, String> of credentials.
     * Should never return null - always throw AuthenticationException instead.
     * Returning AuthenticatedUser.ANONYMOUS_USER is an option as well if authentication is not required.
     *
     * @throws AuthenticationException if credentials don't match any known user.
     */
    AuthenticatedUser authenticate(Map<String, String> credentials) throws AuthenticationException;

