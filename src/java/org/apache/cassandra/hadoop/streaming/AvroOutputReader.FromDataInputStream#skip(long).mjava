        @Override
        public long skip(long n) throws IOException
        {
            long skipped = 0;
            while (n > 0)
            {
                // skip in batches up to max_int in size
                int skip = (int)Math.min(Integer.MAX_VALUE, n);
                skipped += in.skipBytes(skip);
                n -= skip;
            }
            return skipped;
        }

