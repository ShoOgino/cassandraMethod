        public void commit()
        {
            if (rows == null)
                return;

            try (OpOrder.Group opGroup = Keyspace.writeOrder.start())
            {
                Index.Indexer[] indexers = Arrays.stream(indexes)
                                                 .map(i -> i.indexerFor(key, nowInSec, opGroup, Type.COMPACTION))
                                                 .toArray(Index.Indexer[]::new);

                Arrays.stream(indexers).forEach(Index.Indexer::begin);

                for (Row row : rows)
                    if (row != null)
                        Arrays.stream(indexers).forEach(indexer -> indexer.removeRow(row));

                Arrays.stream(indexers).forEach(Index.Indexer::finish);
            }
        }

