    // Package protected for use by tests
    static CfDef fromSchemaNoColumnDefinition(ColumnFamily serializedCfDef)
    {
        assert serializedCfDef != null;

        CfDef cfDef = new CfDef();

        AbstractType sysComparator = serializedCfDef.getComparator();

        for (IColumn cfAttr : serializedCfDef.getSortedColumns())
        {
            if (cfAttr == null || cfAttr.isMarkedForDelete())
                continue;

            // column name format is <cf>:<attribute name>
            String[] attr = sysComparator.getString(cfAttr.name()).split(":");
            assert attr.length == 2;

            CfDef._Fields field = CfDef._Fields.findByName(attr[1]);
            cfDef.setFieldValue(field, deserializeValue(cfAttr.value(), getValueClass(CfDef.class, field.getFieldName())));
        }
        return cfDef;
    }

