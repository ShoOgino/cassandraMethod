    /**
     * Returns the next row associated with the smallest key
     * on disk.
     * 
     * @return row of the next smallest key on disk.
     */
    public Row next() throws IOException
    {
        if ( fsQueue_.size() == 0 )
            throw new IllegalStateException("Nothing in the stream to scan.");
    
        Row row = null;          
        FileStruct fs = fsQueue_.poll();   
        
        // Process the key only if it is in the primary range and not a block index.
        if ( StorageService.instance().isPrimary(fs.getKey()) && !fs.getKey().equals(SSTable.blockIndexKey_) )
        {            
            row = Table.open(table_).get(fs.getKey());                
        }
        
        doCorrections(fs.getKey());        
        long bytesRead = fs.advance();
        if ( bytesRead != -1L )
            fsQueue_.add(fs);
        return row;
    }

