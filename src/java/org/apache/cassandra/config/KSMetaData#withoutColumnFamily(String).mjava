    /**
     * Copies this KSMetaData, removing the ColumnFamily with the given name (which must exist).
     */
    public KSMetaData withoutColumnFamily(String cfName)
    {
        CFMetaData cfm = cfMetaData().get(cfName);
        List<CFMetaData> newCfs = new ArrayList<CFMetaData>(cfMetaData().values());
        newCfs.remove(cfm);
        assert newCfs.size() == cfMetaData().size() - 1;
        return new KSMetaData(name, strategyClass, replicationFactor, usersAccess, groupsAccess, newCfs.toArray(new CFMetaData[newCfs.size()]));
    }

