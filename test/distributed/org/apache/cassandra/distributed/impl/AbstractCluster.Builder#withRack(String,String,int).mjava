        public Builder<I, C> withRack(String dcName, String rackName, int nodesInRack)
        {
            if (nodeIdTopology == null)
            {
                if (nodeCount > 0)
                    throw new IllegalStateException("Node count must not be explicitly set, or allocated using withDCs/withRacks");

                nodeIdTopology = new HashMap<>();
            }
            for (int nodeId = nodeCount + 1; nodeId <= nodeCount + nodesInRack; nodeId++)
                nodeIdTopology.put(nodeId, Pair.create(dcName, rackName));

            nodeCount += nodesInRack;
            return this;
        }

