    // Returns a future on the local application of the schema
    private static void announce(Collection<Mutation> schema)
    {
        Future<?> f = StageManager.getStage(Stage.MIGRATION).submit(() -> Schema.instance.mergeAndAnnounceVersion(schema));

        for (InetAddressAndPort endpoint : Gossiper.instance.getLiveMembers())
            if (shouldPushSchemaTo(endpoint))
                pushSchemaMutation(endpoint, schema);

        FBUtilities.waitOnFuture(f);
    }

