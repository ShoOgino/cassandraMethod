    /**
     * Setup and return a new Thrift RPC connection.
     *
     * @param hostName hostname or address to connect to
     * @param port port number to connect to
     * @param framed wrap with framed transport if true
     * @return a CassandraClient instance
     * @throws ShuffleError
     */
    public static CassandraClient getThriftClient(String hostName, int port, boolean framed) throws ShuffleError
    {
        try
        {
            return new CassandraClient(hostName, port, framed);
        }
        catch (TTransportException e)
        {
            throw new ShuffleError(String.format("Unable to connect to %s/%d: %s", hostName, port, e.getMessage()));
        }
    }

