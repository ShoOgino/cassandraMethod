    public Collection<SSTableReader> flush()
    {
        long estimatedSize = estimatedSize();
        Directories.DataDirectory dataDirectory = cfs.getDirectories().getWriteableLocation(estimatedSize);
        if (dataDirectory == null)
            throw new RuntimeException("Insufficient disk space to write " + estimatedSize + " bytes");
        File sstableDirectory = cfs.getDirectories().getLocationForDisk(dataDirectory);
        assert sstableDirectory != null : "Flush task is not bound to any disk";
        return writeSortedContents(sstableDirectory);
    }

