        private void add(Unfiltered unfiltered) throws IOException
        {
            lastClustering.copy(unfiltered.clustering());
            boolean isMarker = unfiltered.kind() == Unfiltered.Kind.RANGE_TOMBSTONE_MARKER;

            if (firstClustering == null)
            {
                // Beginning of an index block. Remember the start and position
                firstClustering = lastClustering.get().takeAlias();
                startPosition = currentPosition();
            }

            UnfilteredSerializer.serializer.serialize(unfiltered, header, writer.stream, version);
            ++written;

            if (isMarker)
            {
                RangeTombstoneMarker marker = (RangeTombstoneMarker) unfiltered;
                openMarker = marker.isOpen(false) ? marker.openDeletionTime(false) : null;
            }

            // if we hit the column index size that we have to index after, go ahead and index it.
            if (currentPosition() - startPosition >= DatabaseDescriptor.getColumnIndexSize())
                addIndexBlock();
        }

