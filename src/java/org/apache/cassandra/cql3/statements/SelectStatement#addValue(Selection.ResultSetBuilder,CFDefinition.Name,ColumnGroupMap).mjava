    private static void addValue(Selection.ResultSetBuilder result, CFDefinition.Name name, ColumnGroupMap group)
    {
        if (group == null)
        {
            result.add((ByteBuffer)null);
            return;
        }

        if (name.type.isCollection())
        {
            List<Pair<ByteBuffer, Column>> collection = group.getCollection(name.name.key);
            result.add(collection == null ? null : ((CollectionType)name.type).serialize(collection));
        }
        else
        {
            result.add(group.getSimple(name.name.key));
        }
    }

