    /**
     * Determines the endpoints that are going to become responsible for data due to
     * a node leaving the cluster.
     *
     * @param endpoint the node that is leaving the cluster
     * @return A set of endpoints
     */
    private Set<InetAddress> getNewEndpoints(InetAddress endpoint)
    {
        Set<InetAddress> newEndpoints = new HashSet<InetAddress>();

        for (String table : DatabaseDescriptor.getNonSystemTables())
        {
            // get all ranges that change ownership (that is, a node needs
            // to take responsibility for new range)
            Multimap<Range, InetAddress> changedRanges = getChangedRangesForLeaving(table, endpoint);
            newEndpoints.addAll(changedRanges.values());
        }
        return newEndpoints;
    }

