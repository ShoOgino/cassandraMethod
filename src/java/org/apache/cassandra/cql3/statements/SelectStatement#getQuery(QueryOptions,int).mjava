    public ReadQuery getQuery(QueryOptions options, int nowInSec) throws RequestValidationException
    {
        DataLimits limit = getLimit(options);
        if (restrictions.isKeyRange() || restrictions.usesSecondaryIndexing())
            return getRangeCommand(options, limit, nowInSec);

        return getSliceCommands(options, limit, nowInSec);
    }

