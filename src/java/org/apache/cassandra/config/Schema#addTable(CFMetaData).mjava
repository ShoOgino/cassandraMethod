    public void addTable(CFMetaData cfm)
    {
        assert getCFMetaData(cfm.ksName, cfm.cfName) == null;

        update(cfm.ksName, ks ->
        {
            load(cfm);

            // make sure it's init-ed w/ the old definitions first,
            // since we're going to call initCf on the new one manually
            Keyspace.open(cfm.ksName);

            return ks.withSwapped(ks.tables.with(cfm));
        });

        Keyspace.open(cfm.ksName).initCf(cfm.cfId, cfm.cfName, true);
        MigrationManager.instance.notifyCreateColumnFamily(cfm);
    }

