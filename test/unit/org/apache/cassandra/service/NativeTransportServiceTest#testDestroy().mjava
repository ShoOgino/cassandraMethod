    @Test
    public void testDestroy()
    {
        withService((NativeTransportService service) -> {
            Supplier<Boolean> allTerminated = () ->
                                              service.getWorkerGroup().isShutdown() && service.getWorkerGroup().isTerminated() &&
                                              service.getEventExecutor().isShutdown() && service.getEventExecutor().isTerminated();
            assertFalse(allTerminated.get());
            service.destroy();
            assertTrue(allTerminated.get());
        });
    }

