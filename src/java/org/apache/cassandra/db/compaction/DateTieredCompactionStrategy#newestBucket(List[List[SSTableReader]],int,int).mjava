    /**
     * @param buckets list of buckets, sorted from newest to oldest, from which to return the newest bucket within thresholds.
     * @param minThreshold minimum number of sstables in a bucket to qualify.
     * @param maxThreshold maximum number of sstables to compact at once (the returned bucket will be trimmed down to this).
     * @return a bucket (list) of sstables to compact.
     */
    @VisibleForTesting
    static List<SSTableReader> newestBucket(List<List<SSTableReader>> buckets, int minThreshold, int maxThreshold)
    {
        // Skip buckets containing less than minThreshold sstables, and limit other buckets to maxThreshold sstables.
        for (List<SSTableReader> bucket : buckets)
            if (bucket.size() >= minThreshold)
                return trimToThreshold(bucket, maxThreshold);
        return Collections.emptyList();
    }

