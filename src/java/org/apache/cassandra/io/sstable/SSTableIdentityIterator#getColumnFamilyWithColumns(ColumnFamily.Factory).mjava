    public ColumnFamily getColumnFamilyWithColumns(ColumnFamily.Factory containerFactory)
    {
        ColumnFamily cf = columnFamily.cloneMeShallow(containerFactory, false);
        // since we already read column count, just pass that value and continue deserialization
        Iterator<OnDiskAtom> iter = cf.metadata().getOnDiskIterator(in, columnCount, flag, expireBefore, dataVersion);
        while (iter.hasNext())
            cf.addAtom(iter.next());

        if (validateColumns)
        {
            try
            {
                cf.metadata().validateColumns(cf);
            }
            catch (MarshalException e)
            {
                throw new RuntimeException("Error validating row " + key, e);
            }
        }
        return cf;
    }

