    /**
     * Checks whether the provided context has a count for the provided
     * CounterId.
     *
     * TODO: since the context is sorted, we could implement a binary search.
     * This is however not called in any critical path and contexts will be
     * fairly small so it doesn't matter much.
     */
    public boolean hasCounterId(ByteBuffer context, CounterId id)
    {
        // we could use a ContextState but it is easy enough that we avoid the object creation
        for (int offset = context.position() + headerLength(context); offset < context.limit(); offset += STEP_LENGTH)
        {
            if (id.equals(CounterId.wrap(context, offset)))
            {
                return true;
            }
        }
        return false;
    }

