    public static byte[] readByteArray(DataInput in) throws IOException
    {
        int length = in.readInt();
        byte[] bytes = new byte[length];
        in.readFully(bytes);
        return bytes;
    }

