    /**
     * Convert a byte buffer to an integer.
     * Does not change the byte buffer position.
     */
    public static int byteBufferToInt(ByteBuffer bytes)
    {
        if (bytes.remaining() < 4)
        {
            throw new IllegalArgumentException("An integer must be 4 bytes in size.");
        }
        int n = 0;
        for (int i = 0; i < 4; ++i)
        {
            n <<= 8;
            n |= bytes.array()[bytes.position() + bytes.arrayOffset() + i] & 0xFF;
        }
        return n;
    }

