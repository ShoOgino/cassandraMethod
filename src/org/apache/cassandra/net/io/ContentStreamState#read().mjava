    public byte[] read() throws IOException, ReadNotCompleteException
    {        
        SocketChannel socketChannel = stream_.getStream();
        InetSocketAddress remoteAddress = (InetSocketAddress)socketChannel.socket().getRemoteSocketAddress();
        String remoteHost = remoteAddress.getHostName();  
        createFileChannel();
        if ( streamContext_ != null )
        {  
            try
            {
                bytesRead_ += fc_.transferFrom(socketChannel, bytesRead_, ContentStreamState.count_);
                if ( bytesRead_ != streamContext_.getExpectedBytes() )
                    throw new ReadNotCompleteException("Specified number of bytes have not been read from the Socket Channel");
            }
            catch ( IOException ex )
            {
                /* Ask the source node to re-stream this file. */
                streamStatus_.setAction(StreamContextManager.StreamCompletionAction.STREAM);                
                handleStreamCompletion(remoteHost);
                /* Delete the orphaned file. */
                File file = new File(streamContext_.getTargetFile());
                file.delete();
                throw ex;
            }
            if ( bytesRead_ == streamContext_.getExpectedBytes() )
            {       
                logger_.debug("Removing stream context " + streamContext_);                 
                handleStreamCompletion(remoteHost);                              
                bytesRead_ = 0L;
                fc_.close();
                morphState();
            }                            
        }
        
        return new byte[0];
    }

