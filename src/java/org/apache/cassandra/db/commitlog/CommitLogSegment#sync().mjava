    /**
     * Forces a disk flush for this segment file.
     */
    public void sync() throws IOException
    {
        buffer.force();
        needsSync = false;
    }

