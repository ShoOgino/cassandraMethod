    /**
     * Return the endpoint responsible for the given key. The selected endpoint
     * one whose token range contains the given key.
     * 
     * @param key
     *            the key being mutated
     * @return the endpoint responsible for that key
     */
    protected InetAddress getEndpoint(byte[] key)
    {
        List<InetAddress> endpoints = ringCache.getEndpoint(key);
        return endpoints != null && endpoints.size() > 0
               ? endpoints.get(0)
               : null;
    }

