    @Override
    public boolean isOnSameRack(InetAddress host, InetAddress host2)
            throws UnknownHostException {
        if (runInBaseMode)
        {
            return super.isOnSameRack(host, host2);
        }
        if (!isInSameDataCenter(host, host2))
        {
            return false;
        }
        return getRackForEndpoint(host).equals(getRackForEndpoint(host2));
    }

