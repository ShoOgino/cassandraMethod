    public void validate(ClientState state) throws InvalidRequestException
    {
        UDFunction.assertUdfsEnabled(language);

        if (ifNotExists && orReplace)
            throw new InvalidRequestException("Cannot use both 'OR REPLACE' and 'IF NOT EXISTS' directives");

        KeyspaceMetadata ksm = Schema.instance.getKeyspaceMetadata(functionName.keyspace);
        if (null == ksm)
            throw new InvalidRequestException(String.format("Cannot add function '%s' to non existing keyspace '%s'.", functionName.name, functionName.keyspace));
        if (ksm.isVirtual())
            throw new InvalidRequestException("Cannot create functions in virtual keyspaces");
    }

