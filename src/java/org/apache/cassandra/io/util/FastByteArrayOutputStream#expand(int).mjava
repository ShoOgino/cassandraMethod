    private void expand(int i) {
        /* Can the buffer handle @i more bytes, if not expand it */
        if (count + i <= buf.length) {
            return;
        }

        long expectedExtent = (count + i) * 2L; //long to deal with possible int overflow
        int newSize = (int) Math.min(Integer.MAX_VALUE - 8, expectedExtent); // MAX_ARRAY_SIZE
        byte[] newbuf = new byte[newSize];
        System.arraycopy(buf, 0, newbuf, 0, count);
        buf = newbuf;
    }

