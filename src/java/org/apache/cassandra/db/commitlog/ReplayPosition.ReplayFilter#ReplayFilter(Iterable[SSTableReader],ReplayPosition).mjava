        public ReplayFilter(Iterable<SSTableReader> onDisk, ReplayPosition truncatedAt)
        {
            for (SSTableReader reader : onDisk)
            {
                ReplayPosition start = reader.getSSTableMetadata().commitLogLowerBound;
                ReplayPosition end = reader.getSSTableMetadata().commitLogUpperBound;
                add(persisted, start, end);
            }
            if (truncatedAt != null)
                add(persisted, ReplayPosition.NONE, truncatedAt);
        }

