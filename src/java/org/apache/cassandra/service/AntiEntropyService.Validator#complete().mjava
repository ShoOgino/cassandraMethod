        /**
         * Depending on the initiator for the validation, either registers
         * trees to be compared locally in AE_SERVICE_STAGE, or remotely.
         */
        public void complete()
        {
            assert ranges != null : "Validator was not prepared()";

            if (range != null)
                range.addHash(EMPTY_ROW);
            while (ranges.hasNext())
            {
                range = ranges.next();
                range.addHash(EMPTY_ROW);
            }
            // add rows with the minimum token to the final range
            if (!minrows.isEmpty())
                for (MerkleTree.RowHash minrow : minrows)
                    range.addHash(minrow);

            StageManager.getStage(AE_SERVICE_STAGE).execute(this);
            logger.debug("Validated " + validated + " rows into AEService tree for " + cf);
        }

