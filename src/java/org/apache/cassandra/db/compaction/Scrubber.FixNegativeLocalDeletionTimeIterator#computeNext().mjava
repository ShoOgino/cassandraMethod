        @Override
        protected OnDiskAtom computeNext()
        {
            if (!iterator.hasNext())
                return endOfData();

            OnDiskAtom next = iterator.next();

            if (next instanceof ExpiringCell && next.getLocalDeletionTime() < 0)
            {
                outputHandler.debug(String.format("Found cell with negative local expiration time: %s", ((ExpiringCell) next).getString(getColumnFamily().getComparator()), getColumnFamily()));
                negativeLocalExpirationTimeMetrics.fixedRows++;
                next = ((Cell) next).localCopy(getColumnFamily().metadata(), HeapAllocator.instance).withUpdatedTimestampAndLocalDeletionTime(next.timestamp() + 1, BufferExpiringCell.MAX_DELETION_TIME);
            }

            return next;
        }

