    public void switchWriter(SSTableWriter newWriter)
    {
        if (writer == null)
        {
            writer = newWriter;
            return;
        }
        // tmp = false because later we want to query it with descriptor from SSTableReader
        SSTableReader reader = writer.closeAndOpenReader(maxAge);
        finished.add(reader);
        replaceReader(currentlyOpenedEarly, reader);
        moveStarts(reader, Functions.constant(reader.last), false);
        currentlyOpenedEarly = null;
        currentlyOpenedEarlyAt = 0;
        writer = newWriter;
    }

