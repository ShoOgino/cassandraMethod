        public void serialize(RowMutation rm, DataOutput out, int version) throws IOException
        {
            if (version < MessagingService.VERSION_20)
                out.writeUTF(rm.getTable());

            ByteBufferUtil.writeWithShortLength(rm.key(), out);

            /* serialize the modifications in the mutation */
            int size = rm.modifications.size();
            out.writeInt(size);
            assert size > 0;
            for (Map.Entry<UUID, ColumnFamily> entry : rm.modifications.entrySet())
                ColumnFamily.serializer.serialize(entry.getValue(), out, version);
        }

