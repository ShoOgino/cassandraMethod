        public void prepare(int flags) throws IOException
        {
            assert !UnfilteredSerializer.isStatic(flags) : "Flags = " + flags;
            this.nextIsRow = UnfilteredSerializer.kind(flags) == Unfiltered.Kind.ROW;
            this.nextKind = nextIsRow ? Kind.CLUSTERING : ClusteringPrefix.Kind.values()[in.readByte()];
            this.nextSize = nextIsRow ? comparator.size() : in.readUnsignedShort();
            this.nextHeader = serializer.readHeader(nextSize, in);
            this.deserializedSize = 0;
        }

