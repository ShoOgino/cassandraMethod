    public Multimap<Range, InetAddress> getRangeAddresses(Map<Token, InetAddress> metadata)
    {
        Multimap<Range, InetAddress> map = HashMultimap.create();

        for (Token token : metadata.keySet())
        {
            Range range = getPrimaryRangeFor(token, metadata);
            for (InetAddress ep : getNaturalEndpoints(token, metadata))
            {
                map.put(range, ep);
            }
        }

        return map;
    }

