    /**
     * Confirms that the client thread has the given Permission in the context of the current Keyspace.
     */
    public void hasKeyspaceAccess(Permission perm) throws InvalidRequestException
    {
        if (user == null)
            throw new InvalidRequestException("You have not logged in");
        if (keyspaceAccess == null)
            throw new InvalidRequestException("You have not set a keyspace for this session");

        hasAccess(user, keyspaceAccess, perm, resource);
    }

