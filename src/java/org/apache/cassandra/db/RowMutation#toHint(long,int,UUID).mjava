    /**
     * Returns mutation representing a Hint to be sent to <code>targetId</code>
     * as soon as it becomes available. See HintedHandoffManager for more details.
     *
     * @param now current time in milliseconds - relevant for hint replay handling of truncated CFs
     */
    public RowMutation toHint(long now, int ttl, UUID targetId) throws IOException
    {
        assert ttl > 0;

        RowMutation rm = new RowMutation(Table.SYSTEM_KS, UUIDType.instance.decompose(targetId));
        UUID hintId = UUIDGen.getTimeUUID();
        // serialize the hint with id and version as a composite column name
        QueryPath path = new QueryPath(SystemTable.HINTS_CF,
                                       null,
                                       HintedHandOffManager.comparator.decompose(hintId, MessagingService.current_version));
        rm.add(path,
               ByteBuffer.wrap(FBUtilities.serialize(this, serializer, MessagingService.current_version)),
               now,
               ttl);

        return rm;
    }

