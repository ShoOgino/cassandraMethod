            @Override
            public UnfilteredRowIterator cleanup(UnfilteredRowIterator partition)
            {
                if (Range.isInRanges(partition.partitionKey().getToken(), ranges))
                    return partition;

                cfs.invalidateCachedPartition(partition.partitionKey());

                // acquire memtable lock here because secondary index deletion may cause a race. See CASSANDRA-3712
                try (OpOrder.Group opGroup = cfs.keyspace.writeOrder.start())
                {
                    cfs.indexManager.deleteFromIndexes(partition, opGroup, nowInSec);
                }
                return null;
            }

