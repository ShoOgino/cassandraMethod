    private AbstractBounds<PartitionPosition> makeExcludingKeyBounds(PartitionPosition lastReturnedKey)
    {
        // We return a range that always exclude lastReturnedKey, since we've already
        // returned it.
        AbstractBounds<PartitionPosition> bounds = ((PartitionRangeReadCommand)command).dataRange().keyRange();
        if (bounds instanceof Range || bounds instanceof Bounds)
        {
            return new Range<PartitionPosition>(lastReturnedKey, bounds.right);
        }
        else
        {
            return new ExcludingBounds<PartitionPosition>(lastReturnedKey, bounds.right);
        }
    }

