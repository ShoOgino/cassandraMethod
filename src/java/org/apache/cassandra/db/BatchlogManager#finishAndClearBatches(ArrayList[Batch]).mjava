    private void finishAndClearBatches(ArrayList<Batch> batches)
    {
        // schedule hints for timed out deliveries
        for (Batch batch : batches)
        {
            batch.finish();
            deleteBatch(batch.id);
        }
        totalBatchesReplayed += batches.size();
        batches.clear();
    }

