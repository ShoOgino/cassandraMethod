    private void runRemoveNotDeltaOldShards(Allocator allocator)
    {
        ContextState ctx = ContextState.allocate(4, 1, allocator);
        ctx.writeElement(CounterId.fromInt(1), 1L, 1L, true);
        ctx.writeElement(CounterId.fromInt(2), -System.currentTimeMillis(), 0L);
        ctx.writeElement(CounterId.fromInt(3), -System.currentTimeMillis(), 0L);
        ctx.writeElement(CounterId.fromInt(4), -System.currentTimeMillis(), 0L);

        ByteBuffer cleaned = cc.removeOldShards(ctx.context, (int)(System.currentTimeMillis() / 1000) + 1);
        assert cc.total(ctx.context) == cc.total(cleaned);
        assert cleaned.remaining() == ctx.context.remaining() - 3 * stepLength;
    }

