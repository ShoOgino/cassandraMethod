    /**
     * Stream the files in the bootstrap directory over to the
     * node being bootstrapped.
    */
    private static void transferOneTable(InetAddress target, List<String> fileList, String table) throws IOException
    {
        if (fileList.isEmpty())
            return;

        StreamContextManager.StreamContext[] streamContexts = new StreamContextManager.StreamContext[fileList.size()];
        int i = 0;
        for (String filename : fileList)
        {
            File file = new File(filename);
            streamContexts[i++] = new StreamContextManager.StreamContext(file.getAbsolutePath(), file.length(), table);
            if (logger.isDebugEnabled())
              logger.debug("Stream context metadata " + streamContexts[i]);
        }

        /* Set up the stream manager with the files that need to streamed */
        StreamManager.instance(target).addFilesToStream(streamContexts);
        /* Send the bootstrap initiate message */
        BootstrapInitiateMessage biMessage = new BootstrapInitiateMessage(streamContexts);
        Message message = BootstrapInitiateMessage.makeBootstrapInitiateMessage(biMessage);
        if (logger.isDebugEnabled())
          logger.debug("Sending a bootstrap initiate message to " + target + " ...");
        MessagingService.instance().sendOneWay(message, target);
        if (logger.isDebugEnabled())
          logger.debug("Waiting for transfer to " + target + " to complete");
        StreamManager.instance(target).waitForStreamCompletion();
        if (logger.isDebugEnabled())
          logger.debug("Done with transfer to " + target);
    }

