    /**
     * @throws IOException if reading the remote sstable fails. Will throw an RTE if local write fails.
     */
    public void read() throws IOException
    {
        if (remoteFile != null)
        {
            if (logger.isDebugEnabled())
            {
                logger.debug("Receiving stream");
                logger.debug("Creating file for {} with {} estimated keys",
                             localFile.getFilename(),
                             remoteFile.estimatedKeys);
            }

            assert remoteFile.estimatedKeys > 0;
            DataInput in = new DataInputStream(underliningStream);
            try
            {
                SSTableReader reader = streamIn(in, localFile, remoteFile);
                session.finished(remoteFile, reader);
            }
            catch (IOException ex)
            {
                retry();
                throw ex;
            }
            catch (RuntimeException e)
            {
                // if we encountered unexpected exception, fail this session
                session.close(false);
                throw e;
            }
        }

        session.closeIfFinished();
    }

