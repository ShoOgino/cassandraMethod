    private int calculatePageSize()
    {
        // read less columns (mutations) per page if they are very large
        int meanColumnCount = hintStore.getMeanColumns();
        if (meanColumnCount > 0)
        {
            int averageColumnSize = (int) (hintStore.getMeanRowSize() / meanColumnCount);
            // page size of 1 does not allow actual paging b/c of >= behavior on startColumn
            return Math.max(2, Math.min(PAGE_SIZE, DatabaseDescriptor.getInMemoryCompactionLimit() / averageColumnSize));
        }
        else
        {
            return PAGE_SIZE;
        }
    }

