    /**
     * get the current memtable in a threadsafe fashion. 
     * Returning memtable is ok because memtable is volatile, and thus
     * introduce a happens-before ordering.
     *
     * do NOT make this method public or it will really get impossible to reason about these things.
     */
    private Memtable getMemtableThreadSafe()
    {
        return memtable;
    }

