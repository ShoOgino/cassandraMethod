    /**
     * Grab the current CommitLogSegment we're allocating from. Also serves as a utility method to block while the allocator
     * is working on initial allocation of a CommitLogSegment.
     */
    CommitLogSegment allocatingFrom()
    {
        CommitLogSegment r = allocatingFrom;
        if (r == null)
        {
            advanceAllocatingFrom(null);
            r = allocatingFrom;
        }
        return r;
    }

