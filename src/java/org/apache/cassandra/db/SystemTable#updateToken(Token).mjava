    /*
     * This method is used to update the SystemTable with the
     * new token.
    */
    public void updateToken(Token token) throws IOException
    {
        IPartitioner p = StorageService.getPartitioner();
        if ( systemRow_ != null )
        {
            /* Retrieve the "LocationInfo" column family */
            ColumnFamily columnFamily = systemRow_.getColumnFamily(SystemTable.cfName_);
            long oldTokenColumnTimestamp = columnFamily.getColumn(SystemTable.token_).timestamp();
            /* create the "Token" whose value is the new token. */
            IColumn tokenColumn = new Column(SystemTable.token_, p.getTokenFactory().toByteArray(token), oldTokenColumnTimestamp + 1);
            /* replace the old "Token" column with this new one. */
            logger_.debug("Replacing old token " + p.getTokenFactory().fromByteArray(columnFamily.getColumn(SystemTable.token_).value()) + " with " + token);
            columnFamily.addColumn(tokenColumn);
            reset(systemRow_);
        }
    }

