        @VisibleForTesting
        public Serializer(TableMetadataProvider schema)
        {
            this.schema = Objects.requireNonNull(schema, "schema");
        }

