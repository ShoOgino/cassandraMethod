    public AbstractCompactionTask getUserDefinedTask(Collection<SSTableReader> sstables, int gcBefore)
    {
        maybeReload(cfs.metadata);
        validateForCompaction(sstables, cfs, getDirectories());
        readLock.lock();
        try
        {
            return getCompactionStrategyFor(sstables.iterator().next()).getUserDefinedTask(sstables, gcBefore);
        }
        finally
        {
            readLock.unlock();
        }
    }

