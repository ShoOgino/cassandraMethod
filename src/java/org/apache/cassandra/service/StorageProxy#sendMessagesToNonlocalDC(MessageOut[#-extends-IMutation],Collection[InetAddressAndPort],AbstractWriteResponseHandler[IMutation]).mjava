    private static void sendMessagesToNonlocalDC(MessageOut<? extends IMutation> message,
                                                 Collection<InetAddressAndPort> targets,
                                                 AbstractWriteResponseHandler<IMutation> handler)
    {
        Iterator<InetAddressAndPort> iter = targets.iterator();
        int[] messageIds = new int[targets.size()];
        InetAddressAndPort target = iter.next();

        int idIdx = 0;
        // Add the other destinations of the same message as a FORWARD_HEADER entry
        while (iter.hasNext())
        {
            InetAddressAndPort destination = iter.next();
            int id = MessagingService.instance().addCallback(handler,
                                                             message,
                                                             destination,
                                                             message.getTimeout(),
                                                             handler.consistencyLevel,
                                                             true);
            messageIds[idIdx++] = id;
            logger.trace("Adding FWD message to {}@{}", id, destination);
        }
        message = message.withParameter(ParameterType.FORWARD_TO.FORWARD_TO, new ForwardToContainer(targets, messageIds));
        // send the combined message + forward headers
        int id = MessagingService.instance().sendRR(message, target, handler, true);
        logger.trace("Sending message to {}@{}", id, target);
    }

