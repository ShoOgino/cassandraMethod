    /**
     * this version of makeRecord takes an existing LogRecord and converts it to a
     * record with the given type. This avoids listing the directory and if the
     * LogRecord already exists, we have all components for the sstable
     */
    private LogRecord makeRecord(Type type, SSTable table, LogRecord record)
    {
        assert type == Type.ADD || type == Type.REMOVE;

        File folder = table.descriptor.directory;
        replicas.maybeCreateReplica(folder, getFileName(folder), records);
        return record.asType(type);
    }

