    @Test
    public void testMergeAndAdd()
    {
        ColumnFamily cf_new = ColumnFamily.create("Table1", "Standard1");
        ColumnFamily cf_old = ColumnFamily.create("Table1", "Standard1");
        ColumnFamily cf_result = ColumnFamily.create("Table1", "Standard1");
        byte val[] = "sample value".getBytes();
        byte val2[] = "x value ".getBytes();

        // exercise addColumn(QueryPath, ...)
        cf_new.addColumn(QueryPath.column("col1".getBytes()), val, 3);
        cf_new.addColumn(QueryPath.column("col2".getBytes()), val, 4);

        cf_old.addColumn(QueryPath.column("col2".getBytes()), val2, 1);
        cf_old.addColumn(QueryPath.column("col3".getBytes()), val2, 2);

        cf_result.addColumns(cf_new);
        cf_result.addColumns(cf_old);

        assert 3 == cf_result.getColumnCount() : "Count is " + cf_new.getColumnCount();
        //addcolumns will only add if timestamp >= old timestamp
        assert Arrays.equals(val, cf_result.getColumn("col2".getBytes()).value());
    }

