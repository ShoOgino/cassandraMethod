    public void resetAndTruncate(FileMark mark) throws IOException
    {
        assert mark instanceof BufferedFileWriterMark;

        // synchronize current buffer with disk
        // because we don't want any data loss
        sync();

        // setting marker as a current offset
        current = ((BufferedFileWriterMark) mark).pointer;

        // truncate file to given position
        truncate(current);

        // reset channel position
        out.seek(current);

        resetBuffer();
    }

