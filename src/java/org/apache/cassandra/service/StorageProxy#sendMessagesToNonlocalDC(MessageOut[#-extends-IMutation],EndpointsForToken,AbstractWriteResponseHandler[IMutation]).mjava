    private static void sendMessagesToNonlocalDC(MessageOut<? extends IMutation> message,
                                                 EndpointsForToken targets,
                                                 AbstractWriteResponseHandler<IMutation> handler)
    {
        Iterator<Replica> iter = targets.iterator();
        int[] messageIds = new int[targets.size()];
        Replica target = iter.next();

        int idIdx = 0;
        // Add the other destinations of the same message as a FORWARD_HEADER entry
        while (iter.hasNext())
        {
            Replica destination = iter.next();
            int id = MessagingService.instance().addWriteCallback(handler,
                                                                  message,
                                                                  destination,
                                                                  message.getTimeout(),
                                                                  handler.replicaPlan.consistencyLevel(),
                                                                  true);
            messageIds[idIdx++] = id;
            logger.trace("Adding FWD message to {}@{}", id, destination);
        }

        message = message.withParameter(ParameterType.FORWARD_TO, new ForwardToContainer(targets.endpoints(), messageIds));
        // send the combined message + forward headers
        int id = MessagingService.instance().sendWriteRR(message, target, handler, true);
        logger.trace("Sending message to {}@{}", id, target);
    }

