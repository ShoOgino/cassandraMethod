    private boolean maybeRollLog() throws IOException
    {
        if (logWriter.length() >= SEGMENT_SIZE)
        {
            /* Rolls the current log file over to a new one. */
            setNextFileName();
            String oldLogFile = logWriter.getPath();
            logWriter.close();

            /* point reader/writer to a new commit log file. */
            logWriter = CommitLog.createWriter(logFile);
            /* squirrel away the old commit log header */
            clHeaders.put(oldLogFile, new CommitLogHeader(clHeader));
            clHeader.clear();
            writeCommitLogHeader(logWriter, clHeader.toByteArray());
            return true;
        }
        return false;
    }

