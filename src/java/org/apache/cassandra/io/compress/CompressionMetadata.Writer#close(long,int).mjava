        public void close(long dataLength, int chunks) throws IOException
        {
            final DataOutputStream out = new DataOutputStream(new FileOutputStream(filePath));
            assert chunks == count;
            writeHeader(out, dataLength, chunks);
            for (int i = 0 ; i < count ; i++)
                out.writeLong(offsets.getLong(i * 8));
            out.close();
        }

