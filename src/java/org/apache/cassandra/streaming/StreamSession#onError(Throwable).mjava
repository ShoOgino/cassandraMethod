    /**
     * Call back for handling exception during streaming.
     */
    public Future onError(Throwable e)
    {
        logError(e);
        // send session failure message
        if (messageSender.connected())
            messageSender.sendMessage(new SessionFailedMessage());
        // fail session
        return closeSession(State.FAILED);
    }

