    /**
     * Deserialize only Keyspace attributes without nested ColumnFamilies
     *
     * @param serializedKsDef Keyspace attributes in serialized form
     *
     * @return deserialized keyspace without cf_defs
     *
     * @throws IOException if deserialization failed
     */
    public static KsDef fromSchema(ColumnFamily serializedKsDef) throws IOException
    {
        KsDef ksDef = new KsDef();

        AbstractType comparator = serializedKsDef.getComparator();

        for (IColumn ksAttr : serializedKsDef.getSortedColumns())
        {
            if (ksAttr == null || ksAttr.isMarkedForDelete())
                continue;

            KsDef._Fields field = KsDef._Fields.findByName(comparator.getString(ksAttr.name()));

            // this means that given field was deprecated
            // but still exists in the serialized schema
            if (field == null)
                continue;

            ksDef.setFieldValue(field, deserializeValue(ksAttr.value(), getValueClass(KsDef.class, field.getFieldName())));
        }

        return ksDef.name == null ? null : ksDef;
    }

