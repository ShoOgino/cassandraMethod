    public boolean reduceScopeForLimitedSpace()
    {
        if (partialCompactionsAcceptable() && sstables.size() > 1)
        {
            // Try again w/o the largest one.
            logger.warn("insufficient space to compact all requested files {}", StringUtils.join(sstables, ", "));
            // Note that we have removed files that are still marked as compacting.
            // This suboptimal but ok since the caller will unmark all the sstables at the end.
            SSTableReader removedSSTable = cfs.getMaxSizeFile(sstables);
            if (sstables.remove(removedSSTable))
            {
                cfs.getDataTracker().unmarkCompacting(Arrays.asList(removedSSTable));
                return true;
            }
        }
        return false;
    }

