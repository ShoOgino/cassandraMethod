    protected Directories.DataDirectory getWriteDirectory(long writeSize)
    {
        Directories.DataDirectory directory = getDirectories().getWriteableLocation(writeSize);
        if (directory == null)
            throw new FSWriteError(new IOException("Insufficient disk space to write " + writeSize + " bytes"), "");

        return directory;
    }

