    // Never ever do this at home. Used by tests.
    IPartitioner setPartitionerUnsafe(IPartitioner newPartitioner)
    {
        IPartitioner oldPartitioner = partitioner_;
        partitioner_ = newPartitioner;
        valueFactory = new VersionedValue.VersionedValueFactory(partitioner_);
        return oldPartitioner;
    }

