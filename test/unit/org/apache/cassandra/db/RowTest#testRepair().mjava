    @Test
    public void testRepair()
    {
        Row row1 = new Row();
        ColumnFamily cf1 = ColumnFamily.create("Table1", "Standard1");
        cf1.addColumn("one", "A".getBytes(), 0);
        row1.addColumnFamily(cf1);

        Row row2 = new Row();
        ColumnFamily cf2 = ColumnFamily.create("Table1", "Standard1");
        cf2.addColumn("one", "B".getBytes(), 1);
        cf2.addColumn("two", "C".getBytes(), 1);
        ColumnFamily cf3 = ColumnFamily.create("Table2", "Standard2");
        cf3.addColumn("three", "D".getBytes(), 1);
        row2.addColumnFamily(cf2);
        row2.addColumnFamily(cf3);

        row1.repair(row2);
        cf1 = row1.getColumnFamily("Standard1");
        assert Arrays.equals(cf1.getColumn("one").value(), "B".getBytes());
        assert Arrays.equals(cf2.getColumn("two").value(), "C".getBytes());
        assert row1.getColumnFamily("Standard2") != null;
    }

