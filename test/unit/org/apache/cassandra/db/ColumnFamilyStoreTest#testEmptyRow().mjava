    @Test
    public void testEmptyRow() throws Exception
    {
        Keyspace keyspace = Keyspace.open("Keyspace1");
        final ColumnFamilyStore store = keyspace.getColumnFamilyStore("Standard2");
        RowMutation rm;

        rm = new RowMutation("Keyspace1", ByteBufferUtil.bytes("key1"));
        rm.delete("Standard2", System.currentTimeMillis());
        rm.apply();

        Runnable r = new WrappedRunnable()
        {
            public void runMayThrow() throws IOException
            {
                QueryFilter sliceFilter = QueryFilter.getSliceFilter(Util.dk("key1"),
                                                                     "Standard2",
                                                                     ByteBufferUtil.EMPTY_BYTE_BUFFER,
                                                                     ByteBufferUtil.EMPTY_BYTE_BUFFER,
                                                                     false,
                                                                     1,
                                                                     System.currentTimeMillis());
                ColumnFamily cf = store.getColumnFamily(sliceFilter);
                assert cf.isMarkedForDelete();
                assert cf.getColumnCount() == 0;

                QueryFilter namesFilter = QueryFilter.getNamesFilter(Util.dk("key1"),
                                                                     "Standard2",
                                                                     FBUtilities.singleton(ByteBufferUtil.bytes("a"), store.getComparator()),
                                                                     System.currentTimeMillis());
                cf = store.getColumnFamily(namesFilter);
                assert cf.isMarkedForDelete();
                assert cf.getColumnCount() == 0;
            }
        };

        KeyspaceTest.reTest(store, r);
    }

