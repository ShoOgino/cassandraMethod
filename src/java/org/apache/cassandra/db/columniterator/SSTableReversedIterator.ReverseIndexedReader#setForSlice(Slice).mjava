        @Override
        public void setForSlice(Slice slice) throws IOException
        {
            this.slice = slice;
            isInit = true;

            // if our previous slicing already got us pas the beginning of the sstable, we're done
            if (indexState.isDone())
            {
                iterator = Collections.emptyIterator();
                return;
            }

            // Find the first index block we'll need to read for the slice.
            int startIdx = indexState.findBlockIndex(slice.end());
            if (startIdx < 0)
            {
                iterator = Collections.emptyIterator();
                return;
            }

            boolean isCurrentBlock = startIdx == indexState.currentBlockIdx();
            if (!isCurrentBlock)
                indexState.setToBlock(startIdx);

            lastBlockIdx = indexState.findBlockIndex(slice.start());

            if (!isCurrentBlock)
                readCurrentBlock(true);

            setIterator(slice);
        }

