    private static Collection<Cell> transform(Comparator<Cell> cmp, ColumnFamily cf, Function<Cell, Cell> transformation, boolean sort)
    {
        Cell[] tmp = new Cell[cf.getColumnCount()];

        int i = 0;
        for (Cell c : cf)
            tmp[i++] = transformation.apply(c);

        if (sort)
            Arrays.sort(tmp, cmp);

        return Arrays.asList(tmp);
    }

