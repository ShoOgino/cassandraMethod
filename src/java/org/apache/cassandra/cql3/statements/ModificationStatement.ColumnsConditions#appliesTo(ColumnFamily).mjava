        public boolean appliesTo(ColumnFamily current)
        {
            if (current == null)
                return false;

            for (Column e : expected)
            {
                Column c = current.getColumn(e.name());
                if (e.isLive(now))
                {
                    if (c == null || !c.isLive(now) || !c.value().equals(e.value()))
                        return false;
                }
                else
                {
                    // If we have a tombstone in expected, it means the condition tests that the column is
                    // null, so check that we have no value
                    if (c != null && c.isLive(now))
                        return false;
                }
            }
            return true;
        }

