    @Test
    public void userEventTriggered_Idle_WithPendingBytes()
    {
        Assert.assertTrue(channel.isOpen());
        ChannelUserEventSender sender = new ChannelUserEventSender();
        channel.pipeline().addFirst(sender);

        MessageOut message = new MessageOut(MessagingService.Verb.INTERNAL_RESPONSE);
        channel.writeOutbound(new QueuedMessage(message, 42));
        sender.sendEvent(IdleStateEvent.WRITER_IDLE_STATE_EVENT);
        Assert.assertFalse(channel.isOpen());
    }

