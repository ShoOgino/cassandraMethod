    public static Map<SyncNodePair, SyncTask> toMap(List<SyncTask> tasks)
    {
        Map<SyncNodePair, SyncTask> map = new HashMap();
        for (SyncTask task : tasks)
        {
            SyncTask oldTask = map.put(task.nodePair, task);
            Assert.assertNull(String.format("\nNode pair: %s\nOld task:  %s\nNew task:  %s\n",
                                            task.nodePair,
                                            oldTask,
                                            task),
                              oldTask);
        }
        return map;
    }

