    @Override
    protected int determineBlockFor(String table)
    {
        NetworkTopologyStrategy strategy = (NetworkTopologyStrategy) Table.open(table).getReplicationStrategy();
        int blockFor = (strategy.getReplicationFactor(localdc) / 2) + 1;
        // If there is any pending endpoints we went to increase blockFor to make sure we guarantee CL (see CASSANDRA-833). However, we're only
        // intersted in endpoint in the local DC. Note that we use the fact that when a node boostrap (or leave), both the source and
        // destination of a pending range will be in the same DC (this is true because strategy == NTS)
        for (InetAddress pending : pendingEndpoints)
        {
            if (localdc.equals(snitch.getDatacenter(pending)))
                blockFor++;
        }
        return blockFor;
    }

