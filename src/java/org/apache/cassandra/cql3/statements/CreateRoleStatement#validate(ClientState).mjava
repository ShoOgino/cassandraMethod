    public void validate(ClientState state) throws RequestValidationException
    {
        opts.validate();

        if (role.isEmpty())
            throw new InvalidRequestException("Role name can't be an empty string");

        // validate login here before checkAccess to avoid leaking role existence to anonymous users.
        state.ensureNotAnonymous();

        if (!ifNotExists && DatabaseDescriptor.getRoleManager().isExistingRole(role))
            throw new InvalidRequestException(String.format("%s already exists", role));

        for (Option option : opts.getOptions().keySet())
        {
            if (!DatabaseDescriptor.getRoleManager().supportedOptions().contains(option))
                throw new UnauthorizedException(String.format("You aren't allowed to alter %s", option));
        }
    }

