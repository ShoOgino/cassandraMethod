    private void finishJoiningRing()
    {
        // start participating in the ring.
        SystemKeyspace.setBootstrapState(SystemKeyspace.BootstrapState.COMPLETED);
        setTokens(bootstrapTokens);

        assert tokenMetadata.sortedTokens().size() > 0;
        doAuthSetup();
    }

