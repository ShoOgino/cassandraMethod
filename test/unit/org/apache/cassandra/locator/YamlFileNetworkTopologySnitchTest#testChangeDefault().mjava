    /**
     * Test that we can change the default only if this does not result in any live node changing dc or rack.
     * The configuration file contains default DC1 and r1 and we change it to DC2 and r2. Let's use host 127.0.0.9
     * since it is not in the configuration file.
     */
    @Test
    public void testChangeDefault() throws Exception
    {
        final InetAddress host = InetAddress.getByName("127.0.0.9");
        final YamlFileNetworkTopologySnitch snitch = new YamlFileNetworkTopologySnitch(confFile);
        checkEndpoint(snitch, host.getHostAddress(), "DC1", "r1"); // default

        try
        {
            final TopologyConfig topologyConfig = snitch.readConfig();
            topologyConfig.default_dc_name = "DC2";
            topologyConfig.default_rack_name = "r2";

            setNodeLive(host);
            snitch.loadTopologyConfiguration(true, topologyConfig);
            checkEndpoint(snitch, host.getHostAddress(), "DC1", "r1"); // unchanged

            setNodeShutdown(host);
            snitch.loadTopologyConfiguration(true, topologyConfig);
            checkEndpoint(snitch, host.getHostAddress(), "DC2", "r2"); // default updated
        }
        finally
        {
            setNodeShutdown(host);
        }
    }

