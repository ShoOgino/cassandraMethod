    private SSTableWriter createCompactionWriter(File sstableDirectory, long keysPerSSTable, long repairedAt, SSTableFormat.Type type)
    {
        return SSTableWriter.create(Descriptor.fromFilename(cfs.getTempSSTablePath(sstableDirectory), type),
                keysPerSSTable,
                repairedAt,
                cfs.metadata,
                cfs.partitioner,
                new MetadataCollector(sstables, cfs.metadata.comparator, getLevel()));
    }

