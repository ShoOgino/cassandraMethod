    /**
     * Returns the endpoints currently responsible for storing the token plus pending ones
     */
    public EndpointsForToken getNaturalAndPendingReplicasForToken(String keyspaceName, Token token)
    {
        // TODO: race condition to fetch these. impliciations??
        EndpointsForToken natural = getNaturalReplicasForToken(keyspaceName, token);
        EndpointsForToken pending = tokenMetadata.pendingEndpointsForToken(token, keyspaceName);
        if (Endpoints.haveConflicts(natural, pending))
        {
            natural = Endpoints.resolveConflictsInNatural(natural, pending);
            pending = Endpoints.resolveConflictsInPending(natural, pending);
        }
        return Endpoints.concat(natural, pending);
    }

