    @Test
    public void testSingleWrite() throws IOException
    {
        // write test data
        ByteBuffer key = ByteBufferUtil.bytes(Integer.toString(1));
        ByteBuffer cbytes = ByteBuffer.wrap(new byte[1024]);
        new Random().nextBytes(cbytes.array());
        ColumnFamily cf = ColumnFamily.create("Keyspace1", "Standard1");
        cf.addColumn(new Column(cbytes, cbytes));

        SortedMap<DecoratedKey, ColumnFamily> map = new TreeMap<DecoratedKey, ColumnFamily>();
        map.put(Util.dk(key), cf);
        SSTableReader ssTable = SSTableUtils.prepare().cf("Standard1").write(map);

        // verify
        ByteBuffer bytes = Util.serializeForSSTable(cf);
        verifySingle(ssTable, bytes, key);
        ssTable = SSTableReader.open(ssTable.descriptor); // read the index from disk
        verifySingle(ssTable, bytes, key);
    }

