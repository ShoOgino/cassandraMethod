    private String getDirtyCFIds(Collection<CommitLogSegment> segments)
    {
        return "Dirty cfIds: <"
               + String.join(", ", segments.stream()
                                           .map(CommitLogSegment::getDirtyCFIDs)
                                           .flatMap(uuids -> uuids.stream())
                                           .distinct()
                                           .map(uuid -> uuid.toString()).collect(Collectors.toList()))
               + ">";
    }

