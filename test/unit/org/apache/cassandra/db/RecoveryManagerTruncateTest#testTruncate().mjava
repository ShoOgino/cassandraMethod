	@Test
	public void testTruncate() throws IOException, ExecutionException, InterruptedException
	{
		Table table = Table.open("Keyspace1");
		ColumnFamilyStore cfs = table.getColumnFamilyStore("Standard1");

		RowMutation rm;
		ColumnFamily cf;

		// trucate clears memtable
		rm = new RowMutation("Keyspace1", ByteBufferUtil.bytes("keymulti"));
		cf = ColumnFamily.create("Keyspace1", "Standard1");
		cf.addColumn(column("col1", "val1", 1L));
		rm.add(cf);
		rm.apply();

		// Make sure data was written
		assertNotNull(getFromTable(table, "Standard1", "keymulti", "col1"));

		// and now truncate it
		cfs.truncate().get();
		CommitLog.recover();

		// and validate truncation.
		assertNull(getFromTable(table, "Standard1", "keymulti", "col1"));

		// truncate clears sstable
		rm = new RowMutation("Keyspace1", ByteBufferUtil.bytes("keymulti"));
		cf = ColumnFamily.create("Keyspace1", "Standard1");
		cf.addColumn(column("col1", "val1", 1L));
		rm.add(cf);
		rm.apply();
		cfs.forceBlockingFlush();
		cfs.truncate().get();
		CommitLog.recover();
		assertNull(getFromTable(table, "Standard1", "keymulti", "col1"));
	}

