    public void hasColumnFamilyAccess(String keyspace, String columnFamily, Permission perm) throws InvalidRequestException
    {
        validateLogin();
        validateKeyspace(keyspace);

        resourceClear();
        resource.add(keyspace);

        // check if keyspace access is set to Permission.ALL
        // (which means that user has all access on keyspace and it's underlying elements)
        if (DatabaseDescriptor.getAuthority().authorize(user, resource).contains(Permission.ALL))
            return;

        resource.add(columnFamily);
        Set<Permission> perms = DatabaseDescriptor.getAuthority().authorize(user, resource);

        hasAccess(user, perms, perm, resource);
    }

