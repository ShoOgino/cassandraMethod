    public int waitFor()
    {
        try
        {
            int rc = process.waitFor();
            // must call first in order to make sure the stdin ioWatcher will exit
            onComplete();
            for (Thread t : ioWatchers)
                t.join();
            return rc;
        }
        catch (InterruptedException e)
        {
            throw new RuntimeException(e);
        }
    }

