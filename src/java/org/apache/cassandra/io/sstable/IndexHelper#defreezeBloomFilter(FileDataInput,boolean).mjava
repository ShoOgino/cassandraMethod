    /**
     * De-freeze the bloom filter.
     *
     * @param file - source file
     * @param useOldBuffer - do we need to reuse old buffer?
     *
     * @return bloom filter summarizing the column information
     * @throws java.io.IOException if an I/O error occurs.
     */
    public static Filter defreezeBloomFilter(FileDataInput file, boolean useOldBuffer) throws IOException
    {
        int size = file.readInt();
        ByteBuffer bytes = file.readBytes(size);

        DataInputStream stream = new DataInputStream(ByteBufferUtil.inputStream(bytes));

        return useOldBuffer
                ? LegacyBloomFilter.serializer().deserialize(stream)
                : BloomFilter.serializer().deserialize(stream);
    }

