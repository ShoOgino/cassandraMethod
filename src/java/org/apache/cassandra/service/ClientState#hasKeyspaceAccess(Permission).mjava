    /**
     * Confirms that the client thread has the given Permission in the context of the current Keyspace.
     */
    public void hasKeyspaceAccess(Permission perm) throws InvalidRequestException
    {
        if (user.get() == null)
            throw new InvalidRequestException("You have not logged in");
        if (keyspaceAccess.get() == null)
            throw new InvalidRequestException("You have not set a keyspace for this session");
        if (!keyspaceAccess.get().contains(perm))
            throw new InvalidRequestException(String.format("You (%s) do not have permission %s for %s", user, perm, keyspace.get()));
    }

