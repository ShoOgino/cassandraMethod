    public long allocate(int size, OpOrder.Group opGroup)
    {
        assert size >= 0;
        if (size > MAX_CLONED_SIZE)
            return allocateOversize(size, opGroup);

        while (true)
        {
            Region region = currentRegion.get();
            long peer;
            if (region != null && (peer = region.allocate(size)) > 0)
                return peer;

            trySwapRegion(region, size);
        }
    }

