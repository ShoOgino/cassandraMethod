    private static FunctionName aggregateParseFunctionName(String ksName, String func)
    {
        int i = func.indexOf('.');

        // function name can be abbreviated (pre 2.2rc2) - it is in the same keyspace as the aggregate
        if (i == -1)
            return new FunctionName(ksName, func);

        String ks = func.substring(0, i);
        String f = func.substring(i + 1);

        // only aggregate's function keyspace and system keyspace are allowed
        assert ks.equals(ksName) || ks.equals(SystemKeyspace.NAME);

        return new FunctionName(ks, f);
    }

