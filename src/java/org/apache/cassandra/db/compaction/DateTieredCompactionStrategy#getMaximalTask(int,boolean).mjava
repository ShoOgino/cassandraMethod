    @Override
    @SuppressWarnings("resource")
    public synchronized Collection<AbstractCompactionTask> getMaximalTask(int gcBefore, boolean splitOutput)
    {
        LifecycleTransaction modifier = cfs.markAllCompacting(OperationType.COMPACTION);
        if (modifier == null)
            return null;

        return Arrays.<AbstractCompactionTask>asList(new CompactionTask(cfs, modifier, gcBefore));
    }

