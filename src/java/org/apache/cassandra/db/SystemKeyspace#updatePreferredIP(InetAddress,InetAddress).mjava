    public static synchronized void updatePreferredIP(InetAddress ep, InetAddress preferred_ip)
    {
        if (getPreferredIP(ep) == preferred_ip)
            return;

        String req = "INSERT INTO system.%s (peer, preferred_ip) VALUES (?, ?)";
        executeInternal(format(req, PEERS), ep, preferred_ip);
        forceBlockingFlush(PEERS);
    }

