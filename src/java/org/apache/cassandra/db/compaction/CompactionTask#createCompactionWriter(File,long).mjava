    private SSTableWriter createCompactionWriter(File sstableDirectory, long keysPerSSTable)
    {
        return new SSTableWriter(cfs.getTempSSTablePath(sstableDirectory),
                                 keysPerSSTable,
                                 cfs.metadata,
                                 cfs.partitioner,
                                 SSTableMetadata.createCollector(toCompact, getLevel()));
    }

