    public Token getSuccessor(Token token, Map<Token, EndPoint> tokenToEndPointMap)
    {
        List tokens = new ArrayList<Token>(tokenToEndPointMap.keySet());
        Collections.sort(tokens);
        int index = Collections.binarySearch(tokens, token);
        return (Token) ((index == (tokens.size() - 1)) ? tokens.get(0) : tokens.get(++index));
    }

