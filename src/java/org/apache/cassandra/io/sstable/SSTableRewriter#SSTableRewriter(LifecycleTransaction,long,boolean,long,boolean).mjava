    @VisibleForTesting
    public SSTableRewriter(LifecycleTransaction transaction, long maxAge, boolean isOffline, long preemptiveOpenInterval, boolean keepOriginals)
    {
        this.transaction = transaction;
        for (SSTableReader sstable : this.transaction.originals())
            fileDescriptors.put(sstable.descriptor, CLibrary.getfd(sstable.getFilename()));
        this.maxAge = maxAge;
        this.isOffline = isOffline;
        this.keepOriginals = keepOriginals;
        this.preemptiveOpenInterval = preemptiveOpenInterval;
    }

