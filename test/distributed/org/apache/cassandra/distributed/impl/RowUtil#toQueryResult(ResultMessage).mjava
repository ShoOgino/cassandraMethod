    public static SimpleQueryResult toQueryResult(ResultMessage res)
    {
        if (res != null && res.kind == ResultMessage.Kind.ROWS)
        {
            ResultMessage.Rows rows = (ResultMessage.Rows) res;
            String[] names = getColumnNames(rows.result.metadata.names);
            Object[][] results = RowUtil.toObjects(rows);
            return new SimpleQueryResult(names, results);
        }
        else
        {
            return QueryResults.empty();
        }
    }

