    private void updateFunctionInternal(Function fun)
    {
        assert fun instanceof UDFunction || fun instanceof UDAggregate;

        KSMetaData oldKsm = getKSMetaData(fun.name().keyspace);
        assert oldKsm != null;
        KSMetaData newKsm = oldKsm.cloneWith(oldKsm.functions.without(fun.name(), fun.argTypes()).with(fun));
        setKeyspaceDefinition(newKsm);
    }

