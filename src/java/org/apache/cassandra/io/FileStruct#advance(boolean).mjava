    /*
     * Read the next key from the data file.
     * Caller must check isExhausted after each call to see if further
     * reads are valid.
     * Do not mix with calls to the iterator interface (next/hasnext).
     * @deprecated -- prefer the iterator interface.
     */
    public void advance(boolean materialize) throws IOException
    {
        // TODO r/m materialize option -- use iterableness!
        if (exhausted)
        {
            throw new IndexOutOfBoundsException();
        }

        if (file.isEOF())
        {
            file.close();
            exhausted = true;
            return;
        }

        row = new IteratingRow(file);
        if (materialize)
        {
            while (row.hasNext())
            {
                IColumn column = row.next();
                row.getEmptyColumnFamily().addColumn(column);
            }
        }
        else
        {
            row.skipRemaining();
        }
    }

