    @Test
    public void testSingleWrite() throws IOException {
        File f = File.createTempFile("sstable", "-" + SSTable.temporaryFile_);

        // write test data
        SSTable ssTable = new SSTable(f.getParent(), f.getName(), new OrderPreservingPartitioner());
        BloomFilter bf = new BloomFilter(1000, 8);
        Random random = new Random();
        byte[] bytes = new byte[1024];
        random.nextBytes(bytes);

        String key = Integer.toString(1);
        ssTable.append(key, bytes);
        bf.add(key);
        ssTable.close(bf);

        // verify
        verifySingle(ssTable.dataFile_, bytes, key);
        SSTable.reopenUnsafe(); // force reloading the index
        verifySingle(ssTable.dataFile_, bytes, key);
    }

