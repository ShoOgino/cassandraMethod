    public void close()
    {
        Map<Replica, Mutation> mutations = null;
        for (int i = 0; i < repairs.length; i++)
        {
            if (repairs[i] == null)
                continue;

            Preconditions.checkState(!isTransient(i), "cannot read repair transient replicas");
            Mutation mutation = BlockingReadRepairs.createRepairMutation(repairs[i].build(), consistency, sources[i].endpoint(), false);
            if (mutation == null)
                continue;

            if (mutations == null)
                mutations = Maps.newHashMapWithExpectedSize(sources.length);

            mutations.put(sources[i], mutation);
        }

        if (mutations != null)
        {
            readRepair.repairPartition(partitionKey, mutations, layout);
        }
    }

