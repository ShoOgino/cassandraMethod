    /*
     * 
    */
    void flush() throws IOException
    {
        if (columnFamilies_.size() == 0)
            return;

        /*
         * Use the SSTable to write the contents of the TreeMap
         * to disk.
        */

        String path;
        SSTableWriter writer;
        ColumnFamilyStore cfStore = Table.open(table_).getColumnFamilyStore(cfName_);
        List<DecoratedKey> keys = new ArrayList<DecoratedKey>( columnFamilies_.keySet() );
        path = cfStore.getTempSSTablePath();
        writer = new SSTableWriter(path, keys.size(), StorageService.getPartitioner());

        Collections.sort(keys, partitioner_.getDecoratedKeyObjComparator());

        /* Use this BloomFilter to decide if a key exists in a SSTable */
        for (DecoratedKey key : keys)
        {
            byte[] bytes = columnFamilies_.get(key);
            if (bytes.length > 0)
            {
                /* Now write the key and value to disk */
                writer.append(key.toString(), bytes);
            }
        }
        cfStore.addSSTable(writer.closeAndOpenReader());
        columnFamilies_.clear();       
    }

