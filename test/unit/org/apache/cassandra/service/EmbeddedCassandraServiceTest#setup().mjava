    /**
     * Set embedded cassandra up and spawn it in a new thread.
     *
     * @throws TTransportException
     * @throws IOException
     * @throws InterruptedException
     */
    @BeforeClass
    public static void setup() throws TTransportException, IOException, InterruptedException, ConfigurationException
    {

        // Tell cassandra where the configuration files are.
        // Use the test configuration file.
        System.setProperty("storage-config", "test/conf");
        for (KSMetaData table : DatabaseDescriptor.readTablesFromXml())
            DatabaseDescriptor.setTableDefinition(table, DatabaseDescriptor.getDefsVersion());

        cassandra = new EmbeddedCassandraService();
        cassandra.init();

        // spawn cassandra in a new thread
        Thread t = new Thread(cassandra);
        t.setDaemon(true);
        t.start();
    }

