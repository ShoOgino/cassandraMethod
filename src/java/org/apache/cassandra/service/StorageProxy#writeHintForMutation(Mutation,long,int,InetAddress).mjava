    /**
     * @param now current time in milliseconds - relevant for hint replay handling of truncated CFs
     */
    public static void writeHintForMutation(Mutation mutation, long now, int ttl, InetAddress target)
    {
        assert ttl > 0;

        UUID hostId = StorageService.instance.getTokenMetadata().getHostId(target);
        if (hostId != null)
        {
            HintedHandOffManager.instance.hintFor(mutation, now, ttl, Pair.create(target, hostId)).apply();
            StorageMetrics.totalHints.inc();
        }
        else
            logger.debug("Discarding hint for endpoint not part of ring: {}", target);
    }

