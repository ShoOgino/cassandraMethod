    /**
     * Get all ranges that span the ring given a set
     * of endpoints.
    */
    public Range[] getPrimaryRangesForEndPoints(Set<EndPoint> endpoints)
    {
        List<Range> allRanges = new ArrayList<Range>();
        for ( EndPoint endpoint : endpoints )
        {
            allRanges.add( getPrimaryRangeForEndPoint( endpoint) );
        }
        return allRanges.toArray(new Range[0]);
    }

