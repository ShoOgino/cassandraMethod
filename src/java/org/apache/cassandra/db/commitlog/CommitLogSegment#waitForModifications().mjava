    /**
     * Wait for any appends or discardUnusedTail() operations started before this method was called
     */
    private synchronized void waitForModifications()
    {
        // issue a barrier and wait for it
        OpOrder.Barrier barrier = appendOrder.newBarrier();
        barrier.issue();
        barrier.await();
    }

