        public void waitForAgreement()
        {
            long start = System.nanoTime();
            while (1 != instances.stream().map(Instance::getSchemaVersion).distinct().count())
            {
                if (System.nanoTime() - start > TimeUnit.MINUTES.toNanos(1L))
                    throw new IllegalStateException("Schema agreement not reached");
                LockSupport.parkNanos(TimeUnit.MILLISECONDS.toNanos(1L));
            }
        }

