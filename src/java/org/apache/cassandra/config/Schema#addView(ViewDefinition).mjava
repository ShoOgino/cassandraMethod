    public void addView(ViewDefinition view)
    {
        assert getCFMetaData(view.ksName, view.viewName) == null;

        update(view.ksName, ks ->
        {
            load(view);

            // make sure it's init-ed w/ the old definitions first,
            // since we're going to call initCf on the new one manually
            Keyspace.open(view.ksName);

            return ks.withSwapped(ks.views.with(view));
        });

        Keyspace.open(view.ksName).initCf(view.metadata.cfId, view.viewName, true);
        Keyspace.open(view.ksName).viewManager.reload();
        MigrationManager.instance.notifyCreateView(view);
    }

