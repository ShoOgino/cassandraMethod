    public CacheWriter(String columnFamily, JMXInstrumentedCache<K, V> cache, File path, Function<K, ByteBuffer> converter)
    {
        this.columnFamily = columnFamily;
        this.path = path;
        this.converter = converter;
        keys = cache.getKeySet();

        long bytes = 0;
        for (K key : keys)
            bytes += converter.apply(key).remaining();

        // an approximation -- the keyset can change while saving
        estimatedTotalBytes = bytes;
    }

