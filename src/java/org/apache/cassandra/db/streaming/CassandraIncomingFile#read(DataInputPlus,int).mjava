    @Override
    public synchronized void read(DataInputPlus in, int version) throws IOException
    {
        CassandraStreamHeader streamHeader = CassandraStreamHeader.serializer.deserialize(in, version);
        CassandraStreamReader reader = !streamHeader.isCompressed()
                                       ? new CassandraStreamReader(header, streamHeader, session)
                                       : new CompressedCassandraStreamReader(header, streamHeader, session);
        size = streamHeader.size();
        sstable = reader.read(in);
    }

