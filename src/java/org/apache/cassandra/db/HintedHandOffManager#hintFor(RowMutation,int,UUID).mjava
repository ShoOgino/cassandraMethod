    /**
     * Returns a mutation representing a Hint to be sent to <code>targetId</code>
     * as soon as it becomes available again.
     */
    public static RowMutation hintFor(RowMutation mutation, int ttl, UUID targetId)
    {
        assert ttl > 0;
        UUID hintId = UUIDGen.getTimeUUID();
        // serialize the hint with id and version as a composite column name
        ByteBuffer name = comparator.decompose(hintId, MessagingService.current_version);
        ByteBuffer value = ByteBuffer.wrap(FBUtilities.serialize(mutation, RowMutation.serializer, MessagingService.current_version));
        ColumnFamily cf = ArrayBackedSortedColumns.factory.create(Schema.instance.getCFMetaData(Keyspace.SYSTEM_KS, SystemKeyspace.HINTS_CF));
        cf.addColumn(name, value, System.currentTimeMillis(), ttl);
        return new RowMutation(Keyspace.SYSTEM_KS, UUIDType.instance.decompose(targetId), cf);
    }

