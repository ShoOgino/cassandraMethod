    @SuppressWarnings("resource")
    public static BloomFilter deserialize(DataInput in, boolean offheap, boolean oldBfHashOrder) throws IOException
    {
        int hashes = in.readInt();
        IBitSet bs = offheap ? OffHeapBitSet.deserialize(in) : OpenBitSet.deserialize(in);

        return new BloomFilter(hashes, bs, oldBfHashOrder);
    }

