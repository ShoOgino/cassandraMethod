    public void setup()
    {
        loadRoleStatement = (SelectStatement) prepare("SELECT * from %s.%s WHERE role = ?",
                                                      AuthKeyspace.NAME,
                                                      AuthKeyspace.ROLES);
        // If the old users table exists, we may need to migrate the legacy authn
        // data to the new table. We also need to prepare a statement to read from
        // it, so we can continue to use the old tables while the cluster is upgraded.
        // Otherwise, we may need to create a default superuser role to enable others
        // to be added.
        if (Schema.instance.getCFMetaData(AuthKeyspace.NAME, "users") != null)
        {
             legacySelectUserStatement = (SelectStatement) prepare("SELECT * FROM %s.%s WHERE name = ?",
                                                                   AuthKeyspace.NAME,
                                                                   LEGACY_USERS_TABLE);
            scheduleSetupTask(new Runnable()
            {
                public void run()
                {
                    convertLegacyData();
                }
            });
        }
        else
        {
            scheduleSetupTask(new Runnable()
            {
                public void run()
                {
                    setupDefaultRole();
                }
            });
        }
    }

