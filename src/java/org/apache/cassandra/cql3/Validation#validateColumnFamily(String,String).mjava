    /**
     * Retrieves the metadata for the provided keyspace and table name, throwing
     * a meaningful user exception if those doen't exist.
     *
     * @param keyspaceName the keyspace name.
     * @param tableName the table name.
     * @return the metadata for table {@code keyspaceName.tableName} if it
     * exists (otherwise an {@code InvalidRequestException} is thrown).
     *
     * @throws InvalidRequestException if the table requested doesn't exist.
     */
    public static CFMetaData validateColumnFamily(String keyspaceName, String tableName)
    throws InvalidRequestException
    {
        validateKeyspace(keyspaceName);
        if (tableName.isEmpty())
            throw new InvalidRequestException("non-empty table is required");

        CFMetaData metadata = Schema.instance.getCFMetaData(keyspaceName, tableName);
        if (metadata == null)
            throw new InvalidRequestException("unconfigured table " + tableName);

        return metadata;
    }

