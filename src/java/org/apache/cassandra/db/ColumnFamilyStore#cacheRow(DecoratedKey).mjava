    private ColumnFamily cacheRow(DecoratedKey key)
    {
        ColumnFamily cached;
        if ((cached = rowCache.get(key)) == null)
        {
            cached = getTopLevelColumns(QueryFilter.getIdentityFilter(key, new QueryPath(columnFamily)), Integer.MIN_VALUE);
            if (cached == null)
                return null;

            // make a deep copy of column data so we don't keep references to direct buffers, which
            // would prevent munmap post-compaction.
            for (IColumn column : cached.getSortedColumns())
            {
                cached.remove(column.name());
                cached.addColumn(column.localCopy(this));
            }

            // avoid keeping a permanent reference to the original key buffer
            rowCache.put(new DecoratedKey(key.token, ByteBufferUtil.clone(key.key)), cached);
        }
        return cached;
    }

