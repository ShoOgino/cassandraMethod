    public static void testCreateStandardSyncTasks(boolean pullRepair)
    {
        List<TreeResponse> treeResponses = Arrays.asList(treeResponse(addr1, range1, "same",      range2, "same", range3, "same"),
                                                         treeResponse(addr2, range1, "different", range2, "same", range3, "different"),
                                                         treeResponse(addr3, range1, "same",      range2, "same", range3, "same"));

        Map<SyncNodePair, SyncTask> tasks = toMap(RepairJob.createStandardSyncTasks(desc,
                                                                                    treeResponses,
                                                                                    addr1, // local
                                                                                    noTransient(), // transient
                                                                                    false,
                                                                                    pullRepair,
                                                                                    PreviewKind.ALL));

        Assert.assertEquals(2, tasks.size());

        SyncTask task = tasks.get(pair(addr1, addr2));
        Assert.assertTrue(task.isLocal());
        Assert.assertTrue(((LocalSyncTask) task).requestRanges);
        Assert.assertEquals(!pullRepair, ((LocalSyncTask) task).transferRanges);
        Assert.assertEquals(Arrays.asList(range1, range3), task.rangesToSync);

        task = tasks.get(pair(addr2, addr3));
        Assert.assertFalse(task.isLocal());
        Assert.assertTrue(task instanceof SymmetricRemoteSyncTask);
        Assert.assertEquals(Arrays.asList(range1, range3), task.rangesToSync);

        Assert.assertNull(tasks.get(pair(addr1, addr3)));
    }

