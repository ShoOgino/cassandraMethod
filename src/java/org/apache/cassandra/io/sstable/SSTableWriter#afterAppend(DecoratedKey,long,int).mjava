    private void afterAppend(DecoratedKey decoratedKey, long dataPosition, int dataSize) throws IOException
    {
        byte[] diskKey = partitioner.convertToDiskFormat(decoratedKey);
        // FIXME: needs format change
        bf.add(new String(diskKey, FBUtilities.UTF8));
        lastWrittenKey = decoratedKey;
        long indexPosition = indexFile.getFilePointer();
        FBUtilities.writeShortByteArray(diskKey, indexFile);
        indexFile.writeLong(dataPosition);
        if (logger.isTraceEnabled())
            logger.trace("wrote " + decoratedKey + " at " + dataPosition);
        if (logger.isTraceEnabled())
            logger.trace("wrote index of " + decoratedKey + " at " + indexPosition);

        indexSummary.maybeAddEntry(decoratedKey, dataPosition, dataSize, indexPosition, indexFile.getFilePointer());
    }

