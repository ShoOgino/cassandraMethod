    public void write(DataOutput out) throws IOException
    {
        long dataSize = headerBuffer.getLength() + buffer.getLength();
        assert dataSize > 0;
        out.writeLong(dataSize);
        out.write(headerBuffer.getData(), 0, headerBuffer.getLength());
        out.write(buffer.getData(), 0, buffer.getLength());
    }

