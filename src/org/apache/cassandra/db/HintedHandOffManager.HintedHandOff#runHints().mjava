        private void runHints()
        {
            logger_.debug("Started  hinted handoff " + columnFamilyStore_.columnFamily_);

            // 1. Scan through all the keys that we need to handoff
            // 2. For each key read the list of recepients and send
            // 3. Delete that recepient from the key if write was successful
            // 4. If all writes were success for a given key we can even delete the key .
            // 5. Now force a flush
            // 6. Do major compaction to clean up all deletes etc.
            // 7. I guess we r done
            Table table =  Table.open(DatabaseDescriptor.getTables().get(0));
            ColumnFamily hintedColumnFamily = null;
            boolean success = false;
            boolean allsuccess = true;
            try
            {
            	hintedColumnFamily = table.get(key_, Table.hints_);
            	if(hintedColumnFamily == null)
            	{
                    // Force flush now
                    columnFamilyStore_.forceFlush(false);
            		return;
            	}
            	Collection<IColumn> keys = hintedColumnFamily.getAllColumns();
            	if(keys != null)
            	{
                	for(IColumn key : keys)
                	{
                		// Get all the endpoints for teh key
                		Collection<IColumn> endpoints =  key.getSubColumns();
                		allsuccess = true;
                		if ( endpoints != null )
                		{
                			for(IColumn endpoint : endpoints )
                			{
                				success = sendMessage(endpoint.name(), key.name());
                				if(success)
                				{
                					// Delete the endpoint from the list
                					deleteEndPoint(endpoint.name(), key.name());
                				}
                				else
                				{
                					allsuccess = false;
                				}
                			}
                		}
                		if(endpoints == null || allsuccess)
                		{
                			// Delete the key itself.
                			deleteKey(key.name());
                		}
                	}
            	}
                // Force flush now
                columnFamilyStore_.forceFlush(false);

                // Now do a major compaction
                columnFamilyStore_.forceCompaction(null, null, 0, null);
            }
            catch ( Exception ex)
            {
            	logger_.warn(ex.getMessage());
            }
            logger_.debug("Finished hinted handoff ..."+columnFamilyStore_.columnFamily_);
        }

