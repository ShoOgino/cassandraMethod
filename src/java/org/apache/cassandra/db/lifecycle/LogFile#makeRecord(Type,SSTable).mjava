    private LogRecord makeRecord(Type type, SSTable table)
    {
        assert type == Type.ADD || type == Type.REMOVE;

        File folder = table.descriptor.directory;
        replicas.maybeCreateReplica(folder, getFileName(folder), records);
        return LogRecord.make(type, table);
    }

