    /**
     * Clean up all opened resources.
     *
     * @throws IOException
     */
    public void close() throws IOException
    {
        if (readMeterSyncFuture != null)
            readMeterSyncFuture.cancel(false);

        // if this SSTR was replaced by a new SSTR with a different index summary, the two instances will share
        // resources, so don't force unmapping, clear the FileCacheService entry, or close the BF
        if (!isReplaced.get())
        {
            // Force finalizing mmapping if necessary
            ifile.cleanup();
            dfile.cleanup();
            // close the BF so it can be opened later.
            bf.close();
        }
        indexSummary.close();
    }

