    public void abort()
    {
        switchWriter(null, true);
        moveStarts(null, Functions.forMap(originalStarts), true);

        // remove already completed SSTables
        for (SSTableReader sstable : finished)
        {
            sstable.markObsolete();
            sstable.sharedRef().release();
        }

        // abort the writers
        for (Finished finished : finishedEarly)
        {
            boolean opened = finished.reader != null;
            finished.writer.abort(!opened);
            if (opened)
            {
                // if we've already been opened, add ourselves to the discard pile
                discard.add(finished.reader);
                finished.reader.markObsolete();
            }
        }

        replaceWithFinishedReaders(Collections.<SSTableReader>emptyList());
    }

