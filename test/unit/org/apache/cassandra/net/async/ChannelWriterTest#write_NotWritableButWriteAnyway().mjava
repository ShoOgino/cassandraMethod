    @Test
    public void write_NotWritableButWriteAnyway()
    {
        channel.config().setOption(ChannelOption.WRITE_BUFFER_WATER_MARK, new WriteBufferWaterMark(1, 2));

        // send one message through, which will trigger the writability check (and turn it off)
        Assert.assertTrue(channel.isWritable());
        ByteBuf buf = channel.alloc().buffer(8, 8);
        channel.unsafe().outboundBuffer().addMessage(buf, buf.capacity(), channel.newPromise());
        Assert.assertFalse(channel.isWritable());
        Assert.assertTrue(channelWriter.write(new QueuedMessage(new MessageOut<>(ECHO), 42), false));
        Assert.assertTrue(channel.isWritable());
        Assert.assertTrue(channel.releaseOutbound());
    }

