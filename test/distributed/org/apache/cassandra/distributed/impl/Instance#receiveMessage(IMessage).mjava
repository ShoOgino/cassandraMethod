    public void receiveMessage(IMessage message)
    {
        sync(() -> {
            try (DataInputStream in = new DataInputStream(new ByteArrayInputStream(message.bytes())))
            {
                MessageIn<?> messageIn = MessageIn.read(in, message.version(), message.id());
                Runnable deliver = new MessageDeliveryTask(messageIn, message.id(), System.currentTimeMillis(), false);
                deliver.run();
            }
            catch (Throwable t)
            {
                throw new RuntimeException("Exception occurred on node " + broadcastAddressAndPort(), t);
            }
        }).run();
    }

