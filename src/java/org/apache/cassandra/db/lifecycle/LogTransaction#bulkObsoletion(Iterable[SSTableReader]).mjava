    Map<SSTableReader, SSTableTidier> bulkObsoletion(Iterable<SSTableReader> sstables)
    {
        if (!txnFile.isEmpty())
            throw new IllegalStateException("Bad state when doing bulk obsoletions");

        txnFile.addAll(Type.REMOVE, sstables);
        Map<SSTableReader, SSTableTidier> tidiers = new HashMap<>();
        for (SSTableReader sstable : sstables)
        {
            if (tracker != null)
                tracker.notifyDeleting(sstable);
            tidiers.put(sstable, new SSTableTidier(sstable, false, this));
        }
        return tidiers;
    }

