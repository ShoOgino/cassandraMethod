    @Test
    public void testValidatorPrepare() throws Throwable
    {
        Validator validator;

        // open an SSTable to give us something to sample
        TreeMap<String, byte[]> map = new TreeMap<String,byte[]>();
        for ( int i = 0; i < 1000; i++ )
        {
            map.put(Integer.toString(i), "blah".getBytes());
        }

        // write
        SSTableReader ssTable =
            SSTableUtils.writeSSTable(cfname, map, 1000,
                                      StorageService.instance().getPartitioner(), 0.01);
        tablename = ssTable.getTableName();

        // sample
        validator = new Validator(new CFTuple(tablename, cfname), LOCAL);
        validator.prepare();

        // and confirm that the tree was split
        assertTrue(validator.tree.size() > 1);
    }

