    private ByteBufDataOutputStreamPlus(StreamSession session, Channel channel, ByteBuf buffer, int bufferSize)
    {
        super(buffer.nioBuffer(0, bufferSize));
        this.session = session;
        this.channel = channel;
        this.currentBuf = buffer;
        this.bufferSize = bufferSize;

        channelRateLimiter = new Semaphore(channel.config().getWriteBufferHighWaterMark(), true);
    }

