    /**
     * Load up non-system tables and set schema version to the given value
     *
     * @param tableDefs The non-system table definitions
     * @param version The version of the schema
     *
     * @return self to support chaining calls
     */
    public Schema load(Collection<KSMetaData> tableDefs, UUID version)
    {
        for (KSMetaData def : tableDefs)
        {
            if (!Migration.isLegalName(def.name))
                throw new RuntimeException("invalid keyspace name: " + def.name);

            for (CFMetaData cfm : def.cfMetaData().values())
            {
                if (!Migration.isLegalName(cfm.cfName))
                    throw new RuntimeException("invalid column family name: " + cfm.cfName);

                try
                {
                    load(cfm);
                }
                catch (ConfigurationException ex)
                {
                    throw new IOError(ex);
                }
            }

            setTableDefinition(def, version);
        }

        setVersion(version);

        return this;
    }

