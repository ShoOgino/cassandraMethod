    private static Predicate<SSTableReader> getPreviewPredicate(PreviewKind previewKind)
    {
        switch (previewKind)
        {
            case ALL:
                return (s) -> true;
            case REPAIRED:
                return (s) -> s.isRepaired();
            case UNREPAIRED:
                return (s) -> !s.isRepaired();
            default:
                throw new RuntimeException("Can't get preview predicate for preview kind " + previewKind);
        }
    }

