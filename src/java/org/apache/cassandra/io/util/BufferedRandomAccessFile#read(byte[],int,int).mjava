    @Override
    // -1 will be returned if there is nothing to read; higher-level methods like readInt
    // or readFully (from RandomAccessFile) will throw EOFException but this should not
    public int read(byte[] buff, int offset, int length) throws IOException
    {
        if (length == 0)
            return 0;

        if (isEOF())
            return -1;

        if (current >= bufferOffset + buffer.length)
            reBuffer();
        assert current >= bufferOffset && current < bufferOffset + validBufferBytes;

        int toCopy = Math.min(length, validBufferBytes - (int) (current - bufferOffset));
        System.arraycopy(buffer, (int) (current - bufferOffset), buff, offset, toCopy);
        current += toCopy;

        return toCopy;
    }

