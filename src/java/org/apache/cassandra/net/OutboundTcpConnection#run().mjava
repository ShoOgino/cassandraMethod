    public void run()
    {
        while (true)
        {
            Pair<Message, String> pair = take();
            Message m = pair.left;
            String id = pair.right;
            if (m == CLOSE_SENTINEL)
            {
                disconnect();
                continue;
            }
            if (socket != null || connect())
                writeConnected(m, id);
            else
                // clear out the queue, else gossip messages back up.
                queue.clear();            
        }
    }

