    @Test
    public void testSingleWrite() throws IOException {
        File f = tempSSTableFileName();

        // write test data
        SSTableWriter writer = new SSTableWriter(f.getAbsolutePath(), 1, new OrderPreservingPartitioner());
        Random random = new Random();
        byte[] bytes = new byte[1024];
        random.nextBytes(bytes);

        String key = Integer.toString(1);
        writer.append(key, bytes);
        SSTableReader ssTable = writer.closeAndOpenReader();

        // verify
        verifySingle(ssTable, bytes, key);
        SSTableReader.reopenUnsafe(); // force reloading the index
        verifySingle(ssTable, bytes, key);
    }

