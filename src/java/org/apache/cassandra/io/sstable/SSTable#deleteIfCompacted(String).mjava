    /**
     * We use a ReferenceQueue to manage deleting files that have been compacted
     * and for which no more SSTable references exist.  But this is not guaranteed
     * to run for each such file because of the semantics of the JVM gc.  So,
     * we write a marker to `compactedFilename` when a file is compacted;
     * if such a marker exists on startup, the file should be removed.
     *
     * @return true if the file was deleted
     */
    public static boolean deleteIfCompacted(String dataFilename)
    {
        if (new File(compactedFilename(dataFilename)).exists())
        {
            try
            {
                FileUtils.deleteWithConfirm(new File(dataFilename));
                FileUtils.deleteWithConfirm(new File(SSTable.indexFilename(dataFilename)));
                FileUtils.deleteWithConfirm(new File(SSTable.filterFilename(dataFilename)));
                FileUtils.deleteWithConfirm(new File(SSTable.compactedFilename(dataFilename)));
            }
            catch (IOException e)
            {
                throw new IOError(e);
            }
            logger.info("Deleted " + dataFilename);
            return true;
        }
        return false;
    }

