    protected <D extends SpecificRecord> D serDe(D record) throws IOException
    {
        D actual = SerDeUtils.<D>deserialize(record.getSchema(), SerDeUtils.serialize(record));
        assert actual.equals(record) : actual + " != " + record;
        return actual;
    }

