    /*
     * Create the metadata tables. This table has information about
     * the table name and the column families that make up the table.
     * Each column family also has an associated ID which is an int.
    */
    public static void storeMetadata() throws IOException
    {
        int cfId = 0;
        Set<String> tables = tableToCFMetaDataMap_.keySet();

        for ( String table : tables )
        {
            Table.TableMetadata tmetadata = Table.TableMetadata.instance(table);
            if (tmetadata.isEmpty())
            {
                tmetadata = Table.TableMetadata.instance(table);
                /* Column families associated with this table */
                Map<String, CFMetaData> columnFamilies = tableToCFMetaDataMap_.get(table);

                for (String columnFamily : columnFamilies.keySet())
                {
                    tmetadata.add(columnFamily, cfId++, DatabaseDescriptor.getColumnType(table, columnFamily));
                }

                /*
                 * Here we add all the system related column families.
                */
                /* Add the TableMetadata column family to this map. */
                tmetadata.add(Table.TableMetadata.cfName_, cfId++);
                /* Add the LocationInfo column family to this map. */
                tmetadata.add(SystemTable.cfName_, cfId++);
                /* Add the recycle column family to this map. */
                tmetadata.add(Table.recycleBin_, cfId++);
                /* Add the Hints column family to this map. */
                tmetadata.add(Table.hints_, cfId++, ColumnFamily.getColumnType("Super"));
                tmetadata.apply();
            }

            /*
             * Here we add all the system related column families.
            */
            /* Add the LocationInfo column family to this map. */
            tmetadata.add(SystemTable.cfName_, cfId++);
            /* Add the recycle column family to this map. */
            tmetadata.add(Table.recycleBin_, cfId++);
            /* Add the Hints column family to this map. */
            tmetadata.add(Table.hints_, cfId++, ColumnFamily.getColumnType("Super"));
        }
    }

