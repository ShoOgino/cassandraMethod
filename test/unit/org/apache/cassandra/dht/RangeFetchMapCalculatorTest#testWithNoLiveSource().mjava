    @Test (expected = IllegalStateException.class)
    public void testWithNoLiveSource() throws Exception
    {
        Multimap<Range<Token>, InetAddressAndPort> rangesWithSources = HashMultimap.create();
        addNonTrivialRangeAndSources(rangesWithSources, 1, 10, "127.0.0.5");
        addNonTrivialRangeAndSources(rangesWithSources, 11, 20, "127.0.0.2");
        addNonTrivialRangeAndSources(rangesWithSources, 21, 30, "127.0.0.3");

        final RangeStreamer.ISourceFilter allDeadFilter = new RangeStreamer.ISourceFilter()
        {
            public boolean shouldInclude(InetAddressAndPort endpoint)
            {
                return false;
            }
        };

        RangeFetchMapCalculator calculator = new RangeFetchMapCalculator(rangesWithSources, Arrays.asList(allDeadFilter), "Test");
        calculator.getRangeFetchMap();
    }

