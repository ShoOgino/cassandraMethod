    @Test
    public void testInvalidDDLOperations() throws Throwable
    {
        assertInvalidMessage("Cannot drop virtual keyspaces",
                             "DROP KEYSPACE test_virtual_ks");

        assertInvalidMessage("Cannot alter virtual keyspaces",
                             "ALTER KEYSPACE test_virtual_ks WITH durable_writes = false");

        assertInvalidMessage("Cannot create tables in virtual keyspaces",
                             "CREATE TABLE test_virtual_ks.test (id int PRIMARY KEY)");

        assertInvalidMessage("Cannot create types in virtual keyspaces",
                             "CREATE TYPE test_virtual_ks.type (id int)");

        assertInvalidMessage("Cannot drop virtual tables",
                             "DROP TABLE test_virtual_ks.vt1");

        assertInvalidMessage("Cannot alter virtual tables",
                             "ALTER TABLE test_virtual_ks.vt1 DROP v1");

        assertInvalidMessage("Cannot truncate virtual tables",
                             "TRUNCATE TABLE test_virtual_ks.vt1");

        assertInvalidMessage("Secondary indexes are not supported on virtual tables",
                             "CREATE INDEX ON test_virtual_ks.vt1 (v1)");

        assertInvalidMessage("Materialized views are not supported on virtual tables",
                             "CREATE MATERIALIZED VIEW test_virtual_ks.mvt1 AS SELECT c, v1 FROM test_virtual_ks.vt1 WHERE c IS NOT NULL PRIMARY KEY(c)");

        assertInvalidMessage("Cannot CREATE TRIGGER against a virtual table",
                             "CREATE TRIGGER test_trigger ON test_virtual_ks.vt1 USING '" + TestTrigger.class.getName() + '\'');
    }

