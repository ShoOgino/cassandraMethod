    public int compareTo(DecoratedKey other)
    {
        assert (token == null) == (other.token == null);
        if (token == null)
            return key.compareTo(other.key);
        int i = token.compareTo(other.token);
        return i == 0 ? key.compareTo(other.key) : i;
    }

