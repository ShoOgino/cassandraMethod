    public boolean replace(Cell oldCell, Cell newCell)
    {
        if (!oldCell.name().equals(newCell.name()))
            throw new IllegalArgumentException();

        // We are not supposed to put the newCell is either there was not
        // column or the column was not equal to oldCell (to be coherent
        // with other implementation). We optimize for the common case where
        // oldCell do is present though.
        Cell previous = map.put(oldCell.name(), newCell);
        if (previous == null)
        {
            map.remove(oldCell.name());
            return false;
        }
        if (!previous.equals(oldCell))
        {
            map.put(oldCell.name(), previous);
            return false;
        }
        return true;
    }

