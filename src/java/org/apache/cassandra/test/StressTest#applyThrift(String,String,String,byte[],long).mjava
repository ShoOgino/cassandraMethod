	public void applyThrift(String table, String key, String columnFamily, byte[] bytes, long ts ) {

		try {
			if ( requestsPerSecond_ > 1000)
				Thread.sleep(0, 1000000000/requestsPerSecond_);
			else
				Thread.sleep(1000/requestsPerSecond_);
			peerstorageClient_.insert(table, key, columnFamily, bytes, ts, false);
		} catch (Exception e) {
			try {
				peerstorageClient_ = connect();
				peerstorageClient_.insert(table, key, columnFamily, bytes, ts, false);
			} catch (Exception e1) {
				e1.printStackTrace();
			}
		}
	}

