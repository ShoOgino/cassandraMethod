    @Test
    public void getPreferredRemoteAddrUsesPreferredIp() throws UnknownHostException
    {
        MessagingService ms = MessagingService.instance();
        InetAddressAndPort remote = InetAddressAndPort.getByNameOverrideDefaults("127.0.0.115", 7000);

        InetAddressAndPort preferredIp = InetAddressAndPort.getByName("127.0.0.16");
        SystemKeyspace.updatePreferredIP(remote, preferredIp);

        Assert.assertEquals(preferredIp, ms.getPreferredRemoteAddr(remote));
    }

