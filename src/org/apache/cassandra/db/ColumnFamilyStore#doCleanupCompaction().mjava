    /**
     * This function goes over each file and removes the keys that the node is not responsible for 
     * and only keeps keys that this node is responsible for.
     * @throws IOException
     */
    void doCleanupCompaction() throws IOException
    {
        isCompacting_.set(true);
        List<String> files = new ArrayList<String>(ssTables_);
        for(String file: files)
        {
	        try
	        {
	        	doCleanup(file);
	        }
	        catch ( Exception ex)
	        {
	        	ex.printStackTrace();
	        }
        }
    	isCompacting_.set(false);
    }

