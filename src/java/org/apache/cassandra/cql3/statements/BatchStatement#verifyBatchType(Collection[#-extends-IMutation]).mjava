    private void verifyBatchType(Collection<? extends IMutation> mutations)
    {
        if (type != Type.LOGGED && mutations.size() > 1)
        {
            Set<String> ksCfPairs = new HashSet<>();
            Set<ByteBuffer> keySet = new HashSet<>();

            for (IMutation im : mutations)
            {
                keySet.add(im.key());

                for (ColumnFamily cf : im.getColumnFamilies())
                    ksCfPairs.add(String.format("%s.%s", cf.metadata().ksName, cf.metadata().cfName));
            }

            // CASSANDRA-11529: log only if we have more than a threshold of keys, this was also suggested in the
            // original ticket that introduced this warning, CASSANDRA-9282
            if (keySet.size() > DatabaseDescriptor.getUnloggedBatchAcrossPartitionsWarnThreshold())
            {
                NoSpamLogger.log(logger, NoSpamLogger.Level.WARN, 1, TimeUnit.MINUTES, unloggedBatchWarning,
                                 keySet.size(), ksCfPairs.size() == 1 ? "" : "s", ksCfPairs);

                ClientWarn.instance.warn(MessageFormatter.arrayFormat(unloggedBatchWarning,
                                                                  new Object[]{
                                                                              keySet.size(),
                                                                              ksCfPairs.size() == 1 ? "" : "s",
                                                                              ksCfPairs
                                                                  }).getMessage());
            }
        }
    }

