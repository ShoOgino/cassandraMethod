        // indicates if we may need to repair the mmapped file boundaries. this is a cheap check to see if there
        // are any spans larger than an mmap segment size, which should be rare to occur in practice.
        boolean mayNeedRepair(String path)
        {
            // old boundaries were created without the length, so add it as a candidate
            long length = new File(path).length();
            boundaries.addCandidate(length);
            long[] boundaries = this.boundaries.truncate();

            long prev = 0;
            for (long boundary : boundaries)
            {
                if (boundary - prev > MAX_SEGMENT_SIZE)
                    return true;
                prev = boundary;
            }
            return false;
        }

