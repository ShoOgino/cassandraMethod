    public static ByteBuffer readByteArray(DataInput in) throws IOException
    {
        int length = in.readInt();
        if (length < 0)
        {
            throw new IOException("Corrupt (negative) value length encountered");
        }
       
        ByteBuffer bb = ByteBuffer.allocate(length);
        if (length > 0)
        {
            in.readFully(bb.array(),bb.position(),bb.remaining());
        }
        return bb;
    }

