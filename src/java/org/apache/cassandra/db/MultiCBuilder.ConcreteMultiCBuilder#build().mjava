        public NavigableSet<Clustering> build()
        {
            built = true;

            if (hasMissingElements)
                return FBUtilities.emptySortedSet(comparator);

            CBuilder builder = CBuilder.create(comparator);

            if (elementsList.isEmpty())
                return FBUtilities.singleton(builder.build(), builder.comparator());

            // Use a TreeSet to sort and eliminate duplicates
            NavigableSet<Clustering> set = new TreeSet<>(builder.comparator());

            for (int i = 0, m = elementsList.size(); i < m; i++)
            {
                List<ByteBuffer> elements = elementsList.get(i);
                set.add(builder.buildWith(elements));
            }
            return set;
        }

