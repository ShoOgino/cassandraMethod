    /**
     * Read offsets of the individual chunks from the given input.
     *
     * @param input Source of the data.
     *
     * @return collection of the chunk offsets.
     *
     * @throws java.io.IOException on any I/O error (except EOF).
     */
    private long[] readChunkOffsets(DataInput input) throws IOException
    {
        int chunkCount = input.readInt();
        long[] offsets = new long[chunkCount];

        for (int i = 0; i < offsets.length; i++)
        {
            try
            {
                offsets[i] = input.readLong();
            }
            catch (EOFException e)
            {
                throw new EOFException(String.format("Corrupted Index File %s: read %d but expected %d chunks.",
                                                     indexFilePath,
                                                     i,
                                                     chunkCount));
            }
        }

        return offsets;
    }

