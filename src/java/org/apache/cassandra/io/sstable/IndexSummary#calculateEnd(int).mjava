    private long calculateEnd(int index)
    {
        return index == (summarySize - 1) ? bytes.size() : getPositionInSummary(index + 1);
    }

