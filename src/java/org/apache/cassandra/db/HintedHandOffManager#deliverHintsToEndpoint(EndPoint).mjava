    private static void deliverHintsToEndpoint(EndPoint endPoint)
    {
        logger_.debug("Started hinted handoff for endPoint " + endPoint.getHost());

        // 1. Scan through all the keys that we need to handoff
        // 2. For each key read the list of recepients if teh endpoint matches send
        // 3. Delete that recepient from the key if write was successful
        Table table = Table.open(DatabaseDescriptor.getTables().get(0));
        ColumnFamily hintedColumnFamily = null;
        try
        {
            hintedColumnFamily = table.get(key_, Table.hints_);
            if (hintedColumnFamily == null)
            {
                return;
            }
            Collection<IColumn> keys = hintedColumnFamily.getAllColumns();
            if (keys == null)
            {
                return;
            }

            for (IColumn keyColumn : keys)
            {
                Collection<IColumn> endpoints = keyColumn.getSubColumns();
                if (endpoints == null)
                {
                    deleteKey(keyColumn.name());
                    continue;
                }
                for (IColumn endpoint : endpoints)
                {
                    if (endpoint.name().equals(endPoint.getHost()))
                    {
                        if (sendMessage(endpoint.name(), keyColumn.name()))
                        {
                            deleteEndPoint(endpoint.name(), keyColumn.name());
                        }
                    }
                }
            }
        }
        catch (Exception ex)
        {
            logger_.error(ex.getMessage());
        }
        finally
        {
            logger_.debug("Finished hinted handoff for endpoint " + endPoint.getHost());
        }
    }

