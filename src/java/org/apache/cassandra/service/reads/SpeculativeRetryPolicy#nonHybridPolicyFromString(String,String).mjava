    public static SpeculativeRetryPolicy nonHybridPolicyFromString(String typeStr, String valueStr) throws ConfigurationException
    {
        switch (typeStr.toLowerCase())
        {
            case "p":
            case "percentile":
            {
                double value = Double.parseDouble(valueStr);
                if (value >= 100.0 || value <= 0)
                    throw new ConfigurationException(String.format("PERCENTILE should be between 0 and 100 " +
                                                                   "(not %s)", valueStr));
                return new PercentileSpeculativeRetryPolicy(value);
            }
            case "ms":
            {
                // we've always treated this as long, but let's parse as double for compatibility for now
                double value = Double.parseDouble(valueStr);
                return new FixedSpeculativeRetryPolicy((int) value);
            }
            default:
                throw new ConfigurationException(String.format("invalid speculative_retry type: %s", typeStr));
        }
    }

