    void processFileOrDirectory(Path path)
    {
        Stream.of(path)
              .flatMap(SSTableHeaderFix::maybeExpandDirectory)
              .filter(p -> {
                  File f = p.toFile();
                  return Component.fromFilename(f.getParentFile(), f.getName()).right.type == Component.Type.DATA;
              })
              .map(Path::toString)
              .map(Descriptor::fromFilename)
              .forEach(descriptors::add);
    }

