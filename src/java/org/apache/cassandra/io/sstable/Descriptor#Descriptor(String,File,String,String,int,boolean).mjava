    public Descriptor(String version, File directory, String ksname, String cfname, int generation, boolean temp)
    {
        assert version != null && directory != null && ksname != null && cfname != null;
        this.version = version;
        this.directory = directory;
        this.ksname = ksname;
        this.cfname = cfname;
        this.generation = generation;
        temporary = temp;
        hashCode = Objects.hashCode(directory, generation, ksname, cfname);

        hasStringsInBloomFilter = version.compareTo("c") < 0;
        hasIntRowSize = version.compareTo("d") < 0;
        hasEncodedKeys = version.compareTo("e") < 0;
        usesOldBloomFilter = version.compareTo("f") < 0;
        metadataIncludesReplayPosition = version.compareTo("g") >= 0;
        tracksMaxTimestamp = version.compareTo("h") >= 0;
        hasCompressionRatio = version.compareTo("hb") >= 0;
        isLatestVersion = version.compareTo(CURRENT_VERSION) == 0;
    }

