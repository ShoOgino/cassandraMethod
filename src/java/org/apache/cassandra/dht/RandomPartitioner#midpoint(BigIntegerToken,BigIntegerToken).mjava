    public BigIntegerToken midpoint(BigIntegerToken ltoken, BigIntegerToken rtoken)
    {
        BigInteger left = ltoken.token;
        BigInteger right = rtoken.token;

        BigInteger midpoint;
        if (left.compareTo(right) < 0)
        {
            midpoint = left.add(right).divide(TWO);
        }
        else
        {
            // wrapping case
            BigInteger distance = MD5_MAX.add(right).subtract(left);
            BigInteger unchecked = distance.divide(TWO).add(left);
            midpoint = (unchecked.compareTo(MD5_MAX) > 0) ? unchecked.subtract(MD5_MAX) : unchecked;
        }
        return new BigIntegerToken(midpoint);
    }

