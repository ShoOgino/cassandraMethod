    /**
     * Serialize given ColumnDef into given schema row mutation to add or drop it.
     *
     * @param mutation   The mutation to use for serialization
     * @param comparator The comparator to serialize column name in human-readable format
     * @param cfName     The name of the parent ColumnFamily
     * @param columnName The column name as String
     * @param columnDef  The Thrift-based column definition that contains all attributes
     * @param timestamp  The timestamp to use for column modification
     * @param delete     The flag which indicates if column should be deleted or added to the schema
     */
    private static void toSchema(RowMutation mutation, AbstractType comparator, String cfName, ByteBuffer columnName, ColumnDef columnDef, long timestamp, boolean delete)
    {
        for (ColumnDef._Fields field : ColumnDef._Fields.values())
        {
            QueryPath path = new QueryPath(SystemTable.SCHEMA_COLUMNS_CF,
                                           null,
                                           compositeNameFor(cfName,
                                                            readableColumnName(columnName, comparator),
                                                            field.getFieldName()));

            if (delete)
                mutation.delete(path, timestamp);
            else
                mutation.add(path, valueAsBytes(columnDef.getFieldValue(field)), timestamp);
        }
    }

