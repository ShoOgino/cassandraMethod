    @Test
    public void testSslContextReload_HappyPath() throws IOException, InterruptedException
    {
        try
        {
            EncryptionOptions options = addKeystoreOptions(encryptionOptions);
            options.enabled = true;

            SSLFactory.initHotReloading((ServerEncryptionOptions) options, options, true);

            SslContext oldCtx = SSLFactory.getSslContext(options, true, SSLFactory.ConnectionType.NATIVE_TRANSPORT,
                                                         SSLFactory.SocketType.CLIENT, OpenSsl.isAvailable());
            File keystoreFile = new File(options.keystore);

            SSLFactory.checkCertFilesForHotReloading();
            Thread.sleep(5000);
            keystoreFile.setLastModified(System.currentTimeMillis());

            SSLFactory.checkCertFilesForHotReloading();
            SslContext newCtx = SSLFactory.getSslContext(options, true, SSLFactory.ConnectionType.NATIVE_TRANSPORT,
                                                         SSLFactory.SocketType.CLIENT, OpenSsl.isAvailable());

            Assert.assertNotSame(oldCtx, newCtx);
        }
        catch (Exception e)
        {
            throw e;
        }
        finally
        {
            DatabaseDescriptor.loadConfig();
        }
    }

