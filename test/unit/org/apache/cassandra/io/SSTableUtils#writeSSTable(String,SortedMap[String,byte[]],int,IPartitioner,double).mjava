    public static SSTableReader writeSSTable(String cfname, SortedMap<String, byte[]> entries, int expectedKeys, IPartitioner partitioner, double cacheFraction) throws IOException
    {
        File f = tempSSTableFileName(cfname);
        SSTableWriter writer = new SSTableWriter(f.getAbsolutePath(), expectedKeys, partitioner);
        for (Map.Entry<String, byte[]> entry : entries.entrySet())
        {
            writer.append(writer.partitioner.decorateKey(entry.getKey()), entry.getValue());
        }
        return writer.closeAndOpenReader(cacheFraction);
    }

