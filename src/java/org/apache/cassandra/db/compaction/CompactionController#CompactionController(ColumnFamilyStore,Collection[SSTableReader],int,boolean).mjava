    public CompactionController(ColumnFamilyStore cfs, Collection<SSTableReader> sstables, int gcBefore, boolean forceDeserialize)
    {
        assert cfs != null;
        this.cfs = cfs;
        this.sstables = new HashSet<SSTableReader>(sstables);
        this.gcBefore = gcBefore;
        this.forceDeserialize = forceDeserialize;
        isMajor = cfs.isCompleteSSTables(this.sstables);
        // how many rows we expect to compact in 100ms
        long rowSize = cfs.getMeanRowSize();
        int rowsPerSecond = rowSize > 0
                          ? (int) (DatabaseDescriptor.getCompactionThroughputMbPerSec() * 1024 * 1024 / rowSize)
                          : 1000;
        throttleResolution = rowsPerSecond / 10;
        if (throttleResolution <= 0)
            throttleResolution = 1;
    }

