    /**
     * Registers a new channel with the selector, and attaches the given
     * SelectionKeyHandler as the handler for the newly created key. Operations
     * which the hanlder is interested in will be called as available.
     * 
     * @param channel
     *            The channel to regster with the selector
     * @param handler
     *            The handler to use for the callbacks
     * @param ops
     *            The initial interest operations
     * @return The SelectionKey which uniquely identifies this channel
     * @exception IOException
     */
    public SelectionKey register(SelectableChannel channel,
            SelectionKeyHandler handler, int ops) throws IOException
    {
        if ((channel == null) || (handler == null))
        {
            throw new NullPointerException();
        }

        selector_.wakeup();
        SelectionKey key = channel.register(selector_, ops, handler);
        synchronized(cancelledKeys_)
        {
            cancelledKeys_.remove(key);
        }
        selector_.wakeup();
        return key;
    }      

