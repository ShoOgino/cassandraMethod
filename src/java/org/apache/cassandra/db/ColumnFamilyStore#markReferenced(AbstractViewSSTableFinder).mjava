    private ViewFragment markReferenced(AbstractViewSSTableFinder finder)
    {
        List<SSTableReader> sstables;
        DataTracker.View view;

        while (true)
        {
            view = data.getView();

            if (view.intervalTree.isEmpty())
            {
                sstables = Collections.emptyList();
                break;
            }

            sstables = finder.findSSTables(view);
            if (SSTableReader.acquireReferences(sstables))
                break;
            // retry w/ new view
        }

        return new ViewFragment(sstables, Iterables.concat(Collections.singleton(view.memtable), view.memtablesPendingFlush));
    }

