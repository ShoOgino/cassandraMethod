    private QueuedMessage nextBackloggedMessage()
    {
        QueuedMessage msg = backlog.poll();
        if (msg == null)
            return null;

        if (!msg.isTimedOut())
            return msg;

        if (msg.shouldRetry())
            return msg.createRetry();

        droppedMessageCount.incrementAndGet();
        return null;
    }

