    @Test
    public void testCapExpirationDatePolicyPerRequest() throws Throwable
    {
        // Test cap policy
        Attributes.policy = Attributes.ExpirationDateOverflowPolicy.CAP;

        // simple column, clustering, flush
        baseCapExpirationDateOverflowTest(true, true, true);
        // simple column, clustering, noflush
        baseCapExpirationDateOverflowTest(true, true, false);
        // simple column, noclustering, flush
        baseCapExpirationDateOverflowTest(true, false, true);
        // simple column, noclustering, noflush
        baseCapExpirationDateOverflowTest(true, false, false);
        // complex column, clustering, flush
        baseCapExpirationDateOverflowTest(false, true, true);
        // complex column, clustering, noflush
        baseCapExpirationDateOverflowTest(false, true, false);
        // complex column, noclustering, flush
        baseCapExpirationDateOverflowTest(false, false, true);
        // complex column, noclustering, noflush
        baseCapExpirationDateOverflowTest(false, false, false);
        // complex column, noclustering, flush
        baseCapExpirationDateOverflowTest(false, false, false);

        // Return to previous policy
        Attributes.policy = Attributes.ExpirationDateOverflowPolicy.REJECT;
    }

