    /**
     * @return A SegmentedFile.Builder.
     */
    public static Builder getBuilder(Config.DiskAccessMode mode, boolean compressed)
    {
        assert !compressed || mode != Config.DiskAccessMode.mmap;
        return mode == Config.DiskAccessMode.mmap
               ? new MmappedSegmentedFile.Builder()
               : compressed ? new CompressedSegmentedFile.Builder(null)
                            : new BufferedPoolingSegmentedFile.Builder();
    }

