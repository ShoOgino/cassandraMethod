    @Override
    public void channelInactive(ChannelHandlerContext ctx)
    {
        logger.trace("received channel closed message for peer {} on local addr {}", ctx.channel().remoteAddress(), ctx.channel().localAddress());
        state = State.CLOSED;
        ctx.fireChannelInactive();
    }

