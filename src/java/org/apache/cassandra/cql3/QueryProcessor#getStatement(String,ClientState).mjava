    private static CQLStatement getStatement(String queryStr, ClientState clientState) throws InvalidRequestException, RecognitionException
    {
        CQLStatement statement = parseStatement(queryStr);

        // Set keyspace for statement that require login
        if (statement instanceof CFStatement)
            ((CFStatement)statement).prepareKeyspace(clientState);

        if (statement instanceof Preprocessable)
            statement = ((Preprocessable)statement).preprocess();

        return statement;
    }

