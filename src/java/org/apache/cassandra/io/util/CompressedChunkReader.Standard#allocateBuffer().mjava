        public ByteBuffer allocateBuffer()
        {
            return allocateBuffer(Math.min(maxCompressedLength,
                                           metadata.compressor().initialCompressedBufferLength(metadata.chunkLength())));
        }

