    public static CFMetaData fromThrift(org.apache.cassandra.thrift.CfDef cf_def) throws InvalidRequestException, ConfigurationException
    {
        CFMetaData cfm = internalFromThrift(cf_def);

        if (cf_def.isSetKey_alias() && !(cfm.keyValidator instanceof CompositeType))
            cfm.column_metadata.put(cf_def.key_alias, ColumnDefinition.partitionKeyDef(cf_def.key_alias, cfm.keyValidator, null));

        return cfm.rebuild();
    }

