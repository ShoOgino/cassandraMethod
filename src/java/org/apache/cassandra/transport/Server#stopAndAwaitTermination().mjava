    @VisibleForTesting
    public void stopAndAwaitTermination()
    {
        if (isRunning.compareAndSet(true, false))
            close(true);
    }

