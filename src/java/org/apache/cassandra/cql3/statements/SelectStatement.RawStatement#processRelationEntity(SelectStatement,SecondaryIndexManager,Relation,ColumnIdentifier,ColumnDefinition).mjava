        /** Returns a pair of (hasQueriableIndex, hasQueriableClusteringColumnIndex) */
        private boolean[] processRelationEntity(SelectStatement stmt,
                                                SecondaryIndexManager indexManager,
                                                Relation relation,
                                                ColumnIdentifier entity,
                                                ColumnDefinition def) throws InvalidRequestException
        {
            if (def == null)
                handleUnrecognizedEntity(entity, relation);

            stmt.restrictedColumns.add(def);

            SecondaryIndex index = indexManager.getIndexForColumn(def.name.bytes);
            if (index != null && index.supportsOperator(relation.operator()))
                return new boolean[]{true, def.kind == ColumnDefinition.Kind.CLUSTERING_COLUMN};

            return new boolean[]{false, false};
        }

