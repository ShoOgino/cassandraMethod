    /**
     * Performs a lightweight check whether the certificate files have been refreshed.
     *
     * @throws IllegalStateException if {@link #initHotReloading(EncryptionOptions.ServerEncryptionOptions, EncryptionOptions, boolean)}
     * is not called first
     */
    public static void checkCertFilesForHotReloading()
    {
        if (!isHotReloadingInitialized)
            throw new IllegalStateException("Hot reloading functionality has not been initialized.");

        logger.trace("Checking whether certificates have been updated");

        if (hotReloadableFiles.stream().anyMatch(f -> f.isServer() && f.shouldReload()))
        {
            logger.info("Server ssl certificates have been updated. Reseting the context for new peer connections.");
            serverSslContext.set(null);
        }

        if (hotReloadableFiles.stream().anyMatch(f -> f.isClient() && f.shouldReload()))
        {
            logger.info("Client ssl certificates have been updated. Reseting the context for new client connections.");
            clientSslContext.set(null);
        }
    }

