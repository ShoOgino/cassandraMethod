    public static ISSTableScanner getScanner(SSTableReader sstable, Collection<Range<Token>> tokenRanges, RateLimiter limiter)
    {
        // We want to avoid allocating a SSTableScanner if the range don't overlap the sstable (#5249)
        List<Pair<Long, Long>> positions = sstable.getPositionsForRanges(Range.normalize(tokenRanges));
        if (positions.isEmpty() || !sstable.acquireReference())
            return new EmptySSTableScanner(sstable.getFilename());

        return new BigTableScanner(sstable, tokenRanges, limiter);
    }

