    public static void cleanup() throws IOException
    {
        // clean up commitlog
        String[] directoryNames = {
                DatabaseDescriptor.getLogFileLocation(),
        };
        for (String dirName : directoryNames)
        {
            File dir = new File(dirName);
            if (!dir.exists())
            {
                throw new RuntimeException("No such directory: " + dir.getAbsolutePath());
            }
            for (File f : dir.listFiles())
            {
                FileUtils.deleteWithConfirm(f);
            }
            FileUtils.deleteWithConfirm(dir);
        }

        // clean up data directory which are stored as data directory/table/data files
        for (String dirName : DatabaseDescriptor.getAllDataFileLocations())
        {
            File dir = new File(dirName);
            if (!dir.exists())
            {
                throw new RuntimeException("No such directory: " + dir.getAbsolutePath());
            }
            for (File tableFile : dir.listFiles())
            {
                // table directory
                if (tableFile.isDirectory())
                {
                    for (File dataFile : tableFile.listFiles())
                    {
                        FileUtils.deleteWithConfirm(dataFile);
                    }
                }
                FileUtils.deleteWithConfirm(tableFile);
            }
            FileUtils.deleteWithConfirm(dir);
        }
    }

