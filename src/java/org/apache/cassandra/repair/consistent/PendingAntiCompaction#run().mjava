    public ListenableFuture run()
    {
        ActiveRepairService.ParentRepairSession prs = ActiveRepairService.instance.getParentRepairSession(prsId);
        Collection<ColumnFamilyStore> cfss = prs.getColumnFamilyStores();
        List<ListenableFutureTask<AcquireResult>> tasks = new ArrayList<>(cfss.size());
        for (ColumnFamilyStore cfs : cfss)
        {
            cfs.forceBlockingFlush();
            ListenableFutureTask<AcquireResult> task = ListenableFutureTask.create(new AcquisitionCallable(cfs, ranges, prsId));
            executor.submit(task);
            tasks.add(task);
        }
        ListenableFuture<List<AcquireResult>> acquisitionResults = Futures.successfulAsList(tasks);
        ListenableFuture compactionResult = Futures.transformAsync(acquisitionResults, new AcquisitionCallback(prsId, ranges), MoreExecutors.directExecutor());
        return compactionResult;
    }

