    private void addReadCommandFromColumnFamily(String table, ByteBuffer key, ColumnFamily columnFamily, List<ReadCommand> commands)
    {
        // CF type: regular
        if (!columnFamily.isSuper())
        {
            QueryPath queryPath = new QueryPath(columnFamily.metadata().cfName);
            commands.add(new SliceByNamesReadCommand(table, key, queryPath, columnFamily.getColumnNames()));
        }
        else
        {
            // CF type: super
            for (IColumn superColumn : columnFamily.getSortedColumns())
            {
                QueryPath queryPath = new QueryPath(columnFamily.metadata().cfName, superColumn.name());

                // construct set of sub-column names
                Collection<IColumn> subColumns = superColumn.getSubColumns();
                Collection<ByteBuffer> subColNames = new HashSet<ByteBuffer>(subColumns.size());
                for (IColumn subCol : subColumns)
                {
                    subColNames.add(subCol.name());
                }

                commands.add(new SliceByNamesReadCommand(table, key, queryPath, subColNames));
            }
        }
    }

