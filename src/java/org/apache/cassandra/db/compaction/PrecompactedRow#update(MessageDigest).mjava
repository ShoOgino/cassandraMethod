    public void update(MessageDigest digest)
    {
        if (compactedCf == null)
            return;

        // do not update digest in case of missing or purged row level tombstones, see CASSANDRA-8979
        if (compactedCf.deletionInfo().getTopLevelDeletion() != DeletionTime.LIVE)
        {
            DataOutputBuffer buffer = new DataOutputBuffer();
            try
            {
                DeletionTime.serializer.serialize(compactedCf.deletionInfo().getTopLevelDeletion(), buffer);

                digest.update(buffer.getData(), 0, buffer.getLength());
            }
            catch (IOException e)
            {
                throw new RuntimeException(e);
            }
        }
        compactedCf.updateDigest(digest);
    }

