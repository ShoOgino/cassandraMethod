        public void newArrival(Coalescable message)
        {
            final long timestamp = message.timestampNanos();
            debugTimestamp(timestamp);
            long epoch = this.epoch;
            long delta = timestamp - epoch;
            if (delta < 0)
                // have to simply ignore, but would be a bit unlucky to get such reordering
                return;

            if (delta > INTERVAL)
                epoch = rollEpoch(delta, epoch, timestamp);

            int ix = ix(timestamp);
            samples[ix]++;

            // if we've updated an old bucket, we need to update the sum to match
            if (ix != ix(epoch - 1))
                sum++;
        }

