    /**
     * if the number of SSTables in the current compacted set *by itself* exceeds the target level's
     * (regardless of the level's current contents), find an empty level instead
     */
    private int skipLevels(int newLevel, Iterable<SSTableReader> added)
    {
        // Note that we now check if the sstables included in the compaction, *before* the compaction, fit in the next level.
        // This is needed since we need to decide before the actual compaction what level they will be in.
        // This should be safe, we might skip levels where the compacted data could have fit but that should be ok.
        while (maxBytesForLevel(newLevel) < SSTableReader.getTotalBytes(added)
               && generations[(newLevel + 1)].isEmpty())
        {
            newLevel++;
        }
        return newLevel;
    }

