    /**
     * Writes out a bunch of rows for a single column family.
     *
     * @param rows A group of RowMutations for the same table and column family.
     * @return The ColumnFamilyStore that was used.
     */
    public static ColumnFamilyStore writeColumnFamily(List<IMutation> rms) throws IOException, ExecutionException, InterruptedException
    {
        IMutation first = rms.get(0);
        String tablename = first.getTable();
        Integer cfid = first.getColumnFamilyIds().iterator().next();

        for (IMutation rm : rms)
            rm.apply();

        ColumnFamilyStore store = Table.open(tablename).getColumnFamilyStore(cfid);
        store.forceBlockingFlush();
        return store;
    }

