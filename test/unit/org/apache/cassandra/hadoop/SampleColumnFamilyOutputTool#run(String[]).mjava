    public int run(String[] args)
    throws InvalidRequestException, TException, IOException, InterruptedException, ClassNotFoundException
    {
        Job job = new Job(new Configuration());
        
        // In case your job runs out of memory, use this setting 
        // (provided you're on Hadoop 0.20.1 or later)
        // job.getConfiguration().setInt(JobContext.IO_SORT_MB, 1);
        ConfigHelper.setOutputColumnFamily(job.getConfiguration(),
                                     ColumnFamilyOutputFormatTest.KEYSPACE,
                                     ColumnFamilyOutputFormatTest.COLUMN_FAMILY);

        SequenceFileInputFormat.addInputPath(job, inputdir);
        
        job.setMapperClass(SampleColumnMapper.class);
        job.setMapOutputKeyClass(IntWritable.class);
        job.setMapOutputValueClass(ColumnWritable.class);
        job.setInputFormatClass(SequenceFileInputFormat.class);
        
        // TODO: no idea why this test is passing
        job.setReducerClass(ColumnFamilyOutputReducer.class);
        job.setOutputKeyClass(byte[].class);
        job.setOutputValueClass(SortedMap.class);
        job.setOutputFormatClass(ColumnFamilyOutputFormat.class);
        
        job.waitForCompletion(true);
        return 0;
    }

