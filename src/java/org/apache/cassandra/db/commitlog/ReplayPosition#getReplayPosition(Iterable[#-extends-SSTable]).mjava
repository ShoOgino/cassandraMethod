    /**
     * Convenience method to compute the replay position for a group of SSTables.
     * @param sstables
     * @return the most recent (highest) replay position
     */
    public static ReplayPosition getReplayPosition(Iterable<? extends SSTable> sstables)
    {
        if (Iterables.isEmpty(sstables))
            return NONE;

        Function<SSTable, ReplayPosition> f = new Function<SSTable, ReplayPosition>()
        {
            public ReplayPosition apply(SSTable sstable)
            {
                return sstable.replayPosition;
            }
        };
        Ordering<ReplayPosition> ordering = Ordering.from(ReplayPosition.comparator);
        return ordering.max(Iterables.transform(sstables, f));
    }

