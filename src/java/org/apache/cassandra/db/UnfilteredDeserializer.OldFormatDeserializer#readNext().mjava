        public Unfiltered readNext() throws IOException
        {
            if (!nextIsRow())
            {
                LegacyLayout.LegacyRangeTombstone tombstone = nextAtom.asRangeTombstone();
                // TODO: this is actually more complex, we can have repeated markers etc....
                if (closingMarker == null)
                    throw new UnsupportedOperationException();
                closingMarker = new RangeTombstoneBoundMarker(tombstone.stop.bound, tombstone.deletionTime);
                return new RangeTombstoneBoundMarker(tombstone.start.bound, tombstone.deletionTime);
            }

            LegacyLayout.CellGrouper grouper = nextAtom.isStatic()
                                             ? LegacyLayout.CellGrouper.staticGrouper(metadata, helper)
                                             : this.grouper;

            grouper.reset();
            grouper.addAtom(nextAtom);
            while (deserializeNextAtom() && grouper.addAtom(nextAtom))
            {
            }

            // if this was the first static row, we're done with it. Otherwise, we're also done with static.
            staticFinished = true;
            return grouper.getRow();
        }

