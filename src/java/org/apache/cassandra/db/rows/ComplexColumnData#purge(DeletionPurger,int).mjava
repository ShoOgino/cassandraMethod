    public ComplexColumnData purge(DeletionPurger purger, int nowInSec)
    {
        DeletionTime newDeletion = complexDeletion.isLive() || purger.shouldPurge(complexDeletion) ? DeletionTime.LIVE : complexDeletion;

        int newSize = 0;
        for (Cell cell : cells)
        {
            Cell purged = cell.purge(purger, nowInSec);
            if (purged != null)
                ++newSize;
        }

        if (newSize == 0)
            return newDeletion.isLive() ? null : new ComplexColumnData(column, NO_CELLS, newDeletion);

        if (newDeletion == complexDeletion && newSize == cells.length)
            return this;

        Cell[] newCells = new Cell[newSize];
        int j = 0;
        for (Cell cell : cells)
        {
            Cell purged = cell.purge(purger, nowInSec);
            if (purged != null)
                newCells[j++] = purged;
        }
        assert j == newSize;

        return new ComplexColumnData(column, newCells, newDeletion);
    }

