    public synchronized void replace(Iterable<SSTableReader> removed, Iterable<SSTableReader> added)
    {
        // replace is for compaction operation that don't really change the
        // content of a sstable (cleanup, scrub) and much replace one sstable by another
        assert Iterables.size(removed) == 1;
        assert Iterables.size(added) == 1;
        SSTableReader toRemove = removed.iterator().next();
        SSTableReader toAdd = added.iterator().next();
        logDistribution();
        if (logger.isDebugEnabled())
            logger.debug("Replacing " + removed + " by " + toAdd);

        add(toAdd, remove(toRemove));
        serialize();
    }

