        public C start() throws IOException
        {
            File root = this.root;
            Versions.Version version = this.version;

            if (root == null)
                root = Files.createTempDirectory("dtests").toFile();
            if (version == null)
                version = Versions.CURRENT;

            root.mkdirs();
            setupLogging(root);

            ClassLoader sharedClassLoader = Thread.currentThread().getContextClassLoader();

            List<InstanceConfig> configs = new ArrayList<>();
            long token = Long.MIN_VALUE + 1, increment = 2 * (Long.MAX_VALUE / nodeCount);
            for (int i = 0 ; i < nodeCount ; ++i)
            {
                InstanceConfig config = InstanceConfig.generate(i + 1, subnet, root, String.valueOf(token));
                if (configUpdater != null)
                    configUpdater.accept(config);
                configs.add(config);
                token += increment;
            }

            C cluster = factory.newCluster(root, version, configs, sharedClassLoader);
            cluster.startup();
            return cluster;
        }

