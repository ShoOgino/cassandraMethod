    @VisibleForTesting
    public static void shutdownAndWait() throws InterruptedException
    {
        for (Stage stage : Stage.values())
            StageManager.stages.get(stage).shutdown();
        for (Stage stage : Stage.values())
            StageManager.stages.get(stage).awaitTermination(60, TimeUnit.SECONDS);
    }

