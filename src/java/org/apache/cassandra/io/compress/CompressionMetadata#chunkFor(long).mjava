    /**
     * Get a chunk of compressed data (offset, length) corresponding to given position
     *
     * @param position Position in the file.
     * @return pair of chunk offset and length.
     * @throws java.io.IOException on any I/O error.
     */
    public Chunk chunkFor(long position) throws IOException
    {
        // position of the chunk
        int idx = (int) (position / parameters.chunkLength());

        if (idx >= chunkOffsets.length)
            throw new EOFException();

        long chunkOffset = chunkOffsets[idx];
        long nextChunkOffset = (idx + 1 == chunkOffsets.length)
                                ? compressedFileLength
                                : chunkOffsets[idx + 1];

        return new Chunk(chunkOffset, (int) (nextChunkOffset - chunkOffset - 4)); // "4" bytes reserved for checksum
    }

