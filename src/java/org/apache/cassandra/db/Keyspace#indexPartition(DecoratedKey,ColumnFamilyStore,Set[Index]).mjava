    /**
     * @param key row to index
     * @param cfs ColumnFamily to index partition in
     * @param indexes the indexes to submit the row to
     */
    public static void indexPartition(DecoratedKey key, ColumnFamilyStore cfs, Set<Index> indexes)
    {
        if (logger.isTraceEnabled())
            logger.trace("Indexing partition {} ", cfs.metadata.getKeyValidator().getString(key.getKey()));

        SinglePartitionReadCommand cmd = SinglePartitionReadCommand.fullPartitionRead(cfs.metadata,
                                                                                      FBUtilities.nowInSeconds(),
                                                                                      key);

        try (OpOrder.Group writeGroup = cfs.keyspace.writeOrder.start();
             OpOrder.Group readGroup = cfs.readOrdering.start();
             UnfilteredRowIterator partition = cmd.queryMemtableAndDisk(cfs, readGroup))
        {
            cfs.indexManager.indexPartition(partition, writeGroup, indexes, cmd.nowInSec());
        }
    }

