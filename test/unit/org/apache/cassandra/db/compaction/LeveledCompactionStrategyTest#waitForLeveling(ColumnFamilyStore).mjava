    /**
     * wait for leveled compaction to quiesce on the given columnfamily
     */
    private void waitForLeveling(ColumnFamilyStore cfs) throws InterruptedException
    {
        CompactionStrategyManager strategy = cfs.getCompactionStrategyManager();
        // L0 is the lowest priority, so when that's done, we know everything is done
        while (strategy.getSSTableCountPerLevel()[0] > 1)
            Thread.sleep(100);

        // in AbstractCompationStrategy.replaceSSTables() first we remove and then we add sstables so wait a little bit longer
        Thread.sleep(10);
    }

