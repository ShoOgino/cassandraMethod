    @Test
    public void handleStart_VersionLessThan3_0() throws IOException
    {
        buf = new FirstHandshakeMessage(VERSION_30 - 1, MESSAGING, true).encode(PooledByteBufAllocator.DEFAULT);
        State state = handler.handleStart(channel.pipeline().firstContext(), buf);
        Assert.assertEquals(State.HANDSHAKE_FAIL, state);

        Assert.assertFalse(channel.isOpen());
        Assert.assertFalse(channel.isActive());
    }

