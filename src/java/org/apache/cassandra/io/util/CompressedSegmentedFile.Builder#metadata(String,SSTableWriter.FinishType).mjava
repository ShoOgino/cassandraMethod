        protected CompressionMetadata metadata(String path, SSTableWriter.FinishType finishType)
        {
            if (writer == null)
                return CompressionMetadata.create(path);

            return writer.open(finishType);
        }

