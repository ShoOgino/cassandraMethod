        public boolean appliesTo(FilteredPartition current)
        {
            if (expected == null || expected.isEmpty())
                return current.isEmpty();
            else if (current.isEmpty())
                return false;

            // Check that for everything we expected, the fetched values exists and correspond.
            for (Row e : expected)
            {
                Row c = current.getRow(e.clustering());
                if (c == null)
                    return false;

                for (Cell ce : e)
                {
                    Cell cc = c.getCell(ce.column());
                    if (cc == null || !cc.value().equals(ce.value()))
                        return false;
                }
            }
            return true;
        }

