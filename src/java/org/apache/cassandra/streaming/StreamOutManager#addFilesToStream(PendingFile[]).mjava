    public void addFilesToStream(PendingFile[] pendingFiles)
    {
        // reset the condition in case this SOM is getting reused before it can be removed.
        condition.reset();
        for (PendingFile pendingFile : pendingFiles)
        {
            if (logger.isDebugEnabled())
              logger.debug("Adding file " + pendingFile.getFilename() + " to be streamed.");
            files.add(pendingFile);
            fileMap.put(pendingFile.getFilename(), pendingFile);
            totalBytes += pendingFile.getExpectedBytes();
        }
    }

