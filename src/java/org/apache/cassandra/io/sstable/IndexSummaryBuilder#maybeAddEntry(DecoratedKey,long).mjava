    public IndexSummaryBuilder maybeAddEntry(DecoratedKey decoratedKey, long indexPosition)
    {
        if (keysWritten % minIndexInterval == 0)
        {
            // see if we should skip this key based on our sampling level
            boolean shouldSkip = false;
            for (int start : startPoints)
            {
                if ((indexIntervalMatches - start) % BASE_SAMPLING_LEVEL == 0)
                {
                    shouldSkip = true;
                    break;
                }
            }

            if (!shouldSkip)
            {
                byte[] key = ByteBufferUtil.getArray(decoratedKey.key);
                keys.add(key);
                offheapSize += key.length;
                positions.add(indexPosition);
                offheapSize += TypeSizes.NATIVE.sizeof(indexPosition);
            }

            indexIntervalMatches++;
        }
        keysWritten++;

        return this;
    }

