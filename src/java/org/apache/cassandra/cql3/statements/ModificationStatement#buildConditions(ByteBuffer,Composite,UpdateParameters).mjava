    private ColumnFamily buildConditions(ByteBuffer key, Composite clusteringPrefix, UpdateParameters params)
    throws InvalidRequestException
    {
        if (ifNotExists)
            return null;

        ColumnFamily cf = TreeMapBackedSortedColumns.factory.create(cfm);

        // CQL row marker
        if (cfm.isCQL3Table())
            cf.addColumn(params.makeColumn(cfm.comparator.rowMarker(clusteringPrefix), ByteBufferUtil.EMPTY_BYTE_BUFFER));

        // Conditions
        for (Operation condition : columnConditions)
            condition.execute(key, cf, clusteringPrefix, params);

        assert !cf.isEmpty();
        return cf;
    }

