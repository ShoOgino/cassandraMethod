    @Test
    public void testLoggedPartitionsPerBatch() {
        int partitionsPerBatchCountPre = (int) metrics.partitionsPerLoggedBatch.getCount();
        executeBatch(true, 10, 2);
        assertEquals(partitionsPerBatchCountPre+1, metrics.partitionsPerLoggedBatch.getCount());
        assertTrue(partitionsPerBatchCountPre <= metrics.partitionsPerLoggedBatch.getSnapshot().getMax()); // decayingBuckets may not have exact value

        partitionsPerBatchCountPre = (int) metrics.partitionsPerLoggedBatch.getCount();
        executeBatch(true, 21, 2);
        assertEquals(partitionsPerBatchCountPre+1, metrics.partitionsPerLoggedBatch.getCount());
        assertTrue(partitionsPerBatchCountPre <= metrics.partitionsPerLoggedBatch.getSnapshot().getMax());
    }

