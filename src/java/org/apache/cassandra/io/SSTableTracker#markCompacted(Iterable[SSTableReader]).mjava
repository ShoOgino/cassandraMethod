    // todo replace w/ compactionfinished for CASSANDRA-431
    public synchronized void markCompacted(Iterable<SSTableReader> compacted) throws IOException
    {
        Set<SSTableReader> sstablesNew = new HashSet<SSTableReader>(sstables);
        for (SSTableReader sstable : compacted)
        {
            sstablesNew.remove(sstable);
            sstable.markCompacted();
        }
        sstables = Collections.unmodifiableSet(sstablesNew);
    }

