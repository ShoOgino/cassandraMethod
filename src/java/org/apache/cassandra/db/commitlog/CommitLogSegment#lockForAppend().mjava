    // obtain the current AppendLock and lock it for record appending
    private AppendLock lockForAppend()
    {
        while (true)
        {
            AppendLock appendLock = this.appendLock.get();
            if (appendLock.lock())
                return appendLock;
        }
    }

