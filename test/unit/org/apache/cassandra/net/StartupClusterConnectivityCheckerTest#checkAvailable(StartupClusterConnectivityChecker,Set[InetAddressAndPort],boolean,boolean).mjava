    private void checkAvailable(StartupClusterConnectivityChecker checker, Set<InetAddressAndPort> available,
                                boolean shouldPass, boolean checkConnections)
    {
        Sink sink = new Sink(true, true, available);
        MessagingService.instance().addMessageSink(sink);
        Assert.assertEquals(shouldPass, checker.execute(peers, this::getDatacenter));
        if (checkConnections)
            Assert.assertTrue(checkAllConnectionTypesSeen(sink));
        MessagingService.instance().clearMessageSinks();
    }

