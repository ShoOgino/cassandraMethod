    /**
     * Returns the typed value, serialized to a ByteBuffer according to a
     * comparator/validator.
     * 
     * @return a ByteBuffer of the value.
     * @throws InvalidRequestException if unable to coerce the string to its type.
     */
    public ByteBuffer getByteBuffer(AbstractType<?> validator, List<String> variables) throws InvalidRequestException
    {
        try
        {
            if (!isBindMarker()) return validator.fromString(text);
            
            // must be a marker term so check for a CqlBindValue stored in the term
            if (bindIndex == null)
                throw new AssertionError("a marker Term was encountered with no index value");
                        
            return validator.fromString(variables.get(bindIndex));
        }
        catch (MarshalException e)
        {
            throw new InvalidRequestException(e.getMessage());
        }
    }

