    public void testVersion(String version)
    {
        try
        {
            SSTableReader reader = SSTableReader.open(getDescriptor(version));

            List<byte[]> keys = new ArrayList<byte[]>(TEST_DATA.keySet());
            Collections.shuffle(keys);
            BufferedRandomAccessFile file = new BufferedRandomAccessFile(reader.getFilename(), "r");
            for (byte[] key : keys)
            {
                // confirm that the bloom filter does not reject any keys
                file.seek(reader.getPosition(reader.partitioner.decorateKey(key), SSTableReader.Operator.EQ));
                assert Arrays.equals(key, FBUtilities.readShortByteArray(file));
            }
        }
        catch (Throwable e)
        {
            System.err.println("Failed to read " + version);
            e.printStackTrace(System.err);
        }
    }

