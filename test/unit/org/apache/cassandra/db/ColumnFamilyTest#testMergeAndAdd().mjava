    @Test
    public void testMergeAndAdd()
    {
        ColumnFamily cf_new = new ColumnFamily("Standard1", "Standard");
        ColumnFamily cf_old = new ColumnFamily("Standard1", "Standard");
        ColumnFamily cf_result = new ColumnFamily("Standard1", "Standard");
        byte val[] = "sample value".getBytes();
        byte val2[] = "x value ".getBytes();

        cf_new.addColumn("col1", val, 3);
        cf_new.addColumn("col2", val, 4);

        cf_old.addColumn("col2", val2, 1);
        cf_old.addColumn("col3", val2, 2);

        cf_result.addColumns(cf_new);
        cf_result.addColumns(cf_old);

        assert 3 == cf_result.getColumnCount() : "Count is " + cf_new.getColumnCount();
        //addcolumns will only add if timestamp >= old timestamp
        assert Arrays.equals(val, cf_result.getColumn("col2").value());
    }

