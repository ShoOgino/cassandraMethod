    /**
     * Copies this KSMetaData, adding an additional ColumnFamily.
     */
    public KSMetaData withColumnFamily(CFMetaData cfm)
    {
        List<CFMetaData> newCfs = new ArrayList<CFMetaData>(cfMetaData().values());
        newCfs.add(cfm);
        return new KSMetaData(name, strategyClass, replicationFactor, newCfs.toArray(new CFMetaData[newCfs.size()]));
    }

