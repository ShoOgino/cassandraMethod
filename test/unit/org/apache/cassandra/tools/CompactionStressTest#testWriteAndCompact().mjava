    @Test
    public void testWriteAndCompact()
    {
        ClassLoader classLoader = getClass().getClassLoader();
        File file = new File(classLoader.getResource("blogpost.yaml").getFile());
        String profileFile = file.getAbsolutePath();

        runner.invokeClassAsTool("org.apache.cassandra.stress.CompactionStress",
                                 "write",
                                 "-d",
                                 "build/test/cassandra",
                                 "-g",
                                 "0",
                                 "-p",
                                 profileFile,
                                 "-t",
                                 "4")
              .waitAndAssertOnCleanExit();

        runner.invokeClassAsTool("org.apache.cassandra.stress.CompactionStress",
                                 "compact",
                                 "-d",
                                 "build/test/cassandra",
                                 "-p",
                                 profileFile,
                                 "-t",
                                 "4")
              .waitAndAssertOnCleanExit();
    }

