    @Test
    public void testCounterTableCqlDeletes() throws Throwable
    {
        populateCounterTable();

        assertRows(execute(String.format("select * from %s.%s", KEYSPACE, currentCounterTable())),
                   row("key1", "ck1", "counter1", 10L),
                   row("key1", "ck1", "counter2", 5L),
                   row("key2", "ck1", "counter1", 10L),
                   row("key2", "ck1", "counter2", 5L));

        execute(String.format("DELETE value FROM %s.%s WHERE key = ? AND column1 = ? AND column2 = ?", KEYSPACE, currentCounterTable()),
                "key1", "ck1", "counter1");

        assertRows(execute(String.format("select * from %s.%s", KEYSPACE, currentCounterTable())),
                   row("key1", "ck1", "counter2", 5L),
                   row("key2", "ck1", "counter1", 10L),
                   row("key2", "ck1", "counter2", 5L));

        execute(String.format("DELETE FROM %s.%s WHERE key = ? AND column1 = ?", KEYSPACE, currentCounterTable()),
                "key1", "ck1");

        assertRows(execute(String.format("select * from %s.%s", KEYSPACE, currentCounterTable())),
                   row("key2", "ck1", "counter1", 10L),
                   row("key2", "ck1", "counter2", 5L));

        execute(String.format("DELETE FROM %s.%s WHERE key = ?", KEYSPACE, currentCounterTable()),
                "key2");

        assertEmpty(execute(String.format("select * from %s.%s", KEYSPACE, currentCounterTable())));
    }

