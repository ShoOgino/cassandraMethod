    @Test
    public void decode_ReceivedLowerMsgVersion() throws Exception
    {
        int msgVersion = MESSAGING_VERSION - 1;
        buf = new SecondHandshakeMessage(msgVersion).encode(PooledByteBufAllocator.DEFAULT);
        channel.writeInbound(buf);
        Assert.assertTrue(channel.inboundMessages().isEmpty());

        Assert.assertEquals(msgVersion, callbackHandler.result.negotiatedMessagingVersion);
        Assert.assertEquals(HandshakeResult.Outcome.DISCONNECT, callbackHandler.result.outcome);
        Assert.assertFalse(channel.isOpen());
        Assert.assertTrue(channel.outboundMessages().isEmpty());
    }

