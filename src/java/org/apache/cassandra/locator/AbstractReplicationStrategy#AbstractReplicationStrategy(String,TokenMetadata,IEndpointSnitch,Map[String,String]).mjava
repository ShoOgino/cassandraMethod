    AbstractReplicationStrategy(String tableName, TokenMetadata tokenMetadata, IEndpointSnitch snitch, Map<String, String> configOptions)
    {
        assert tableName != null;
        assert snitch != null;
        assert tokenMetadata != null;
        this.tokenMetadata = tokenMetadata;
        this.snitch = snitch;
        this.tokenMetadata.register(this);
        this.configOptions = configOptions == null ? Collections.<String, String>emptyMap() : configOptions;
        this.tableName = tableName;
        // lazy-initialize table itself since we don't create them until after the replication strategies
    }

