    /**
     * Check to see if the update could possibly modify a view. Cases where the view may be updated are:
     * <ul>
     *     <li>View selects all columns</li>
     *     <li>Update contains any range tombstones</li>
     *     <li>Update touches one of the columns included in the view</li>
     * </ul>
     *
     * If the update contains any range tombstones, there is a possibility that it will not touch a range that is
     * currently included in the view.
     *
     * @return true if {@param partition} modifies a column included in the view
     */
    public boolean updateAffectsView(AbstractBTreePartition partition)
    {
        // If we are including all of the columns, then any update will be included
        if (includeAll)
            return true;

        // If there are range tombstones, tombstones will also need to be generated for the materialized view
        // This requires a query of the base rows and generating tombstones for all of those values
        if (!partition.deletionInfo().isLive())
            return true;

        // Check each row for deletion or update
        for (Row row : partition)
        {
            if (row.hasComplexDeletion())
                return true;
            if (!row.deletion().isLive())
                return true;

            for (ColumnData data : row)
            {
                if (getViewCfs().metadata.getColumnDefinition(data.column().name) != null)
                    return true;
            }
        }

        return false;
    }

