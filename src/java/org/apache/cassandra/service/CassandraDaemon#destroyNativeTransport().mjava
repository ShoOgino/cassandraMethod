    @VisibleForTesting
    public void destroyNativeTransport() throws InterruptedException
    {
        // In 2.2, just stopping the server works. Future versions require `destroy` to be called
        // so we maintain the name for consistency
        if (nativeServer != null)
        {
            nativeServer.stopAndAwaitTermination();
            nativeServer = null;
        }

        if (thriftServer != null)
        {
            thriftServer.stopAndAwaitTermination();
            thriftServer = null;
        }
    }

