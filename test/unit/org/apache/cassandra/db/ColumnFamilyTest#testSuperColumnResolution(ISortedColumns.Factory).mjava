    private void testSuperColumnResolution(ISortedColumns.Factory factory)
    {
        ColumnFamilyStore cfs = Table.open("Keyspace1").getColumnFamilyStore("Super1");
        ColumnFamily cf = ColumnFamily.create(cfs.metadata, factory);
        ByteBuffer superColumnName = ByteBufferUtil.bytes("sc");
        ByteBuffer subColumnName = ByteBufferUtil.bytes(1L);

        Column first = new Column(subColumnName, ByteBufferUtil.bytes("one"), 1L);
        Column second = new Column(subColumnName, ByteBufferUtil.bytes("two"), 2L);

        cf.addColumn(superColumnName, first);

        // resolve older + new
        cf.addColumn(superColumnName, second);
        assertEquals(second, cf.getColumn(superColumnName).getSubColumn(subColumnName));

        // resolve new + older
        cf.addColumn(superColumnName, first);
        assertEquals(second, cf.getColumn(superColumnName).getSubColumn(subColumnName));
    }

