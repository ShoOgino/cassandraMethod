    public Event.SchemaChange announceMigration(QueryState queryState, boolean isLocalOnly) throws ConfigurationException, InvalidRequestException
    {
        TableMetadata current = Schema.instance.getTableMetadata(keyspace(), columnFamily());
        Triggers triggers = current.triggers;

        if (triggers.get(triggerName).isPresent())
        {
            if (ifNotExists)
                return null;
            else
                throw new InvalidRequestException(String.format("Trigger %s already exists", triggerName));
        }

        TableMetadata updated =
            current.unbuild()
                   .triggers(triggers.with(TriggerMetadata.create(triggerName, triggerClass)))
                   .build();

        logger.info("Adding trigger with name {} and class {}", triggerName, triggerClass);

        MigrationManager.announceTableUpdate(updated, isLocalOnly);
        return new Event.SchemaChange(Event.SchemaChange.Change.UPDATED, Event.SchemaChange.Target.TABLE, keyspace(), columnFamily());
    }

