    public void writeValue(Object value, ByteBuf cb)
    {
        switch (this)
        {
            case CUSTOM:
                assert value instanceof String;
                CBUtil.writeString((String)value, cb);
                break;
            case LIST:
                codec.writeOne(DataType.fromType((AbstractType)value), cb);
                break;
            case SET:
                codec.writeOne(DataType.fromType((AbstractType)value), cb);
                break;
            case MAP:
                List<AbstractType> l = (List<AbstractType>)value;
                codec.writeOne(DataType.fromType(l.get(0)), cb);
                codec.writeOne(DataType.fromType(l.get(1)), cb);
                break;
        }
    }

