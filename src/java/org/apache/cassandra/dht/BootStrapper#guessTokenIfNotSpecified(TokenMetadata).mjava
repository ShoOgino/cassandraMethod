    public static void guessTokenIfNotSpecified(TokenMetadata metadata) throws IOException
    {
        StorageService ss = StorageService.instance();
        StorageLoadBalancer slb = StorageLoadBalancer.instance();

        slb.waitForLoadInfo();
        logger.debug("... got load info");

        // if initialtoken was specified, use that.  otherwise, pick a token to assume half the load of the most-loaded node.
        if (DatabaseDescriptor.getInitialToken() == null)
        {
            double maxLoad = 0;
            InetAddress maxEndpoint = null;
            for (Map.Entry<InetAddress, Double> entry : slb.getLoadInfo().entrySet())
            {
                logger.debug("considering " + entry.getKey() + " with load of " + entry.getValue());
                if (!metadata.isMember(entry.getKey()))
                    continue;
                if (maxEndpoint == null || entry.getValue() > maxLoad)
                {
                    maxEndpoint = entry.getKey();
                    maxLoad = entry.getValue();
                }
            }
            if (maxEndpoint == null)
            {
                throw new RuntimeException("No bootstrap sources found");
            }

            assert !maxEndpoint.equals(FBUtilities.getLocalAddress());
            logger.debug("asking " + maxEndpoint + " for token");
            Token<?> t = getBootstrapTokenFrom(maxEndpoint);
            logger.info("New token will be " + t + " to assume load from " + maxEndpoint);
            ss.setToken(t);
        }
    }

