    private static CFMetaData withoutThriftIncompatible(CFMetaData cfm)
    {
        CFMetaData result = cfm.clone();

        // This is a nasty hack to work around the fact that in thrift we exposes:
        //   - neither definition with a non-nulll componentIndex
        //   - nor non REGULAR definitions.
        Iterator<ColumnDefinition> iter = result.allColumns().iterator();
        while (iter.hasNext())
        {
            ColumnDefinition def = iter.next();
            // Remove what we know is not thrift compatible
            if (!def.isThriftCompatible())
                iter.remove();
        }
        return result;
    }

