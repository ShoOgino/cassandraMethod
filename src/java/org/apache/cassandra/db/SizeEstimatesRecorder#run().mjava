    public void run()
    {
        logger.debug("Recording size estimates");

        // find primary token ranges for the local node.
        Collection<Token> localTokens = StorageService.instance.getLocalTokens();
        Collection<Range<Token>> localRanges = StorageService.instance.getTokenMetadata().getPrimaryRangesFor(localTokens);

        for (Keyspace keyspace : Keyspace.nonSystem())
            for (ColumnFamilyStore table : keyspace.getColumnFamilyStores())
                recordSizeEstimates(table, localRanges);
    }

