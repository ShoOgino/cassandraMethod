    /**
     * Memory a ByteBuffer array consumes.
     */
    public static long getArraySize(ByteBuffer[] array)
    {
        long allElementsSize = 0;
        for (int i = 0; i < array.length; i++)
            if (array[i] != null)
                allElementsSize += getSize(array[i]);

        return allElementsSize + getArraySize(array.length, getReferenceSize());
    }

