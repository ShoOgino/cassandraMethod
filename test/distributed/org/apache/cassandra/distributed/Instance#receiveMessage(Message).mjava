    private void receiveMessage(Message message)
    {
        acceptsOnInstance((Message m) ->
        {
            try (DataInputStream in = new DataInputStream(new ByteArrayInputStream(m.bytes)))
            {
                MessageIn<?> messageIn = MessageIn.read(in, m.version, m.id);
                Runnable deliver = new MessageDeliveryTask(messageIn, m.id, System.currentTimeMillis(), false);
                deliver.run();
            }
            catch (Throwable t)
            {
                throw new RuntimeException("Exception occurred on the node " + LegacyAdapter.getBroadcastAddressAndPort(), t);
            }

        }).accept(message);
    }

