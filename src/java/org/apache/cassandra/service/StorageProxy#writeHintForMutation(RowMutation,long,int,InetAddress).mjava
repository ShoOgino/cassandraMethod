    /**
     * @param now current time in milliseconds - relevant for hint replay handling of truncated CFs
     */
    public static void writeHintForMutation(RowMutation mutation, long now, int ttl, InetAddress target) throws IOException
    {
        assert ttl > 0;
        UUID hostId = StorageService.instance.getTokenMetadata().getHostId(target);
        if ((hostId == null) && (MessagingService.instance().getVersion(target) < MessagingService.VERSION_12))
        {
            logger.warn("Unable to store hint for host with missing ID, {} (old node?)", target.toString());
            return;
        }
        assert hostId != null : "Missing host ID for " + target.getHostAddress();
        mutation.toHint(now, ttl, hostId).apply();
        StorageMetrics.totalHints.inc();
    }

