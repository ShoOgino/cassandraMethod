    /**
     * Create a Tables instance with the provided table added
     */
    public Tables with(CFMetaData table)
    {
        if (get(table.cfName).isPresent())
            throw new IllegalStateException(String.format("Table %s already exists", table.cfName));

        return builder().add(this).add(table).build();
    }

