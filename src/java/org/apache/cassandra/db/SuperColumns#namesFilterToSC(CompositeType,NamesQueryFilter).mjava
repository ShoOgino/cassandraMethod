    public static SCFilter namesFilterToSC(CompositeType type, NamesQueryFilter filter)
    {
        ByteBuffer scName = null;
        SortedSet<ByteBuffer> newColumns = new TreeSet<ByteBuffer>(filter.columns.comparator());
        for (ByteBuffer name : filter.columns)
        {
            ByteBuffer newScName = scName(name);

            if (scName == null)
            {
                scName = newScName;
            }
            else if (type.types.get(0).compare(scName, newScName) != 0)
            {
                // If we're selecting column across multiple SC, it's not something we can translate for an old node
                throw new RuntimeException("Cannot convert filter to old super column format. Update all nodes to Cassandra 2.0 first.");
            }

            newColumns.add(subName(name));
        }
        return new SCFilter(scName, new NamesQueryFilter(newColumns));
    }

