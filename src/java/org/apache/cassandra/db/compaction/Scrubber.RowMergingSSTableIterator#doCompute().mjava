        @Override
        protected Unfiltered doCompute()
        {
            if (!iterator.hasNext())
                return endOfData();

            Unfiltered next = iterator.next();
            if (!next.isRow())
                return next;

            while (iterator.hasNext())
            {
                Unfiltered peek = iterator.peek();
                // If there was a duplicate row, merge it.
                if (next.clustering().equals(peek.clustering()) && peek.isRow())
                {
                    iterator.next(); // Make sure that the peeked item was consumed.
                    next = Rows.merge((Row) next, (Row) peek, FBUtilities.nowInSeconds());
                }
                else
                {
                    break;
                }
            }

            return next;
        }

