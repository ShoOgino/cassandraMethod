    public static Row readProtocol(String tablename, String key, String columnFamily, int start, int count, StorageService.ConsistencyLevel consistencyLevel) throws Exception
    {
        Row row = null;
        boolean foundLocal = false;
        EndPoint[] endpoints = StorageService.instance().getNStorageEndPoint(key);
        for(EndPoint endPoint: endpoints)
        {
            if(endPoint.equals(StorageService.getLocalStorageEndPoint()))
            {
                foundLocal = true;
                break;
            }
        }   
        if(!foundLocal && consistencyLevel == StorageService.ConsistencyLevel.WEAK)
        {
            ReadMessage readMessage = null;
            readMessage = new ReadMessage(tablename, key, columnFamily, start, count);
            return doReadProtocol(key, readMessage);
        }
        else
        {
            switch ( consistencyLevel )
            {
            case WEAK:
                row = weakReadProtocol(tablename, key, columnFamily, start, count);
                break;
                
            case STRONG:
                row = strongReadProtocol(tablename, key, columnFamily, start, count);
                break;
                
            default:
                row = weakReadProtocol(tablename, key, columnFamily, start, count);
                break;
            }
        }
        return row;
    }

