    /** {@inheritDoc} */
    public List<RowMutation> prepareRowMutations(String keyspace, ClientState clientState) throws InvalidRequestException
    {
        List<String> cfamsSeen = new ArrayList<String>();

        CFMetaData metadata = validateColumnFamily(keyspace, columnFamily, false);

        // Avoid unnecessary authorizations.
        if (!(cfamsSeen.contains(columnFamily)))
        {
            clientState.hasColumnFamilyAccess(columnFamily, Permission.WRITE);
            cfamsSeen.add(columnFamily);
        }

        List<RowMutation> rowMutations = new LinkedList<RowMutation>();

        for (Term key: keys)
        {
            rowMutations.add(mutationForKey(keyspace, key.getByteBuffer(getKeyType(keyspace)), metadata));
        }

        return rowMutations;
    }

