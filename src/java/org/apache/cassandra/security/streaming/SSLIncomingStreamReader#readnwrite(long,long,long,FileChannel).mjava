    @Override
    protected long readnwrite(long length, long bytesRead, long offset, FileChannel fc) throws IOException
    {
        int toRead = (int)Math.min(FileStreamTask.CHUNK_SIZE, length - bytesRead);
        ByteBuffer buf = ByteBuffer.allocate(toRead);
        input.readFully(buf.array());
        fc.write(buf);
        bytesRead += buf.limit();
        remoteFile.progress += buf.limit();
        return bytesRead;
    }

