    private ISSTableScanner scanner(final ColumnFamilyStore cfs, final UnfilteredPartitionIterator partitions)
    {

        return new ISSTableScanner()
        {
            public long getLengthInBytes() { return 0; }

            public long getCurrentPosition() { return 0; }

            public String getBackingFiles() { return cfs.getLiveSSTables().iterator().next().toString(); }

            public boolean isForThrift() { return false; }

            public CFMetaData metadata() { return cfs.metadata; }

            public void close() { }

            public boolean hasNext() { return partitions.hasNext(); }

            public UnfilteredRowIterator next() { return partitions.next(); }
        };
    }

