    /**
     * Add transfer task to send given SSTable files.
     *
     * @param to endpoint address of receiver
     * @param ranges ranges to send
     * @param sstables files to send
     * @return this object for chaining
     */
    public StreamPlan transferFiles(InetAddress to, Collection<Range<Token>> ranges, Collection<SSTableReader> sstables)
    {
        StreamSession session = getOrCreateSession(to);
        session.addTransferFiles(ranges, sstables);
        return this;
    }

