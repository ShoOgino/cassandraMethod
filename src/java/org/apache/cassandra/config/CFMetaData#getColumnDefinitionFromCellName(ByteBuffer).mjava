    /**
     * Returns a ColumnDefinition given a full (internal) column name.
     */
    public ColumnDefinition getColumnDefinitionFromCellName(ByteBuffer cellName)
    {
        if (!isSuper() && hasCompositeComparator())
        {
            CompositeType composite = (CompositeType)comparator;
            ByteBuffer[] components = composite.split(cellName);
            for (ColumnDefinition def : allColumns())
            {
                ByteBuffer toCompare;
                if (def.isOnAllComponents())
                {
                    toCompare = cellName;
                }
                else
                {
                    if (def.position() >= components.length)
                        break;

                    toCompare = components[def.position()];
                }
                if (def.name.equals(toCompare))
                    return def;
            }
            return null;
        }
        else
        {
            return columnMetadata.get(cellName);
        }
    }

