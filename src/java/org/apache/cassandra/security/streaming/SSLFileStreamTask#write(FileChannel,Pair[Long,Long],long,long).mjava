    @Override
    protected long write(FileChannel fc, Pair<Long, Long> section, long length, long bytesTransferred) throws IOException
    {
        int toTransfer = (int)Math.min(CHUNK_SIZE, length - bytesTransferred);
        fc.position(section.left + bytesTransferred);
        ByteBuffer buf = ByteBuffer.allocate(toTransfer);
        fc.read(buf);
        buf.flip();
        output.write(buf.array(), 0, buf.limit());
        output.flush();
        return buf.limit();
    }

