    /**
     * For testing.  no effort is made to clear historical memtables, nor for
     * thread safety
     */
    public void clearUnsafe()
    {
        fileIndexGenerator.set(0); // Avoid unit test failures (see CASSANDRA-3735).

        // Clear backups
        Directories.SSTableLister lister = directories.sstableLister().onlyBackups(true);
        for (Map.Entry<Descriptor, Set<Component>> entry : lister.list().entrySet())
        {
            Descriptor desc = entry.getKey();
            for (Component comp : entry.getValue())
                FileUtils.delete(desc.filenameFor(comp));
        }

        for (ColumnFamilyStore cfs : concatWithIndexes())
            cfs.data.init();
    }

