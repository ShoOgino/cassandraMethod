    public ByteBuffer serialize(T value)
    {
        List<ByteBuffer> values = serializeValues(value);
        // The only case we serialize/deserialize collections internally (i.e. not for the protocol sake),
        // is when collections are in UDT values. There, we use the protocol 3 version since it's more flexible.
        return pack(values, getElementCount(value), 3);
    }

