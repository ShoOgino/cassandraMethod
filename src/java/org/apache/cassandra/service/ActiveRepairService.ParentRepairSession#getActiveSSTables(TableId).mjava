        private Set<SSTableReader> getActiveSSTables(TableId tableId)
        {
            if (!columnFamilyStores.containsKey(tableId))
                return null;

            Set<String> repairedSSTables = sstableMap.get(tableId);
            Set<SSTableReader> activeSSTables = new HashSet<>();
            Set<String> activeSSTableNames = new HashSet<>();
            ColumnFamilyStore cfs = columnFamilyStores.get(tableId);
            for (SSTableReader sstable : cfs.getSSTables(SSTableSet.CANONICAL))
            {
                if (repairedSSTables.contains(sstable.getFilename()))
                {
                    activeSSTables.add(sstable);
                    activeSSTableNames.add(sstable.getFilename());
                }
            }
            sstableMap.put(tableId, activeSSTableNames);
            return activeSSTables;
        }

