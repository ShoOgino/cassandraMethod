    private boolean addToMutation(ColumnFamily cf,
                                  ColumnNameBuilder builder,
                                  CFDefinition.Name valueDef,
                                  Operation valueOperation,
                                  UpdateParameters params,
                                  List<Pair<ByteBuffer, IColumn>> list) throws InvalidRequestException
    {
        Operation.Type type = valueOperation.getType();

        switch (type)
        {
            case COUNTER:
                if (valueDef != null && valueDef.type.isCollection())
                    throw new InvalidRequestException("Cannot assign collection value to column with " + valueDef.type + " type.");
                break;
            case LIST:
            case SET:
            case MAP:
                if (!valueDef.type.isCollection())
                    throw new InvalidRequestException("Can't apply collection operation on column with " + valueDef.type + " type.");
                break;
        }
        valueOperation.execute(cf, builder.copy(), valueDef == null ? null : valueDef.type, params, list);
        return valueOperation.getType() == Operation.Type.COUNTER;
    }

