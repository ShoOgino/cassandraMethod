        // do not invoke after finish()
        int length()
        {
            assert !isFinished;
            return buffer.position() - headerLength;
        }

