    public void setDigest(ByteBuffer digest)
    {
        ByteBuffer curr = this.digest;
        if (!digestUpdater.compareAndSet(this, curr, digest))
        {
            assert digest.equals(this.digest) :
                String.format("Digest mismatch : %s vs %s",
                              Arrays.toString(digest.array()),
                              Arrays.toString(this.digest.array()));
        }
    }

