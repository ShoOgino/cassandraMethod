    @Test
    public void testValidatorComplete() throws Throwable
    {
        Validator validator = new Validator(new CFTuple(tablename, cfname), LOCAL);
        validator.prepare();
        validator.complete();

        // confirm that the tree was validated
        Token min = validator.tree.partitioner().getMinimumToken();
        assert null != validator.tree.hash(new Range(min, min));

        // wait for queued operations to be flushed
        flushAES().get(5000, TimeUnit.MILLISECONDS);
    }

