    @Test
    public void testManyWrites() throws IOException {
        File f = tempSSTableFileName();

        TreeMap<String, byte[]> map = new TreeMap<String,byte[]>();
        for ( int i = 100; i < 1000; ++i )
        {
            map.put(Integer.toString(i), ("Avinash Lakshman is a good man: " + i).getBytes());
        }

        // write
        SSTableWriter writer = new SSTableWriter(f.getAbsolutePath(), 1000, new OrderPreservingPartitioner());
        for (String key: map.navigableKeySet())
        {
            writer.append(writer.partitioner.decorateKey(key), map.get(key));
        }
        SSTableReader ssTable = writer.closeAndOpenReader(0.01);

        // verify
        verifyMany(ssTable, map);
        SSTableReader.reopenUnsafe(); // force reloading the index
        verifyMany(ssTable, map);
    }

