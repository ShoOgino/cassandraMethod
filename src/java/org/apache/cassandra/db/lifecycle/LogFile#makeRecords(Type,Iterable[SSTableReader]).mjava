    private Collection<LogRecord> makeRecords(Type type, Iterable<SSTableReader> tables)
    {
        assert type == Type.ADD || type == Type.REMOVE;

        for (SSTableReader sstable : tables)
        {
            File folder = sstable.descriptor.directory;
            replicas.maybeCreateReplica(folder, getFileName(folder), records);
        }
        return LogRecord.make(type, tables);
    }

