    @Test
    public void testWaitFirstFuture() throws ExecutionException, InterruptedException
    {

        ExecutorService executor = Executors.newFixedThreadPool(4);
        FBUtilities.reset();
        List<Future<?>> futures = new ArrayList<>();
        for (int i = 4; i >= 1; i--)
        {
            final int sleep = i * 10;
            futures.add(executor.submit(() -> { TimeUnit.MILLISECONDS.sleep(sleep); return sleep; }));
        }
        Future<?> fut = FBUtilities.waitOnFirstFuture(futures, 3);
        int futSleep = (Integer) fut.get();
        assertEquals(futSleep, 10);
        futures.remove(fut);
        fut = FBUtilities.waitOnFirstFuture(futures, 3);
        futSleep = (Integer) fut.get();
        assertEquals(futSleep, 20);
        futures.remove(fut);
        fut = FBUtilities.waitOnFirstFuture(futures, 3);
        futSleep = (Integer) fut.get();
        assertEquals(futSleep, 30);
        futures.remove(fut);
        fut = FBUtilities.waitOnFirstFuture(futures, 3);
        futSleep = (Integer) fut.get();
        assertEquals(futSleep, 40);
    }

