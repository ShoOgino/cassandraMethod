        /**
         * Add matching replica to the result; this predicate should be mutually exclusive with all prior predicates.
         * Stop once we have targetSize replicas in total, including preceding calls
         */
        public Select add(Predicate<Replica> predicate, int targetSize)
        {
            assert !Iterables.any(result, predicate::test);
            for (int i = 0 ; result.size() < targetSize && i < list.size() ; ++i)
                if (predicate.test(list.get(i)))
                    result.add(list.get(i));
            return this;
        }

