    private void finishJoiningRing(boolean didBootstrap)
    {
        // start participating in the ring.
        setMode(Mode.JOINING, "Finish joining ring", true);
        SystemKeyspace.setBootstrapState(SystemKeyspace.BootstrapState.COMPLETED);
        executePreJoinTasks(didBootstrap);
        setTokens(bootstrapTokens);

        assert tokenMetadata.sortedTokens().size() > 0;
        doAuthSetup();
    }

