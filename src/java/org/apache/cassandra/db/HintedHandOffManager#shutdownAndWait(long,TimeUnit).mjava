    @VisibleForTesting
    public void shutdownAndWait(long timeout, TimeUnit units) throws InterruptedException, TimeoutException
    {
        shutdown(executor, hintDeliveryExecutor);
        awaitTermination(timeout, units, executor, hintDeliveryExecutor);
    }

