        public void addConditions(Collection<ColumnCondition> conds, List<ByteBuffer> variables) throws InvalidRequestException
        {
            for (ColumnCondition condition : conds)
            {
                // We will need the variables in appliesTo but with protocol batches, each condition in this object can have a
                // different list of variables. So attach them to the condition directly, it's not particulary elegant but its simpler
                ColumnCondition previous = conditions.put(condition.column.name, condition.attach(variables));
                // If 2 conditions are actually equal, let it slide
                if (previous != null && !previous.equalsTo(condition))
                    throw new InvalidRequestException("Duplicate and incompatible conditions for column " + condition.column.name);
            }
        }

