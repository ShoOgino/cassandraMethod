    @Test
    public void testInsertingIncorrectValuesIntoAgeIndex()
    {
        ColumnFamilyStore store = Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);

        final ByteBuffer firstName = UTF8Type.instance.decompose("first_name");
        final ByteBuffer age = UTF8Type.instance.decompose("age");

        Mutation rm = new Mutation(KS_NAME, decoratedKey(AsciiType.instance.decompose("key1")));
        update(rm, new ArrayList<Cell>()
        {{
            add(buildCell(age, LongType.instance.decompose(26L), System.currentTimeMillis()));
            add(buildCell(firstName, AsciiType.instance.decompose("pavel"), System.currentTimeMillis()));
        }});
        rm.apply();

        try {
            store.forceBlockingFlush();
            Assert.fail("It was possible to insert data of wrong type into a column!");
        } catch (final Throwable ex) {
            Assert.assertTrue(ex.getMessage().endsWith("Expected exactly 4 bytes, but was 8"));
        }
    }

