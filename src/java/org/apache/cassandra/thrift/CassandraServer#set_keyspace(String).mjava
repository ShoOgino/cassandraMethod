    public void set_keyspace(String keyspace) throws InvalidRequestException, TException {
        if (DatabaseDescriptor.getTableDefinition(keyspace) == null)
        {
            throw new InvalidRequestException("Keyspace does not exist");
        }
        
        // If switching, invalidate previous access level; force a new login.
        if (keySpace.get() != null && !keySpace.get().equals(keyspace))
            loginDone.set(AccessLevel.NONE);
        
        keySpace.set(keyspace); 
    }

