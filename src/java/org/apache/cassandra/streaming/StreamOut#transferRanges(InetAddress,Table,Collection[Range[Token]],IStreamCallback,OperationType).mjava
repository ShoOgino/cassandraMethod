    /**
     * Stream the given ranges to the target endpoint from each CF in the given keyspace.
    */
    public static void transferRanges(InetAddress target, Table table, Collection<Range<Token>> ranges, IStreamCallback callback, OperationType type)
    {
        StreamOutSession session = StreamOutSession.create(table.name, target, callback);
        transferRanges(session, table.getColumnFamilyStores(), ranges, type);
    }

