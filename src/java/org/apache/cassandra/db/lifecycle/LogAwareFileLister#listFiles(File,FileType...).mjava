    @VisibleForTesting
    static Set<File> listFiles(File folder, FileType ... types)
    {
        Collection<FileType> match = Arrays.asList(types);
        return new LogAwareFileLister(folder.toPath(),
                                      (file, type) -> match.contains(type),
                                      OnTxnErr.IGNORE).list()
                                                      .stream()
                                                      .collect(Collectors.toSet());
    }

