    public Unfiltered.Kind deserialize(DataInput in,
                                 SerializationHeader header,
                                 SerializationHelper helper,
                                 Row.Writer rowWriter,
                                 RangeTombstoneMarker.Writer markerWriter)
    throws IOException
    {
        int flags = in.readUnsignedByte();
        if (isEndOfPartition(flags))
            return null;

        if (kind(flags) == Unfiltered.Kind.RANGE_TOMBSTONE_MARKER)
        {
            RangeTombstone.Bound.Kind kind = RangeTombstone.Bound.serializer.deserialize(in, helper.version, header.clusteringTypes(), markerWriter);
            deserializeMarkerBody(in, header, kind.isBoundary(), markerWriter);
            return Unfiltered.Kind.RANGE_TOMBSTONE_MARKER;
        }
        else
        {
            assert !isStatic(flags); // deserializeStaticRow should be used for that.
            Clustering.serializer.deserialize(in, helper.version, header.clusteringTypes(), rowWriter);
            deserializeRowBody(in, header, helper, flags, rowWriter);
            return Unfiltered.Kind.ROW;
        }
    }

