    private void replay_Compressed(ParameterizedClass parameterizedClass) throws IOException
    {
        DatabaseDescriptor.setCommitLogCompression(parameterizedClass);
        DatabaseDescriptor.setEncryptionContext(EncryptionContextGenerator.createDisabledContext());
        CommitLog commitLog = new CommitLog(logDirectory, CommitLogArchiver.disabled()).start();
        replaySimple(commitLog);
        replayWithDiscard(commitLog);
    }

