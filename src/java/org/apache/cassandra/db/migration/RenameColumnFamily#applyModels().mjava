    @Override
    public void applyModels() throws IOException
    {
        // leave it up to operators to ensure there are no writes going on durng the file rename. Just know that
        // attempting row mutations on oldcfName right now would be really bad.
        if (!clientMode)
            renameCfStorageFiles(tableName, oldName, newName);
        
        // reset defs.
        KSMetaData ksm = makeNewKeyspaceDefinition(DatabaseDescriptor.getTableDefinition(tableName));
        DatabaseDescriptor.setTableDefinition(ksm, newVersion);
        
        if (!clientMode)
        {
            Table.open(ksm.name).renameCf(cfId, newName);
            CommitLog.instance().forceNewSegment();
        }
    }

