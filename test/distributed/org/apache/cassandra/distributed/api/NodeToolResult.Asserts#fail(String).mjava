        private void fail(String message)
        {
            StringBuilder sb = new StringBuilder();
            sb.append("nodetool command ").append(Arrays.toString(commandAndArgs)).append(" ").append(message).append("\n");
            sb.append("Notifications:\n");
            for (Notification n : notifications)
                sb.append(NodeToolResult.toString(n)).append("\n");
            if (error != null)
                sb.append("Error:\n").append(Throwables.getStackTraceAsString(error)).append("\n");
            throw new AssertionError(sb.toString());
        }

