    /** See if all files are present or if only the last record files are missing and it's a NEW record */
    private static boolean allFilesPresent(LogFile txnFile, Map<LogRecord, Set<File>> oldFiles, Map<LogRecord, Set<File>> newFiles)
    {
        LogRecord lastRecord = txnFile.getLastRecord();
        return !Stream.concat(oldFiles.entrySet().stream(),
                              newFiles.entrySet().stream()
                                      .filter((e) -> e.getKey() != lastRecord))
                      .filter((e) -> e.getKey().numFiles > e.getValue().size())
                      .findFirst().isPresent();
    }

