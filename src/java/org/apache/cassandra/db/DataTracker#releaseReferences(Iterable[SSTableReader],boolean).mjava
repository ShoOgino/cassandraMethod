    private void releaseReferences(Iterable<SSTableReader> oldSSTables, boolean tolerateCompacted)
    {
        for (SSTableReader sstable : oldSSTables)
        {
            boolean firstToCompact = sstable.markObsolete();
            assert tolerateCompacted || firstToCompact : sstable + " was already marked compacted";
            sstable.releaseReference();
        }
    }

