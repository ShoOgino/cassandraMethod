    /**
     * Attempts to login this client with the given credentials map.
     */
    public void login(Map<String,String> credentials) throws AuthenticationException
    {
        AuthenticatedUser user = DatabaseDescriptor.getAuthenticator().authenticate(credentials);
        if (logger.isDebugEnabled())
            logger.debug("logged in: {}", user);
        this.user.set(user);
        updateKeyspaceAccess();
    }

