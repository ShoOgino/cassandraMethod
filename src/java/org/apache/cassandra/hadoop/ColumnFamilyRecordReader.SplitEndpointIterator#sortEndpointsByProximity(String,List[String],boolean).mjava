        private List<String> sortEndpointsByProximity(String connectTo, List<String> endpoints, boolean restrictToSameDC)
                throws InvalidRequestException, TException, IOException
        {
            try
            {
                // try first our configured initialAddress
                return getClient(ConfigHelper.getInitialAddress(conf)).sort_endpoints_by_proximity(location, endpoints,
                        restrictToSameDC);
            }
            catch (IOException ex)
            {
                // connect through the endpoint. if it fails it's no good
                // anyway.
                return getClient(connectTo).sort_endpoints_by_proximity(location, endpoints, restrictToSameDC);
            }
        }

