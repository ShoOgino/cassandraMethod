    public static void writeByteArray(ByteBuffer bytes, DataOutput out) throws IOException
    {
        out.writeInt(bytes.remaining());
        out.write(bytes.array(),bytes.position()+bytes.arrayOffset(),bytes.remaining());
    }

