    @Test
    public void testUnloggedPartitionsPerBatch() {
        int partitionsPerBatchCountPre = (int) metrics.partitionsPerUnloggedBatch.getCount();
        executeBatch(false, 7, 2);
        assertEquals(partitionsPerBatchCountPre+1, metrics.partitionsPerUnloggedBatch.getCount());
        assertTrue(partitionsPerBatchCountPre <= metrics.partitionsPerUnloggedBatch.getSnapshot().getMax());

        partitionsPerBatchCountPre = (int) metrics.partitionsPerUnloggedBatch.getCount();
        executeBatch(false, 25, 2);
        assertEquals(partitionsPerBatchCountPre+1, metrics.partitionsPerUnloggedBatch.getCount());
        assertTrue(partitionsPerBatchCountPre <= metrics.partitionsPerUnloggedBatch.getSnapshot().getMax());
    }

