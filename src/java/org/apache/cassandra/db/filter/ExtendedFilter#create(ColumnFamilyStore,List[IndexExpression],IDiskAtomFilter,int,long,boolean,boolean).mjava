    public static ExtendedFilter create(ColumnFamilyStore cfs,
                                        List<IndexExpression> clause,
                                        IDiskAtomFilter filter,
                                        int maxResults,
                                        long timestamp,
                                        boolean countCQL3Rows,
                                        boolean isPaging)
    {
        if (clause == null || clause.isEmpty())
        {
            return new EmptyClauseFilter(cfs, filter, maxResults, timestamp, countCQL3Rows, isPaging);
        }
        else
        {
            if (isPaging)
                throw new IllegalArgumentException("Cross-row paging is not supported along with index clauses");
            return cfs.getComparator() instanceof CompositeType
                 ? new FilterWithCompositeClauses(cfs, clause, filter, maxResults, timestamp, countCQL3Rows)
                 : new FilterWithClauses(cfs, clause, filter, maxResults, timestamp, countCQL3Rows);
        }
    }

