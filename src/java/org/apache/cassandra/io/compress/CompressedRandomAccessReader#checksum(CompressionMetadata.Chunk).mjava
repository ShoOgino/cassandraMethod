    private int checksum(CompressionMetadata.Chunk chunk) throws IOException
    {
        assert channel.position() == chunk.offset + chunk.length;

        if (source.read(checksumBytes, 0, checksumBytes.length) != checksumBytes.length)
            throw new CorruptBlockException(getPath(), chunk);

        return Ints.fromByteArray(checksumBytes);
    }

