        private void runDeliverHints(EndPoint to)
        {
            logger_.debug("Started  hinted handoff for endPoint " + endPoint_.getHost());

            // 1. Scan through all the keys that we need to handoff
            // 2. For each key read the list of recepients if teh endpoint matches send
            // 3. Delete that recepient from the key if write was successful

            Table table =  Table.open(DatabaseDescriptor.getTables().get(0));
            ColumnFamily hintedColumnFamily = null;
            boolean success = false;
            try
            {
            	hintedColumnFamily = table.get(key_, Table.hints_);
            	if(hintedColumnFamily == null)
            		return;
            	Collection<IColumn> keys = hintedColumnFamily.getAllColumns();
            	if(keys != null)
            	{
                	for(IColumn key : keys)
                	{
                		// Get all the endpoints for teh key
                		Collection<IColumn> endpoints =  key.getSubColumns();
                		if ( endpoints != null )
                		{
                			for(IColumn endpoint : endpoints )
                			{
                				if(endpoint.name().equals(endPoint_.getHost()))
                				{
	                				success = sendMessage(endpoint.name(), key.name());
	                				if(success)
	                				{
	                					// Delete the endpoint from the list
	                					deleteEndPoint(endpoint.name(), key.name());
	                				}
                				}
                			}
                		}
                		if(endpoints == null)
                		{
                			// Delete the key itself.
                			deleteKey(key.name());
                		}
                	}
            	}
            }
            catch ( Exception ex)
            {
            	logger_.warn(ex.getMessage());
            }
            logger_.debug("Finished hinted handoff for endpoint ..." + endPoint_.getHost());
        }

