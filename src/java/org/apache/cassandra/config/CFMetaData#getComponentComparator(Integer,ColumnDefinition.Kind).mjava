    public AbstractType<?> getComponentComparator(Integer componentIndex, ColumnDefinition.Kind kind)
    {
        switch (kind)
        {
            case REGULAR:
                AbstractType<?> cfComparator = cfType == ColumnFamilyType.Super ? ((CompositeType)comparator).types.get(1) : comparator;
                if (cfComparator instanceof CompositeType)
                {
                    if (componentIndex == null)
                        return cfComparator;

                    List<AbstractType<?>> types = ((CompositeType)cfComparator).types;
                    AbstractType<?> t = types.get(componentIndex);
                    assert t != null : "Non-sensical component index";
                    return t;
                }
                else
                {
                    return cfComparator;
                }
            default:
                // CQL3 column names are UTF8
                return UTF8Type.instance;
        }
    }

