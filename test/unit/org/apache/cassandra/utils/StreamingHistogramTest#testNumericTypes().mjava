    @Test
    public void testNumericTypes() throws Exception
    {
        StreamingHistogram.StreamingHistogramBuilder hist = new StreamingHistogram.StreamingHistogramBuilder(5, 0, 1);

        hist.update(2);
        hist.update(2.0);
        hist.update(2L);

        Map<Number, long[]> asMap = hist.build().getAsMap();

        assertEquals(1, asMap.size());
        assertEquals(3L, asMap.get(2)[0]);

        //Make sure it's working with Serde
        DataOutputBuffer out = new DataOutputBuffer();
        StreamingHistogram.serializer.serialize(hist.build(), out);
        byte[] bytes = out.toByteArray();

        StreamingHistogram deserialized = StreamingHistogram.serializer.deserialize(new DataInputBuffer(bytes));

        StreamingHistogram.StreamingHistogramBuilder hist2Builder = new StreamingHistogram.StreamingHistogramBuilder(5, 0, 1);
        hist2Builder.merge(deserialized);
        hist2Builder.update(2L);

        asMap = hist2Builder.build().getAsMap();
        assertEquals(1, asMap.size());
        assertEquals(4L, asMap.get(2)[0]);
    }

