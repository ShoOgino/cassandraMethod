    public static void digest(RowIterator iterator, Hasher hasher)
    {
        // TODO: we're not computing digest the same way that old nodes. This is
        // currently ok as this is only used for schema digest and the is no exchange
        // of schema digest between different versions. If this changes however,
        // we'll need to agree on a version.
        HashingUtils.updateBytes(hasher, iterator.partitionKey().getKey().duplicate());
        iterator.columns().regulars.digest(hasher);
        iterator.columns().statics.digest(hasher);
        HashingUtils.updateWithBoolean(hasher, iterator.isReverseOrder());
        iterator.staticRow().digest(hasher);

        while (iterator.hasNext())
            iterator.next().digest(hasher);
    }

