        public SyncRequest deserialize(DataInputPlus in, int version) throws IOException
        {
            RepairJobDesc desc = RepairJobDesc.serializer.deserialize(in, version);
            InetAddressAndPort owner = CompactEndpointSerializationHelper.instance.deserialize(in, version);
            InetAddressAndPort src = CompactEndpointSerializationHelper.instance.deserialize(in, version);
            InetAddressAndPort dst = CompactEndpointSerializationHelper.instance.deserialize(in, version);
            int rangesCount = in.readInt();
            List<Range<Token>> ranges = new ArrayList<>(rangesCount);
            for (int i = 0; i < rangesCount; ++i)
                ranges.add((Range<Token>) AbstractBounds.tokenSerializer.deserialize(in, MessagingService.globalPartitioner(), version));
            PreviewKind previewKind = PreviewKind.deserialize(in.readInt());
            return new SyncRequest(desc, owner, src, dst, ranges, previewKind);
        }

