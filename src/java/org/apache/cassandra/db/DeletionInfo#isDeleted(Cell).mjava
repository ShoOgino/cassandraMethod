    /**
     * Return whether a given cell is deleted by the container having this deletion info.
     *
     * @param cell the cell to check.
     * @return true if the cell is deleted, false otherwise
     */
    public boolean isDeleted(Cell cell)
    {
        // We do rely on this test: if topLevel.markedForDeleteAt is MIN_VALUE, we should not
        // consider the column deleted even if timestamp=MIN_VALUE, otherwise this break QueryFilter.isRelevant
        if (isLive())
            return false;

        if (cell.timestamp() <= topLevel.markedForDeleteAt)
            return true;

        // No matter what the counter cell's timestamp is, a tombstone always takes precedence. See CASSANDRA-7346.
        if (!topLevel.isLive() && cell instanceof CounterCell)
            return true;

        return ranges != null && ranges.isDeleted(cell);
    }

