        public void onSuccess(Object result)
        {
            if (!options.isPreview())
            {
                SystemDistributedKeyspace.successfulParentRepair(parentSession, successfulRanges);
            }
            final String message;
            if (hasFailure.get())
            {
                StorageMetrics.repairExceptions.inc();
                message = "Some repair failed";
                fireProgressEvent(new ProgressEvent(ProgressEventType.ERROR, progress.get(), totalProgress,
                                                    message));
            }
            else
            {
                message = "Repair completed successfully";
                fireProgressEvent(new ProgressEvent(ProgressEventType.SUCCESS, progress.get(), totalProgress,
                                                    message));
            }
            String completionMessage = repairComplete();
            if (hasFailure.get())
            {
                recordFailure(message, completionMessage);
            }
            else
            {
                ActiveRepairService.instance.recordRepairStatus(cmd, ActiveRepairService.ParentRepairStatus.COMPLETED,
                                                       ImmutableList.of(message, completionMessage));
            }
        }

