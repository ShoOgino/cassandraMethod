        protected void addRangeForEndpoint(Range range, InetAddress endpoint)
        {
            Collection<Range> ranges = endpointToRanges.get(endpoint);
            if (ranges == null)
            {
                ranges = new HashSet<Range>();
                endpointToRanges.put(endpoint, ranges);
            }
            ranges.add(range);
        }

