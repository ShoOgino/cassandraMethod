    @Test
    public void addConnection_shouldUpdateSetToLatestTimestamp() throws UnknownHostException, InterruptedException
    {
        ProtocolVersionTracker pvt = new ProtocolVersionTracker();
        final InetAddress client = InetAddress.getByName("127.0.1.1");
        pvt.addConnection(client, ProtocolVersion.V4);

        for(InetAddress addr : getMockConnections(10))
        {
            pvt.addConnection(addr, ProtocolVersion.V4);
        }

        ImmutableSet<ClientIPAndTime> clientIPAndTimes1 = pvt.getAll().get(ProtocolVersion.V4);
        assertEquals(10, clientIPAndTimes1.size());

        Thread.sleep(10);

        pvt.addConnection(client, ProtocolVersion.V4);
        ImmutableSet<ClientIPAndTime> clientIPAndTimes2 = pvt.getAll().get(ProtocolVersion.V4);
        assertEquals(10, clientIPAndTimes2.size());

        long ls1 = clientIPAndTimes1.stream().filter(c -> c.inetAddress.equals(client)).findFirst().get().lastSeen;
        long ls2 = clientIPAndTimes2.stream().filter(c -> c.inetAddress.equals(client)).findFirst().get().lastSeen;

        assertTrue(ls2 > ls1);
    }

