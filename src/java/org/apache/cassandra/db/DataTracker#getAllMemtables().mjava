    /**
     * @return the active memtable and all the memtables that are pending flush.
     */
    public Iterable<Memtable> getAllMemtables()
    {
        View snapshot = view.get();
        return Iterables.concat(snapshot.memtablesPendingFlush, Collections.singleton(snapshot.memtable));
    }

