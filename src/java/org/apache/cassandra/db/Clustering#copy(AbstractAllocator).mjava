    public Clustering copy(AbstractAllocator allocator)
    {
        // Important for STATIC_CLUSTERING (but no point in being wasteful in general).
        if (size() == 0)
            return this;

        ByteBuffer[] newValues = new ByteBuffer[size()];
        for (int i = 0; i < size(); i++)
            newValues[i] = values[i] == null ? null : allocator.clone(values[i]);
        return new Clustering(newValues);
    }

