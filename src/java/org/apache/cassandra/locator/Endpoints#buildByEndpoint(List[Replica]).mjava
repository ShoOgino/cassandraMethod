    private static Map<InetAddressAndPort, Replica> buildByEndpoint(List<Replica> list)
    {
        // TODO: implement a delegating map that uses our superclass' list, and is immutable
        Map<InetAddressAndPort, Replica> byEndpoint = new LinkedHashMap<>(list.size());
        for (Replica replica : list)
        {
            Replica prev = byEndpoint.put(replica.endpoint(), replica);
            assert prev == null : "duplicate endpoint in EndpointsForRange: " + prev + " and " + replica;
        }

        return Collections.unmodifiableMap(byEndpoint);
    }

