    @VisibleForTesting
    public static void shutdownAndWait(long timeout, TimeUnit units) throws InterruptedException, TimeoutException
    {
        shutdown(StageManager.stages.values());
        awaitTermination(timeout, units, StageManager.stages.values());
    }

