    private static void resolveUserType(UserType type, Set<AbstractType> typeSet, List<AbstractType> types)
    {
        for (AbstractType subType: type.fieldTypes())
            if (!typeSet.contains(subType) && subType.isUDT())
                resolveUserType((UserType) subType, typeSet, types);

        if (!typeSet.contains(type))
        {
            typeSet.add(type);
            types.add(type);
        }
    }

