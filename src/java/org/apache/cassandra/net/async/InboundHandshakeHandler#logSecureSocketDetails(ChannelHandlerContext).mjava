    /**
     * If the connection is using SSL/TLS, log some details about it.
     */
    private void logSecureSocketDetails(ChannelHandlerContext ctx)
    {
        SslHandler sslHandler = ctx.pipeline().get(SslHandler.class);
        if (sslHandler != null)
        {
            SSLSession session = sslHandler.engine().getSession();
            logger.info("connection from peer {}, protocol = {}, cipher suite = {}",
                        ctx.channel().remoteAddress(), session.getProtocol(), session.getCipherSuite());
        }
    }

