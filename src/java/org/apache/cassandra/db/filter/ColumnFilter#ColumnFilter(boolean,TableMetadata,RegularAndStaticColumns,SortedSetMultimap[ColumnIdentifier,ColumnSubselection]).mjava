    private ColumnFilter(boolean fetchAllRegulars,
                         TableMetadata metadata,
                         RegularAndStaticColumns queried,
                         SortedSetMultimap<ColumnIdentifier, ColumnSubselection> subSelections)
    {
        assert !fetchAllRegulars || metadata != null;
        assert fetchAllRegulars || queried != null;
        this.fetchAllRegulars = fetchAllRegulars;

        if (fetchAllRegulars)
        {
            RegularAndStaticColumns all = metadata.regularAndStaticColumns();
            if (queried == null)
            {
                this.fetched = this.queried = all;
            }
            else
            {
                this.fetched = all.statics.isEmpty()
                               ? all
                               : new RegularAndStaticColumns(queried.statics, all.regulars);
                this.queried = queried;
            }
        }
        else
        {
            this.fetched = this.queried = queried;
        }

        this.subSelections = subSelections;
    }

