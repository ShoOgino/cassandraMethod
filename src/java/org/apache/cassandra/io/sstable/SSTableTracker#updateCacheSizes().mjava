    /**
     * Resizes the key and row caches based on the current key estimate.
     */
    public synchronized void updateCacheSizes()
    {
        long keys = estimatedKeys();
        cfs.keyCache.updateCacheSize(keys);
        cfs.rowCache.updateCacheSize(keys);
    }

