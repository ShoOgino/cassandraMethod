    public static RowMutation addKeyspace(KSMetaData ksm, long timestamp, boolean withSchemaRecord) throws ConfigurationException, IOException
    {
        RowMutation mutation = null;

        if (withSchemaRecord)
        {
            mutation = ksm.toSchema(timestamp);
            mutation.apply();
        }

        Schema.instance.load(ksm);

        if (!StorageService.instance.isClientMode())
            Table.open(ksm.name);

        return mutation;
    }

