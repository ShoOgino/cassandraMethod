    @Override
    public void response(Message message)
    {
        try
        {
            int b = -1;
            responses.add(message);
            // If DCQuorum/DCQuorumSync, check if the response is from the local DC.
            if (localdc.equals(snitch.getDatacenter(message.getFrom())))
            {
                b = localResponses.decrementAndGet();
            } else {
            	b = localResponses.get();
            }
            if (b == 0 && responseResolver.isDataPresent(responses))
            {
                condition.signal();
            }
        }
        catch (Exception ex)
        {
            throw new RuntimeException(ex);
        }
    }

