    public Event.SchemaChange announceMigration(QueryState queryState, boolean isLocalOnly) throws InvalidRequestException, ConfigurationException
    {
        TableMetadata current = lookupIndexedTable();
        if (current == null)
            return null;

        TableMetadata updated =
            current.unbuild()
                   .indexes(current.indexes.without(indexName))
                   .build();

        MigrationManager.announceTableUpdate(updated, isLocalOnly);
        // Dropping an index is akin to updating the CF
        // Note that we shouldn't call columnFamily() at this point because the index has been dropped and the call to lookupIndexedTable()
        // in that method would now throw.
        return new Event.SchemaChange(Event.SchemaChange.Change.UPDATED, Event.SchemaChange.Target.TABLE, current.keyspace, current.name);
    }

