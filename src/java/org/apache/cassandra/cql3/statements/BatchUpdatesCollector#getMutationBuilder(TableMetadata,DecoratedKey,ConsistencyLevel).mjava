    private IMutationBuilder getMutationBuilder(TableMetadata metadata, DecoratedKey dk, ConsistencyLevel consistency)
    {
        String ksName = metadata.keyspace;
        IMutationBuilder mutationBuilder = keyspaceMap(ksName).get(dk.getKey());
        if (mutationBuilder == null)
        {
            MutationBuilder builder = new MutationBuilder(ksName, dk);
            mutationBuilder = metadata.isCounter() ? new CounterMutationBuilder(builder, consistency) : builder;
            keyspaceMap(ksName).put(dk.getKey(), mutationBuilder);
        }
        return mutationBuilder;
    }

