    public void addAll(IMutation m)
    {
        if (!(m instanceof Mutation))
            throw new IllegalArgumentException();

        Mutation mutation = (Mutation)m;
        if (!keyspaceName.equals(mutation.keyspaceName) || !key.equals(mutation.key))
            throw new IllegalArgumentException();

        for (Map.Entry<UUID, ColumnFamily> entry : mutation.modifications.entrySet())
        {
            // It's slighty faster to assume the key wasn't present and fix if
            // not in the case where it wasn't there indeed.
            ColumnFamily cf = modifications.put(entry.getKey(), entry.getValue());
            if (cf != null)
                entry.getValue().addAll(cf);
        }
    }

