    private static Mutation makeLegacyCreateKeyspaceMutation(KeyspaceMetadata keyspace, long timestamp)
    {
        Mutation.SimpleBuilder builder = Mutation.simpleBuilder(SystemKeyspace.NAME, decorate(SystemKeyspace.LegacyKeyspaces, keyspace.name))
                                                 .timestamp(timestamp);

        builder.update(SystemKeyspace.LegacyKeyspaces)
               .row()
               .add("durable_writes", keyspace.params.durableWrites)
               .add("strategy_class", keyspace.params.replication.klass.getName())
               .add("strategy_options", json(keyspace.params.replication.options));

        keyspace.tables.forEach(table -> addTableToSchemaMutation(table, true, builder));
        keyspace.types.forEach(type -> addTypeToSchemaMutation(type, builder));
        keyspace.functions.udfs().forEach(udf -> addFunctionToSchemaMutation(udf, builder));
        keyspace.functions.udas().forEach(uda -> addAggregateToSchemaMutation(uda, builder));

        return builder.build();
    }

