    public void append(DecoratedKey decoratedKey, ByteBuffer value) throws IOException
    {
        long currentPosition = beforeAppend(decoratedKey);
        FBUtilities.writeShortByteArray(decoratedKey.key, dataFile);
        assert value.remaining() > 0;
        dataFile.writeLong(value.remaining());
        dataFile.write(value.array(),value.position()+value.arrayOffset(),value.remaining());
        afterAppend(decoratedKey, currentPosition);
    }

