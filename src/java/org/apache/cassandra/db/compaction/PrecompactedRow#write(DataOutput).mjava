    public long write(DataOutput out) throws IOException
    {
        assert compactedCf != null;
        DataOutputBuffer buffer = new DataOutputBuffer();
        ColumnFamily.serializer.serializeForSSTable(compactedCf, buffer);
        int dataSize = buffer.getLength();
        out.writeLong(buffer.getLength());
        out.write(buffer.getData(), 0, buffer.getLength());
        return dataSize;
    }

