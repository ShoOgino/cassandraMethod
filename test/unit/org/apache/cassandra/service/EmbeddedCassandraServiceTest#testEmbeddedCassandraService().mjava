    @Test
    public void testEmbeddedCassandraService() throws AuthenticationException, AuthorizationException,
    UnsupportedEncodingException, InvalidRequestException,
            UnavailableException, TimedOutException, TException, NotFoundException
    {
        Cassandra.Client client = getClient();
        client.set_keyspace("Keyspace1");

        ByteBuffer key_user_id = ByteBuffer.wrap("1".getBytes());
        
        long timestamp = System.currentTimeMillis();
        ColumnPath cp = new ColumnPath("Standard1");
        ColumnParent par = new ColumnParent("Standard1");
        cp.column = ByteBuffer.wrap("name".getBytes("utf-8"));

        // insert
        client.insert(key_user_id, par, new Column(ByteBuffer.wrap("name".getBytes("utf-8")),
                ByteBuffer.wrap( "Ran".getBytes("UTF-8")), timestamp), ConsistencyLevel.ONE);

        // read
        ColumnOrSuperColumn got = client.get(key_user_id, cp, ConsistencyLevel.ONE);

        // assert
        assertNotNull("Got a null ColumnOrSuperColumn", got);
        assertEquals("Ran", new String(got.getColumn().getValue(), "utf-8"));
    }

