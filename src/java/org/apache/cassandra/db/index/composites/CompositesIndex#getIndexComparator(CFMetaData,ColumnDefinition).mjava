    // Check SecondaryIndex.getIndexComparator if you want to know why this is static
    public static CompositeType getIndexComparator(CFMetaData baseMetadata, ColumnDefinition cfDef)
    {
        switch (cfDef.type)
        {
            case CLUSTERING_KEY:
                return CompositesIndexOnClusteringKey.buildIndexComparator(baseMetadata, cfDef);
            case REGULAR:
                return CompositesIndexOnRegular.buildIndexComparator(baseMetadata, cfDef);
            case PARTITION_KEY:
                return CompositesIndexOnPartitionKey.buildIndexComparator(baseMetadata, cfDef);
            //case COMPACT_VALUE:
            //    return CompositesIndexOnCompactValue.buildIndexComparator(baseMetadata, cfDef);
        }
        throw new AssertionError();
    }

