        public boolean equalsTo(WithVariables other) throws InvalidRequestException
        {
            if (!column().equals(other.column()))
                return false;

            if ((collectionElement() == null) != (other.collectionElement() == null))
                return false;

            if (collectionElement() != null)
            {
                assert column.type instanceof ListType || column.type instanceof MapType;
                AbstractType<?> comparator = column.type instanceof ListType
                                           ? Int32Type.instance
                                           : ((MapType)column.type).keys;

                if (comparator.compare(collectionElement().bindAndGet(variables), other.collectionElement().bindAndGet(variables)) != 0)
                    return false;
            }

            return value().bindAndGet(variables).equals(other.value().bindAndGet(other.variables));
        }

