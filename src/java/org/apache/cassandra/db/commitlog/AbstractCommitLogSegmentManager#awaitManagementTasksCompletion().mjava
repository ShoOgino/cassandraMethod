    // Used by tests only.
    void awaitManagementTasksCompletion()
    {
        while (segmentManagementTasks.size() > 0 || processingTask)
            Thread.yield();
    }

