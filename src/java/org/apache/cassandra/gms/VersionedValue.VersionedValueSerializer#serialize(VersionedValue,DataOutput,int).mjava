        public void serialize(VersionedValue value, DataOutput dos, int version) throws IOException
        {
            String outValue = value.value;

            if (version < MessagingService.VERSION_12)
            {
                String[] pieces = value.value.split(DELIMITER_STR, -1);
                String type = pieces[0];

                if ((type == STATUS_NORMAL) || type == STATUS_BOOTSTRAPPING)
                {
                    assert pieces.length >= 3;
                    outValue = versionString(pieces[0], pieces[2]);
                }

                if ((type == REMOVAL_COORDINATOR) || (type == REMOVING_TOKEN) || (type == REMOVED_TOKEN))
                    throw new RuntimeException(String.format("Unable to serialize %s(%s...) for nodes older than 1.2",
                                                             VersionedValue.class.getName(),
                                                             type));
            }

            dos.writeUTF(outValue);
            dos.writeInt(value.version);
        }

