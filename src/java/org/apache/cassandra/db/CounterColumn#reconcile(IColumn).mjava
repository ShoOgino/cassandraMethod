    @Override
    public IColumn reconcile(IColumn column)
    {
        assert (column instanceof CounterColumn) || (column instanceof DeletedColumn) : "Wrong class type.";

        if (isMarkedForDelete())
        {
            if (column.isMarkedForDelete()) // tombstone + tombstone: keep later tombstone
            {
                return timestamp() > column.timestamp() ? this : column;
            }
            else // tombstone + live: track last tombstone
            {
                if (timestamp() > column.timestamp()) // tombstone > live
                {
                    return this;
                }
                // tombstone <= live last delete
                if (timestamp() <= ((CounterColumn)column).timestampOfLastDelete())
                {
                    return column;
                }
                // tombstone > live last delete
                return new CounterColumn(column.name(), column.value(), column.timestamp(), timestamp());
            }
        }
        else if (column.isMarkedForDelete()) // live + tombstone: track last tombstone
        {
            if (timestamp() < column.timestamp()) // live < tombstone
            {
                return column;
            }
            // live last delete >= tombstone
            if (timestampOfLastDelete() >= column.timestamp())
            {
                return this;
            }
            // live last delete < tombstone
            return new CounterColumn(name(), value(), timestamp(), column.timestamp());
        }
        // live + live: merge clocks; update value
        return new CounterColumn(
            name(),
            contextManager.merge(value(), column.value()),
            Math.max(timestamp(), column.timestamp()),
            Math.max(timestampOfLastDelete(), ((CounterColumn)column).timestampOfLastDelete()));
    }

