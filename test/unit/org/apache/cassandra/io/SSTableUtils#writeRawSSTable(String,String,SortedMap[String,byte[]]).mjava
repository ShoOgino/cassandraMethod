    public static SSTableReader writeRawSSTable(String tablename, String cfname, SortedMap<String, byte[]> entries) throws IOException
    {
        File f = tempSSTableFile(tablename, cfname);
        SSTableWriter writer = new SSTableWriter(f.getAbsolutePath(), entries.size(), StorageService.getPartitioner());
        for (Map.Entry<String, byte[]> entry : entries.entrySet())
            writer.append(writer.partitioner.decorateKey(entry.getKey()),
                          entry.getValue());
        new File(writer.indexFilename()).deleteOnExit();
        new File(writer.filterFilename()).deleteOnExit();
        return writer.closeAndOpenReader();
    }

