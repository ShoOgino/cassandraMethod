    /**
     * Return whether a given cell is deleted by this deletion info.
     *
     * @param clustering the clustering for the cell to check.
     * @param cell the cell to check.
     * @return true if the cell is deleted, false otherwise
     */
    private boolean isDeleted(Clustering clustering, Cell cell)
    {
        // If we're live, don't consider anything deleted, even if the cell ends up having as timestamp Long.MIN_VALUE
        // (which shouldn't happen in practice, but it would invalid to consider it deleted if it does).
        if (isLive())
            return false;

        if (cell.livenessInfo().timestamp() <= partitionDeletion.markedForDeleteAt())
            return true;

        // No matter what the counter cell's timestamp is, a tombstone always takes precedence. See CASSANDRA-7346.
        if (!partitionDeletion.isLive() && cell.isCounterCell())
            return true;

        return ranges != null && ranges.isDeleted(clustering, cell);
    }

