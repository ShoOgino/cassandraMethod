    private void verifyMany(SSTableReader sstable, Map<byte[], byte[]> map) throws IOException
    {
        List<byte[]> keys = new ArrayList<byte[]>(map.keySet());
        Collections.shuffle(keys);
        BufferedRandomAccessFile file = new BufferedRandomAccessFile(sstable.getFilename(), "r");
        for (byte[] key : keys)
        {
            file.seek(sstable.getPosition(sstable.partitioner.decorateKey(key)).position);
            assert Arrays.equals(key, FBUtilities.readShortByteArray(file));
            int size = file.readInt();
            byte[] bytes2 = new byte[size];
            file.readFully(bytes2);
            assert Arrays.equals(bytes2, map.get(key));
        }
    }

