    /**
     * Called when the keyspace or user have changed.
     */
    private void updateKeyspaceAccess()
    {
        if (user.get() == null || keyspace.get() == null)
            // user is not logged in or keyspace is not set
            keyspaceAccess.set(null);
        else
            // authorize the user for the current keyspace
            keyspaceAccess.set(DatabaseDescriptor.getAuthority().authorize(user.get(), keyspace.get()));
    }

