    // TODO imitate backwards-compatibility code from OutboundTcpConnection here
    public void serialize(MessageIn t, DataOutput dos, int version) throws IOException
    {
        Header.serializer().serialize(t.header, dos, version);
        byte[] bytes = t.getMessageBody();
        dos.writeInt(bytes.length);
        dos.write(bytes);
    }

