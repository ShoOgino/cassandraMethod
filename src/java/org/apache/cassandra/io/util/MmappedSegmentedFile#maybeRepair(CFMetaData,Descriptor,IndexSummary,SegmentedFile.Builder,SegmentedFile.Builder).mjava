    // see CASSANDRA-10357
    public static boolean maybeRepair(CFMetaData metadata, Descriptor descriptor, IndexSummary indexSummary, SegmentedFile.Builder ibuilder, SegmentedFile.Builder dbuilder)
    {
        boolean mayNeedRepair = false;
        if (ibuilder instanceof Builder)
            mayNeedRepair = ((Builder) ibuilder).mayNeedRepair(descriptor.filenameFor(Component.PRIMARY_INDEX));
        if (dbuilder instanceof Builder)
            mayNeedRepair |= ((Builder) dbuilder).mayNeedRepair(descriptor.filenameFor(Component.DATA));

        if (mayNeedRepair)
            forceRepair(metadata, descriptor, indexSummary, ibuilder, dbuilder);
        return mayNeedRepair;
    }

