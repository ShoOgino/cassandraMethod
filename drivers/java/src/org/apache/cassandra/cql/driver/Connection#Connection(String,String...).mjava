    public Connection(String keyspaceName, String...hosts) throws InvalidRequestException, TException
    {
        assert hosts.length > 0;
        
        for (String hostSpec : hosts)
        {
            String[] parts = hostSpec.split(":", 2);
            this.hostName = parts[0];
            this.port = Integer.parseInt(parts[1]);
            
            // TODO: This will need to do connection pooling.
            break;
        }
        
        TSocket socket = new TSocket(hostName, port);
        transport = new TFramedTransport(socket);
        TProtocol protocol = new TBinaryProtocol(transport);
        client = new Cassandra.Client(protocol);
        socket.open();
        
        client.set_keyspace(keyspaceName);
    }

