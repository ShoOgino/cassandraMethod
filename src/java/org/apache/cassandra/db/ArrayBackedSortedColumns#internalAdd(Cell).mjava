    /**
     * Add a cell to the array, 'resizing' it first if necessary (if it doesn't fit).
     */
    private void internalAdd(Cell cell)
    {
        if (cells == EMPTY_ARRAY)
            cells = new Cell[MINIMAL_CAPACITY];
        else if (cells.length == size)
            cells = Arrays.copyOf(cells, size * 3 / 2 + 1);

        cells[size++] = cell;
    }

