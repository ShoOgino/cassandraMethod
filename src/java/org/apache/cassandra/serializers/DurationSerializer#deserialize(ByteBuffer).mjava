    public Duration deserialize(ByteBuffer bytes)
    {
        if (bytes.remaining() == 0)
            return null;

        try (DataInputBuffer in = new DataInputBuffer(bytes, true))
        {
            int months = (int) in.readVInt();
            int days = (int) in.readVInt();
            long nanoseconds = in.readVInt();
            return Duration.newInstance(months, days, nanoseconds);
        }
        catch (IOException e)
        {
            // this should never happen with a DataInputBuffer
            throw new AssertionError("Unexpected error", e);
        }
    }

