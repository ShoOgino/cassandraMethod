    BiConsumer<InetAddressAndPort, Message> filter(BiConsumer<InetAddressAndPort, Message> applyIfNotFiltered)
    {
        return (toAddress, message) ->
        {
            int from = cluster.get(message.from).config.num;
            int to = cluster.get(toAddress).config.num;
            int verb = message.verb;
            for (Filter filter : filters)
            {
                if (filter.matches(from, to, verb))
                    return;
            }

            applyIfNotFiltered.accept(toAddress, message);
        };
    }

