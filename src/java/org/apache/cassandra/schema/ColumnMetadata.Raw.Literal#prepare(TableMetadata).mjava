            public ColumnMetadata prepare(TableMetadata table)
            {
                if (!table.isStaticCompactTable())
                    return find(table);

                AbstractType<?> columnNameType = table.staticCompactOrSuperTableColumnNameType();
                if (columnNameType instanceof UTF8Type)
                    return find(table);

                // We have a legacy-created table with a non-text comparator. Check if we have a match column, otherwise assume we should use
                // columnNameType
                ByteBuffer bufferName = ByteBufferUtil.bytes(text);
                for (ColumnMetadata def : table.columns())
                {
                    if (def.name.bytes.equals(bufferName))
                        return def;
                }
                return find(columnNameType.fromString(text), table);
            }

