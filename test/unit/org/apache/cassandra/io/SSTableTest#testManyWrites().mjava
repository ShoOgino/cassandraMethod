    @Test
    public void testManyWrites() throws IOException {
        File f = File.createTempFile("sstable", "-" + SSTable.temporaryFile_);

        TreeMap<String, byte[]> map = new TreeMap<String,byte[]>();
        for ( int i = 100; i < 1000; ++i )
        {
            map.put(Integer.toString(i), ("Avinash Lakshman is a good man: " + i).getBytes());
        }

        // write
        SSTable ssTable = new SSTable(f.getParent(), f.getName(), 1000, new OrderPreservingPartitioner());
        for (String key: map.navigableKeySet())
        {
            ssTable.append(key, map.get(key));
        }
        ssTable.close();

        // verify
        verifyMany(ssTable.dataFile_, map);
        SSTable.reopenUnsafe(); // force reloading the index
        verifyMany(ssTable.dataFile_, map);
    }

