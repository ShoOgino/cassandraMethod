    private <T extends Iterable<U>, U> int findMaxAddressLength(Map<String, T> dcs, ToIntFunction<U> computeLength)
    {
        int maxAddressLength = 0;

        Set<U> seenHosts = new HashSet<>();
        for (T stats : dcs.values())
            for (U stat : stats)
                if (seenHosts.add(stat))
                    maxAddressLength = Math.max(maxAddressLength, computeLength.applyAsInt(stat));

        return maxAddressLength;
    }

