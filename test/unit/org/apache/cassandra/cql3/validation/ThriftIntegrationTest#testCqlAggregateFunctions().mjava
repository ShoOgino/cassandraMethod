    @Test
    public void testCqlAggregateFunctions() throws Throwable
    {
        populateDenseTable();
        populateSparseTable();

        assertRows(execute(String.format("select count(*) from %s.%s", KEYSPACE, currentDenseTable())),
                   row(8L));
        assertRows(execute(String.format("select count(*) from %s.%s", KEYSPACE, currentSparseTable())),
                   row(4L));

        assertRows(execute(String.format("select count(*) from %s.%s where key = ? AND column1 = ?", KEYSPACE, currentDenseTable()), "key1", "val1"),
                   row(2L));
        assertRows(execute(String.format("select count(*) from %s.%s where key = ? AND column1 = ?", KEYSPACE, currentSparseTable()), "key1", "val1"),
                   row(1L));
        assertRows(execute(String.format("select count(*) from %s.%s where key = ?", KEYSPACE, currentSparseTable()), "key1"),
                   row(2L));

        assertRows(execute(String.format("select max(value) from %s.%s", KEYSPACE, currentDenseTable())),
                   row("value5"));
        assertRows(execute(String.format("select max(col1) from %s.%s", KEYSPACE, currentSparseTable())),
                   row(3L));

        assertRows(execute(String.format("select avg(column2) from %s.%s", KEYSPACE, currentDenseTable())),
                   row(3));
        assertRows(execute(String.format("select avg(col1) from %s.%s", KEYSPACE, currentSparseTable())),
                   row(3L));
    }

