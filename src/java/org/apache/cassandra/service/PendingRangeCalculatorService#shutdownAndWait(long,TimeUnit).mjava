    @VisibleForTesting
    public void shutdownAndWait(long timeout, TimeUnit units) throws InterruptedException, TimeoutException
    {
        executor.shutdown();
        ExecutorUtils.awaitTermination(timeout, units, executor);
    }

