    public FileDataInput getFileDataInput(int bufferSize)
    {
        try
        {
            return buffer == null ? new BufferedRandomAccessFile(path, "r", bufferSize) : new MappedFileDataInput(buffer, path);
        }
        catch (FileNotFoundException e)
        {
            throw new AssertionError(e);
        }
    }

