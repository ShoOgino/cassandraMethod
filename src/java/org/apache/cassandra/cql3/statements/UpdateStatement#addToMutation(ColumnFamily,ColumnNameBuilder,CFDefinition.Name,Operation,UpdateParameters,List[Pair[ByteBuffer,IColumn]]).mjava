    private boolean addToMutation(ColumnFamily cf,
                                  ColumnNameBuilder builder,
                                  CFDefinition.Name valueDef,
                                  Operation valueOperation,
                                  UpdateParameters params,
                                  List<Pair<ByteBuffer, IColumn>> list) throws InvalidRequestException
    {
        Operation.Type type = valueOperation.getType();

        if (type == Operation.Type.COLUMN || type == Operation.Type.COUNTER)
        {
            if (valueDef != null && valueDef.type.isCollection())
                throw new InvalidRequestException("Can't apply operation on column with " + valueDef.type + " type.");

            AbstractType<?> validator = valueDef == null ? null : valueDef.type;
            valueOperation.execute(cf, builder.copy(), validator, params);
        }
        else
        {
            if (!valueDef.type.isCollection())
                throw new InvalidRequestException("Can't apply collection operation on column with " + valueDef.type + " type.");

            valueOperation.execute(cf, builder.copy(), (CollectionType) valueDef.type, params, list);
        }

        return valueOperation.getType() == Operation.Type.COUNTER;
    }

