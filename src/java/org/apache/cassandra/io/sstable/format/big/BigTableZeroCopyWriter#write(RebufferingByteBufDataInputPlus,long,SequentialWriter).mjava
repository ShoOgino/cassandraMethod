    private void write(RebufferingByteBufDataInputPlus in, long size, SequentialWriter writer)
    {
        logger.info("Block Writing component to {} length {}", writer.getPath(), prettyPrintMemory(size));

        try
        {
            long bytesWritten = in.consumeUntil(writer, size);

            if (bytesWritten != size)
                throw new IOException(format("Failed to read correct number of bytes from channel %s", writer));
        }
        catch (IOException e)
        {
            throw new FSWriteError(e, writer.getPath());
        }
    }

