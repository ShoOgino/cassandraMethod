    private SSTableWriter createCompactionWriter(File sstableDirectory, long keysPerSSTable)
    {
        assert sstableDirectory != null;
        return new SSTableWriter(cfs.getTempSSTablePath(sstableDirectory),
                                 keysPerSSTable,
                                 cfs.metadata,
                                 cfs.partitioner,
                                 SSTableMetadata.createCollector(toCompact, cfs.metadata.comparator, getLevel()));
    }

