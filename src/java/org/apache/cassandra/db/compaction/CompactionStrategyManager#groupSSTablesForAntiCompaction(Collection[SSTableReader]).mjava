    public Collection<Collection<SSTableReader>> groupSSTablesForAntiCompaction(Collection<SSTableReader> sstablesToGroup)
    {
        Map<Integer, List<SSTableReader>> groups = sstablesToGroup.stream().collect(Collectors.groupingBy((s) -> getCompactionStrategyIndex(cfs, getDirectories(), s)));
        Collection<Collection<SSTableReader>> anticompactionGroups = new ArrayList<>();

        for (Map.Entry<Integer, List<SSTableReader>> group : groups.entrySet())
            anticompactionGroups.addAll(unrepaired.get(group.getKey()).groupSSTablesForAntiCompaction(group.getValue()));
        return anticompactionGroups;
    }

