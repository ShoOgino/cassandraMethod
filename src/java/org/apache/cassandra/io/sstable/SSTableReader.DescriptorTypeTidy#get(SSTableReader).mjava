        // get a new reference to the shared DescriptorTypeTidy for this sstable
        public static Ref<DescriptorTypeTidy> get(SSTableReader sstable)
        {
            Descriptor desc = sstable.descriptor;
            if (sstable.openReason == OpenReason.EARLY)
                desc = desc.asType(Descriptor.Type.TEMPLINK);
            Ref<DescriptorTypeTidy> refc = lookup.get(desc);
            if (refc != null)
                return refc.ref();
            final DescriptorTypeTidy tidy = new DescriptorTypeTidy(desc, sstable);
            refc = new Ref<>(tidy, tidy);
            Ref<?> ex = lookup.putIfAbsent(desc, refc);
            assert ex == null;
            return refc;
        }

