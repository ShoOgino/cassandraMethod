    @Test
    public void testFixedCoalescingStrategyEnough() throws Exception
    {
        int oldValue = DatabaseDescriptor.getOtcCoalescingEnoughCoalescedMessages();
        DatabaseDescriptor.setOtcCoalescingEnoughCoalescedMessages(1);
        try {
            cs = newStrategy("FIXED", 200);

            //Test that when a stream of messages continues arriving it keeps sending until all are drained
            //It does this because it is already awake and sending messages
            add(42);
            add(42);
            cs.coalesce(input, output, 128);
            assertEquals(2, output.size());
            assertNull(parker.parks.poll());

            clear();

            runBlocker(queueParked);
            add(42);
            add(42);
            add(42);
            release();
            assertEquals(3, output.size());
            assertNull(parker.parks.poll());
        }
        finally {
            DatabaseDescriptor.setOtcCoalescingEnoughCoalescedMessages(oldValue);
        }

    }

