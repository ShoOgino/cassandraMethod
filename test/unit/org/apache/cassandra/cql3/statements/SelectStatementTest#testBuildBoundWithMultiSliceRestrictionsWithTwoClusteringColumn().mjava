    /**
     * Test multi-column slice restrictions (e.g '(clustering_0, clustering_1) > (1, 2)') with only one clustering
     * column
     */
    @Test
    public void testBuildBoundWithMultiSliceRestrictionsWithTwoClusteringColumn() throws InvalidRequestException
    {
        ByteBuffer value1 = ByteBufferUtil.bytes(1);
        ByteBuffer value2 = ByteBufferUtil.bytes(2);

        // (clustering_0, clustering1) > (1, 2)
        MultiColumnRestriction.Slice slice = new MultiColumnRestriction.Slice(false);
        slice.setBound(Operator.GT, toMultiItemTerminal(value1, value2));
        Restriction[] restrictions = new Restriction[] { slice, slice };

        List<Composite> bounds = executeBuildBound(restrictions, Bound.START);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value1, value2, EOC.END);

        bounds = executeBuildBound(restrictions, Bound.END);
        assertEquals(1, bounds.size());
        assertEmptyComposite(bounds.get(0));

        // (clustering_0, clustering1) >= (1, 2)
        slice = new MultiColumnRestriction.Slice(false);
        slice.setBound(Operator.GTE, toMultiItemTerminal(value1, value2));
        restrictions = new Restriction[] { slice, slice };

        bounds = executeBuildBound(restrictions, Bound.START);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value1, value2, EOC.NONE);

        bounds = executeBuildBound(restrictions, Bound.END);
        assertEquals(1, bounds.size());
        assertEmptyComposite(bounds.get(0));

        // (clustering_0, clustering1) <= (1, 2)
        slice = new MultiColumnRestriction.Slice(false);
        slice.setBound(Operator.LTE, toMultiItemTerminal(value1, value2));
        restrictions = new Restriction[] { slice, slice };

        bounds = executeBuildBound(restrictions, Bound.START);
        assertEquals(1, bounds.size());
        assertEmptyComposite(bounds.get(0));

        bounds = executeBuildBound(restrictions, Bound.END);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value1, value2, EOC.END);

        // (clustering_0, clustering1) < (1, 2)
        slice = new MultiColumnRestriction.Slice(false);
        slice.setBound(Operator.LT, toMultiItemTerminal(value1, value2));
        restrictions = new Restriction[] { slice, slice };

        bounds = executeBuildBound(restrictions, Bound.START);
        assertEquals(1, bounds.size());
        assertEmptyComposite(bounds.get(0));

        bounds = executeBuildBound(restrictions, Bound.END);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value1, value2, EOC.START);

        // (clustering_0, clustering1) > (1, 2) AND (clustering_0) < (2)
        slice = new MultiColumnRestriction.Slice(false);
        slice.setBound(Operator.GT, toMultiItemTerminal(value1, value2));
        slice.setBound(Operator.LT, toMultiItemTerminal(value2));
        restrictions = new Restriction[] { slice, slice };

        bounds = executeBuildBound(restrictions, Bound.START);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value1, value2, EOC.END);

        bounds = executeBuildBound(restrictions, Bound.END);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value2, EOC.START);

        // (clustering_0, clustering1) >= (1, 2) AND (clustering_0, clustering1) <= (2, 1)
        slice = new MultiColumnRestriction.Slice(false);
        slice.setBound(Operator.GTE, toMultiItemTerminal(value1, value2));
        slice.setBound(Operator.LTE, toMultiItemTerminal(value2, value1));
        restrictions = new Restriction[] { slice, slice };

        bounds = executeBuildBound(restrictions, Bound.START);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value1, value2, EOC.NONE);

        bounds = executeBuildBound(restrictions, Bound.END);
        assertEquals(1, bounds.size());
        assertComposite(bounds.get(0), value2, value1, EOC.END);
    }

