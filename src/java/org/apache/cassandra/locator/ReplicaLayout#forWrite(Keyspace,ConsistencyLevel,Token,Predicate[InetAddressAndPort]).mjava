    public static ForToken forWrite(Keyspace keyspace, ConsistencyLevel consistencyLevel, Token token, Predicate<InetAddressAndPort> isAlive) throws UnavailableException
    {
        EndpointsForToken natural = StorageService.getNaturalReplicasForToken(keyspace.getName(), token);
        EndpointsForToken pending = StorageService.instance.getTokenMetadata().pendingEndpointsForToken(token, keyspace.getName());
        return forWrite(keyspace, consistencyLevel, token, natural, pending, isAlive);
    }

