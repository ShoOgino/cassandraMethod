    public static void spinAssertEquals(Object expected, Supplier<Object> s, int timeoutInSeconds)
    {
        long start = System.currentTimeMillis();
        Object lastValue = null;
        while (System.currentTimeMillis() < start + (1000 * timeoutInSeconds))
        {
            lastValue = s.get();
            if (lastValue.equals(expected))
                break;
            Thread.yield();
        }
        assertEquals(expected, lastValue);
    }

