    public void checkAccess(ClientState state) throws UnauthorizedException, InvalidRequestException
    {
        if (Functions.find(functionName, argTypes) != null && orReplace)
            state.ensureHasPermission(Permission.ALTER, FunctionResource.function(functionName.keyspace,
                                                                                  functionName.name,
                                                                                  argTypes));
        else
            state.ensureHasPermission(Permission.CREATE, FunctionResource.keyspace(functionName.keyspace));
    }

