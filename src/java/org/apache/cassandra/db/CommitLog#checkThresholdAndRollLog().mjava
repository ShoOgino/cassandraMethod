    private void checkThresholdAndRollLog()
    {
        try
        {
            if (logWriter_.getFileSize() >= SEGMENT_SIZE)
            {
                /* Rolls the current log file over to a new one. */
                setNextFileName();
                String oldLogFile = logWriter_.getFileName();
                //history_.add(oldLogFile);
                logWriter_.close();

                /* point reader/writer to a new commit log file. */
                // logWriter_ = SequenceFile.writer(logFile_);
                logWriter_ = CommitLog.createWriter(logFile_);
                /* squirrel away the old commit log header */
                clHeaders_.put(oldLogFile, new CommitLogHeader(clHeader_));
                /*
                 * We need to zero out positions because the positions in
                 * the old file do not make sense in the new one.
                */
                clHeader_.zeroPositions();
                writeCommitLogHeader(clHeader_.toByteArray(), false);
                // Get the list of files in commit log directory if it is greater than a certain number
                // Force flush all the column families that way we ensure that a slowly populated column family is not screwing up
                // by accumulating the commit logs .
            }
        }
        catch (IOException e)
        {
            logger_.info(LogUtil.throwableToString(e));
        }
    }

