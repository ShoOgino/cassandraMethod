    @Override
    public String toString()
    {
        StringBuilder sb = new StringBuilder();
        CFMetaData metadata = metadata();
        sb.append(String.format("Partition[%s.%s] key=%s columns=%s%s",
                                 metadata().ksName,
                                 metadata().cfName,
                                 metadata().getKeyValidator().getString(partitionKey().getKey()),
                                 columns(),
                                 deletionInfo().isLive() ? "" : " " + deletionInfo()));

        if (staticRow() != Rows.EMPTY_STATIC_ROW)
            sb.append("\n    ").append(staticRow().toString(metadata, true));

        // We use createRowIterator() directly instead of iterator() because that avoids
        // sorting for PartitionUpdate (which inherit this method) and that is useful because
        //  1) it can help with debugging and 2) we can't write after sorting but we want to
        // be able to print an update while we build it (again for debugging)
        for (Row row : this)
            sb.append("\n    ").append(row.toString(metadata, true));

        return sb.toString();
    }

