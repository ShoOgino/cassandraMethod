    @Test
    public void testBulkLoader_WithArgs() throws Exception
    {
        try
        {
            runner.invokeClassAsTool("org.apache.cassandra.tools.BulkLoader", "-d", "127.9.9.1", OfflineToolUtils.sstableDirName("legacy_sstables", "legacy_ma_simple"))
                   .waitAndAssertOnCleanExit();
            fail();
        }
        catch (RuntimeException e)
        {
            if (!(e.getCause() instanceof BulkLoadException))
                throw e;
            if (!(e.getCause().getCause() instanceof NoHostAvailableException))
                throw e;
        }
        assertNoUnexpectedThreadsStarted(null, new String[]{"globalEventExecutor-1-1", "globalEventExecutor-1-2"});
        assertSchemaNotLoaded();
        assertCLSMNotLoaded();
        assertSystemKSNotLoaded();
        assertKeyspaceNotLoaded();
        assertServerNotLoaded();
    }

