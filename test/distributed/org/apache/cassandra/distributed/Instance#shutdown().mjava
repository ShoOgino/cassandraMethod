    void shutdown()
    {
        runOnInstance(() -> {
            Throwable error = null;
            error = runAndMergeThrowable(error,
                    CompactionManager.instance::forceShutdown,
                    BatchlogManager.instance::shutdown,
                    HintsService.instance::shutdownBlocking,
                    CommitLog.instance::shutdownBlocking,
                    Gossiper.instance::stop,
                    SecondaryIndexManager::shutdownExecutors,
                    MessagingService.instance()::shutdown,
                    ColumnFamilyStore::shutdownFlushExecutor,
                    ColumnFamilyStore::shutdownPostFlushExecutor,
                    ColumnFamilyStore::shutdownReclaimExecutor,
                    ColumnFamilyStore::shutdownPerDiskFlushExecutors,
                    PendingRangeCalculatorService.instance::shutdownExecutor,
                    BufferPool::shutdownLocalCleaner,
                    Ref::shutdownReferenceReaper,
                    StageManager::shutdownAndWait,
                    SharedExecutorPool.SHARED::shutdown,
                    Memtable.MEMORY_POOL::shutdown,
                    ScheduledExecutors::shutdownAndWait,
                    SSTableReader::shutdownBlocking);

            error = shutdownAndWait(error, ActiveRepairService.repairCommandExecutor);
            LoggerContext loggerContext = (LoggerContext) LoggerFactory.getILoggerFactory();
            loggerContext.stop();
            Throwables.maybeFail(error);
        });
    }

