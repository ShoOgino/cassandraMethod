    @VisibleForTesting
    public static void shutdownAndWait() throws InterruptedException
    {
        ExecutorService[] executors = new ExecutorService[] { scheduledTasks, nonPeriodicTasks, optionalTasks };
        for (ExecutorService executor : executors)
            executor.shutdown();
        for (ExecutorService executor : executors)
            executor.awaitTermination(60, TimeUnit.SECONDS);
    }

