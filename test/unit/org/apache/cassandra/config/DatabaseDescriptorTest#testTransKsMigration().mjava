    // this came as a result of CASSANDRA-995
    @Test
    public void testTransKsMigration() throws IOException, ConfigurationException
    {
        SchemaLoader.cleanupAndLeaveDirs();
        DatabaseDescriptor.loadSchemas();
        assert Schema.instance.getNonSystemTables().size() == 0;

        Gossiper.instance.start((int)(System.currentTimeMillis() / 1000));

        try
        {
            // add a few.
            MigrationManager.announceNewKeyspace(KSMetaData.testMetadata("ks0", SimpleStrategy.class, KSMetaData.optsWithRF(3)));
            MigrationManager.announceNewKeyspace(KSMetaData.testMetadata("ks1", SimpleStrategy.class, KSMetaData.optsWithRF(3)));

            assert Schema.instance.getKSMetaData("ks0") != null;
            assert Schema.instance.getKSMetaData("ks1") != null;

            Schema.instance.clearTableDefinition(Schema.instance.getKSMetaData("ks0"));
            Schema.instance.clearTableDefinition(Schema.instance.getKSMetaData("ks1"));

            assert Schema.instance.getKSMetaData("ks0") == null;
            assert Schema.instance.getKSMetaData("ks1") == null;

            DatabaseDescriptor.loadSchemas();

            assert Schema.instance.getKSMetaData("ks0") != null;
            assert Schema.instance.getKSMetaData("ks1") != null;
        }
        finally
        {
            Gossiper.instance.stop();
        }
    }

