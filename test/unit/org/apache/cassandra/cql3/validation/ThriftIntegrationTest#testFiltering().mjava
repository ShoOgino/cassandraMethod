    @Test
    public void testFiltering() throws Throwable
    {
        assertInvalidMessage("Predicates on non-primary-key columns (value) are not yet supported for non secondary index queries",
                             String.format("select * from %s.%s WHERE value = ?", KEYSPACE, currentDenseTable()),
                             "value5");
        assertInvalidMessage("Predicates on non-primary-key columns (value) are not yet supported for non secondary index queries",
                             String.format("select * from %s.%s WHERE value = ? ALLOW FILTERING", KEYSPACE, currentDenseTable()),
                             "value5");
        assertInvalidMessage("Predicates on non-primary-key columns (value) are not yet supported for non secondary index queries",
                             String.format("SELECT * FROM %s.%s WHERE value = 'value2' ALLOW FILTERING", KEYSPACE, currentDenseTable()));
        assertInvalidMessage("PRIMARY KEY column \"column2\" cannot be restricted as preceding column \"column1\" is not restricted",
                             String.format("SELECT * FROM %s.%s WHERE column2 = 1 ALLOW FILTERING", KEYSPACE, currentDenseTable()));
    }

