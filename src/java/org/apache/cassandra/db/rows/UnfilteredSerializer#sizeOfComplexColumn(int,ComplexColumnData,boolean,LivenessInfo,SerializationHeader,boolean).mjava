    private long sizeOfComplexColumn(int idx, ComplexColumnData data, boolean hasComplexDeletion, LivenessInfo rowLiveness, SerializationHeader header, boolean useSparse)
    {
        long size = 0;
        if (useSparse)
        {
            if (data == null)
                return size;

            size += TypeSizes.sizeofVInt(idx);
        }

        if (hasComplexDeletion)
            size += header.deletionTimeSerializedSize(data == null ? DeletionTime.LIVE : data.complexDeletion());

        if (data != null)
        {
            for (Cell cell : data)
                size += Cell.serializer.serializedSize(cell, rowLiveness, header);
        }

        return size + Cell.serializer.serializedSize(null, rowLiveness, header);
    }

