        public ByteBuffer allocateBuffer()
        {
            int compressedLength = Math.min(maxCompressedLength,
                                            metadata.compressor().initialCompressedBufferLength(metadata.chunkLength()));

            int checksumLength = Integer.BYTES;

            return allocateBuffer(compressedLength + checksumLength);
        }

