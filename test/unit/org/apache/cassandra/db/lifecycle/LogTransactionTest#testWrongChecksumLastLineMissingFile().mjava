    @Test
    public void testWrongChecksumLastLineMissingFile() throws IOException
    {
        testCorruptRecord((t, s) ->
                          { // Fake a commit with invalid checksum and also delete one of the old files
                              for (String filePath : s.getAllFilePaths())
                              {
                                  if (filePath.endsWith("Data.db"))
                                  {
                                      assertTrue(FileUtils.delete(filePath));
                                      t.getLogFile().sync();
                                      break;
                                  }
                              }

                              FileUtils.append(t.getLogFile().file,
                                               String.format("commit:[%d,0,0][%d]",
                                                             System.currentTimeMillis(),
                                                             12345678L));
                          },
                          false);
    }

