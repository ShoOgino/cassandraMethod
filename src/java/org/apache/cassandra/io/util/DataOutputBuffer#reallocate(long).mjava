    protected void reallocate(long newSize)
    {
        assert newSize <= Integer.MAX_VALUE;
        ByteBuffer newBuffer = ByteBuffer.allocate((int) newSize);
        buffer.flip();
        newBuffer.put(buffer);
        buffer = newBuffer;
    }

