    public void validate(ClientState state) throws InvalidRequestException
    {
        if (ifNotExists && orReplace)
            throw new InvalidRequestException("Cannot use both 'OR REPLACE' and 'IF NOT EXISTS' directives");


        KeyspaceMetadata ksm = Schema.instance.getKeyspaceMetadata(functionName.keyspace);
        if (null == ksm)
            throw new InvalidRequestException(String.format("Cannot add aggregate '%s' to non existing keyspace '%s'.", functionName.name, functionName.keyspace));
        if (ksm.isVirtual())
            throw new InvalidRequestException("Cannot create aggregates in virtual keyspaces");
    }

