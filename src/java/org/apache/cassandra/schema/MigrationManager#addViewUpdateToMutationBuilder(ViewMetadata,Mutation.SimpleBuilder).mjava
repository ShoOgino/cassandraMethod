    private static void addViewUpdateToMutationBuilder(ViewMetadata view, Mutation.SimpleBuilder builder)
    {
        view.metadata.validate();

        ViewMetadata oldView = Schema.instance.getView(view.keyspace, view.name);
        if (oldView == null)
            throw new ConfigurationException(String.format("Cannot update non existing materialized view '%s' in keyspace '%s'.", view.name, view.keyspace));

        oldView.metadata.validateCompatibility(view.metadata);

        logger.info("Update view '{}/{}' From {} To {}", view.keyspace, view.name, oldView, view);
        SchemaKeyspace.makeUpdateViewMutation(builder, oldView, view);
    }

