    private Pair<RangesAtEndpoint, RangesAtEndpoint> calculateStreamAndFetchRangesMoveForward() throws Exception
    {
        Range<Token> aPrimeRange = new Range<>(oneToken, fourToken);

        RangesAtEndpoint updated = RangesAtEndpoint.of(
                new Replica(aAddress, aPrimeRange, true),
                new Replica(aAddress, eRange, true),
                new Replica(aAddress, dRange, false)
        );

        Pair<RangesAtEndpoint, RangesAtEndpoint> result = StorageService.calculateStreamAndFetchRanges(current, updated);
        assertContentsIgnoreOrder(result.left);
        assertContentsIgnoreOrder(result.right, fullReplica(aAddress, threeToken, fourToken));
        return result;
    }

