    @VisibleForTesting
    void finishAndThrow(boolean throwEarly)
    {
        finishAndMaybeThrow(-1, throwEarly, !throwEarly);
    }

