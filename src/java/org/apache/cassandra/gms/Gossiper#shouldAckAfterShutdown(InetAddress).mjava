    public boolean shouldAckAfterShutdown(InetAddress endpoint)
    {
        Long shutdownTimestamp = shutdownEndpoints.get(endpoint);
        Integer shutdownAnnounce = Integer.getInteger("cassandra.shutdown_announce_in_ms", 2000);
        // Do not temporarily answer to SYN messages coming from shutdown nodes, to avoid reconnecting:
        if (shutdownTimestamp != null && (System.currentTimeMillis() - shutdownTimestamp) < (shutdownAnnounce * 2))
        {
            return false;
        }
        // Otherwise, if allowed to answer, remove the node from the shutdown set
        // (and do this only here, rather than in sendGossip too, to avoid racing between different calling threads):
        else
        {
            shutdownEndpoints.remove(endpoint);
            return true;
        }
    }

