        public boolean shouldReplay(CommitLogPosition position)
        {
            // replay ranges are start exclusive, end inclusive
            Map.Entry<CommitLogPosition, CommitLogPosition> range = persisted.lowerEntry(position);
            return range == null || position.compareTo(range.getValue()) > 0;
        }

