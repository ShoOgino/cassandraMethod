    /**
     * Returns the "logical size" of this <code>BitSet</code>: the index of
     * the highest set bit in the <code>BitSet</code> plus one. Returns zero
     * if the <code>BitSet</code> contains no set bits.
     * 
     * @return the logical size of this <code>BitSet</code>.
     * @since 1.2
     */
    public int length()
    {
        if (wordsInUse == 0)
            return 0;
        
        return BITS_PER_WORD
        * (wordsInUse - 1)
        + (BITS_PER_WORD - Long
                .numberOfLeadingZeros(words[wordsInUse - 1]));
    }

