    public static void thriftClient(InetSocketAddress address, ThriftConsumer fn) throws TException
    {
        try (TTransport transport = new TFramedTransportFactory().openTransport(address.getAddress().getHostAddress(), address.getPort()))
        {
            Cassandra.Client client = new Cassandra.Client(new TBinaryProtocol(transport));
            fn.accept(client);
        }
    }

