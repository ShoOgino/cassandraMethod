    // we don't use endpointsnitch since we are trying to support hadoop nodes that are
    // not necessarily on Cassandra machines, too. This should be adequate for
    // single-DC clusters, at least.
    private Iterator<String> getLocations(final Configuration conf) throws IOException
    {
        try
        {
            for (InetAddress address : InetAddress.getAllByName(InetAddress.getLocalHost().getHostAddress()))
            {
                for (final String location : split.getLocations())
                {
                    InetAddress locationAddress = getInetAddressByName(location);
                    if (address.equals(locationAddress))
                    {
                        // add fall back replicas from same DC via the following
                        // Iterator
                        return new SplitEndpointIterator(location, conf);
                    }
                }
            }
        }
        catch (UnknownHostException e)
        {
            throw new AssertionError(e);
        }
        
        return Arrays.asList(split.getLocations()).iterator();
    }

