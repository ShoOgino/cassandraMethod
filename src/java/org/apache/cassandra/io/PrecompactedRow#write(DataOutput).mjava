    public void write(DataOutput out) throws IOException
    {
        assert buffer.getLength() > 0;
        out.writeLong(buffer.getLength());
        out.write(buffer.getData(), 0, buffer.getLength());
    }

