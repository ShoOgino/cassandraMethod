    private static void checkManifest(CompactionStrategyManager strategyManager, ColumnFamilyStore cfs, Collection<SSTableReader> sstables)
    {
        if (strategyManager.getCompactionParams().klass().equals(LeveledCompactionStrategy.class))
        {
            int maxSizeInMB = (int)((cfs.getCompactionStrategyManager().getMaxSSTableBytes()) / (1024L * 1024L));
            int fanOut = cfs.getCompactionStrategyManager().getLevelFanoutSize();
            List<SSTableReader> repaired = new ArrayList<>();
            List<SSTableReader> unrepaired = new ArrayList<>();

            for (SSTableReader sstable : sstables)
            {
                if (sstable.isRepaired())
                    repaired.add(sstable);
                else
                    unrepaired.add(sstable);
            }
            LeveledManifest.create(cfs, maxSizeInMB, fanOut, repaired);
            LeveledManifest.create(cfs, maxSizeInMB, fanOut, unrepaired);
        }
    }

