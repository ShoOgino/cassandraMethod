    /**
     * Close the segment file.
     */
    synchronized void close()
    {
        discardUnusedTail();
        waitForModifications();
        lastSyncedOffset = buffer.capacity();
        syncComplete.signalAll();
        internalClose();
    }

