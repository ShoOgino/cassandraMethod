    /**
     * Setup and return a new Thrift RPC connection.
     *
     * @param hostName hostname or address to connect to
     * @return a CassandraClient instance
     * @throws ShuffleError
     */
    private CassandraClient getThriftClient(String hostName) throws ShuffleError
    {
        try
        {
            return new CassandraClient(hostName, thriftPort, thriftFramed, thriftUsername, thriftPassword);
        }
        catch (TException e)
        {
            throw new ShuffleError(String.format("Unable to connect to %s/%d: %s", hostName, port, e.getMessage()));
        }
    }

