        private void prepareBlock(int blockIdx, Slice.Bound start, Slice.Bound end) throws IOException
        {
            updateBlock(blockIdx);

            if (partition == null)
                partition = createBuffer(indexes.size());
            else
                partition.clear();

            final FileMark fileMark = mark;
            final long width = currentIndex().width;

            partition.populateFrom(this, start, end, new Tester()
            {
                public boolean isDone()
                {
                    return file.bytesPastMark(fileMark) >= width;
                }
            });
        }

