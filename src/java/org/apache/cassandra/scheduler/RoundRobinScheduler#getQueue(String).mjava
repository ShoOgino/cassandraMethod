    /*
     * Get the Queue for the respective id, if one is not available 
     * create a new queue for that corresponding id and return it
     */
    private SynchronousQueue<Thread> getQueue(String id)
    {
        SynchronousQueue<Thread> queue = queues.get(id);
        if (queue != null)
            // queue existed
            return queue;

        SynchronousQueue<Thread> maybenew = new SynchronousQueue<Thread>(true);
        queue = queues.putIfAbsent(id, maybenew);
        if (queue == null)
            // created new queue
            return maybenew;

        // another thread created the queue
        return queue;
    }

