    public void validate(TableMetadata table)
    {
        /*
         * Index name check is duplicated in Keyspaces, for the time being.
         * The reason for this is that schema altering statements are not calling
         * Keyspaces.validate() as of yet. TODO: remove this once they do (on CASSANDRA-9425 completion)
         */
        Set<String> indexNames = new HashSet<>();
        for (IndexMetadata index : indexesByName.values())
        {
            if (indexNames.contains(index.name))
                throw new ConfigurationException(format("Duplicate index name %s for table %s", index.name, table));

            indexNames.add(index.name);
        }

        indexesByName.values().forEach(i -> i.validate(table));
    }

