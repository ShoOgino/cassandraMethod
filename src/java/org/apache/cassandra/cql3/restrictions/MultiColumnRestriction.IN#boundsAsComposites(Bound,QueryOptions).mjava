        @Override
        public List<Composite> boundsAsComposites(Bound bound, QueryOptions options) throws InvalidRequestException
        {
            CBuilder builder = ctype.builder();
            List<List<ByteBuffer>> splitInValues = splitValues(options);
            // The IN query might not have listed the values in comparator order, so we need to re-sort
            // the bounds lists to make sure the slices works correctly (also, to avoid duplicates).
            TreeSet<Composite> inValues = new TreeSet<>(ctype);
            for (List<ByteBuffer> components : splitInValues)
            {
                for (int i = 0; i < components.size(); i++)
                    checkNotNull(components.get(i), "Invalid null value in condition for column %s", columnDefs.get(i).name);

                Composite prefix = builder.buildWith(components);
                inValues.add(bound.isEnd() && builder.remainingCount() - components.size() > 0
                             ? prefix.end()
                             : prefix);
            }
            return new ArrayList<>(inValues);
        }

