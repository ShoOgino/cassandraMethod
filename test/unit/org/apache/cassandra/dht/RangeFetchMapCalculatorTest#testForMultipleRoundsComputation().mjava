    @Test
    public void testForMultipleRoundsComputation() throws Exception
    {
        Multimap<Range<Token>, InetAddress> rangesWithSources = HashMultimap.create();
        addRangeAndSources(rangesWithSources, 1, 10, "127.0.0.3");
        addRangeAndSources(rangesWithSources, 11, 20, "127.0.0.3");
        addRangeAndSources(rangesWithSources, 21, 30, "127.0.0.3");
        addRangeAndSources(rangesWithSources, 31, 40, "127.0.0.3");
        addRangeAndSources(rangesWithSources, 41, 50, "127.0.0.3", "127.0.0.2");

        RangeFetchMapCalculator calculator = new RangeFetchMapCalculator(rangesWithSources, new ArrayList<RangeStreamer.ISourceFilter>(), "Test");
        Multimap<InetAddress, Range<Token>> map = calculator.getRangeFetchMap();
        validateRange(rangesWithSources, map);

        //We should validate that it streamed from 2 unique sources
        Assert.assertEquals(2, map.asMap().keySet().size());

        assertArrays(Arrays.asList(generateRange(1, 10), generateRange(11, 20), generateRange(21, 30), generateRange(31, 40)),
                map.asMap().get(InetAddress.getByName("127.0.0.3")));
        assertArrays(Arrays.asList(generateRange(41, 50)), map.asMap().get(InetAddress.getByName("127.0.0.2")));
    }

