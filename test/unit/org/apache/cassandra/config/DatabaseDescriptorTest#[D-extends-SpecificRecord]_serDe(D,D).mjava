    protected <D extends SpecificRecord> D serDe(D record, D newInstance) throws IOException
    {
        D actual = SerDeUtils.deserialize(record.getSchema(),
                                              SerDeUtils.serialize(record),
                                              newInstance);
        assert actual.equals(record) : actual + " != " + record;
        return actual;
    }

