    /**
     * Close this writer.
     * <p>
     * This method should be called, otherwise the produced sstables are not
     * guaranteed to be complete (and won't be in practice).
     */
    public void close() throws IOException
    {
        writer.close();
        try
        {
            CommitLog.instance.shutdownBlocking();
        }
        catch (InterruptedException e)
        {
            Thread.currentThread().interrupt();
        }
    }

