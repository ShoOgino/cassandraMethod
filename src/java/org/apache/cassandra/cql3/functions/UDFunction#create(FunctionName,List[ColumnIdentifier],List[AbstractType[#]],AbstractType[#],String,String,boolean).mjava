    public static UDFunction create(FunctionName name,
                                    List<ColumnIdentifier> argNames,
                                    List<AbstractType<?>> argTypes,
                                    AbstractType<?> returnType,
                                    String language,
                                    String body,
                                    boolean deterministic)
    throws InvalidRequestException
    {
        switch (language)
        {
            case "class": return new ReflectionBasedUDF(name, argNames, argTypes, returnType, language, body, deterministic);
            case "java": return JavaSourceUDFFactory.buildUDF(name, argNames, argTypes, returnType, body, deterministic);
            default: throw new InvalidRequestException(String.format("Invalid language %s for '%s'", language, name));
        }
    }

