    public List<Range<Token>> getLocalAndPendingRanges(String ks)
    {
        InetAddressAndPort broadcastAddress = FBUtilities.getBroadcastAddressAndPort();
        Keyspace keyspace = Keyspace.open(ks);
        List<Range<Token>> ranges = new ArrayList<>();
        ranges.addAll(keyspace.getReplicationStrategy().getAddressRanges().get(broadcastAddress));
        ranges.addAll(getTokenMetadata().getPendingRanges(ks, broadcastAddress));
        return Range.normalize(ranges);
    }

