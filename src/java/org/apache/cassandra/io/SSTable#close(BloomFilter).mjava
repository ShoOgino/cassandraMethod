    public void close(BloomFilter bf) throws IOException
    {
        /* Any remnants in the blockIndex should be added to the dump */
        blockIndexes_.add(blockIndex_);
        dumpBlockIndexes();

        /* reset the buffer and serialize the Bloom Filter. */
        DataOutputBuffer bufOut = new DataOutputBuffer();
        BloomFilter.serializer().serialize(bf, bufOut);
        close(bufOut.getData(), bufOut.getLength());
        bufOut.close();
        // byte[] bytes = new byte[bufOut.getLength()];        
        // System.arraycopy(bufOut.getData(), 0, bytes, 0, bufOut.getLength());
        // close(bytes, bytes.length);             
    }

