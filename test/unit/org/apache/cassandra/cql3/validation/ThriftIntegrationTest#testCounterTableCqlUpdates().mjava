    @Test
    public void testCounterTableCqlUpdates() throws Throwable
    {
        populateCounterTable();

        execute(String.format("UPDATE %s.%s set value = value + 1 WHERE key = ? AND column1 = ? AND column2 = ?", KEYSPACE, currentCounterTable()),
                "key1", "ck1", "counter1");
        execute(String.format("UPDATE %s.%s set value = value + 100 WHERE key = 'key2' AND column1 = 'ck1' AND column2 = 'counter1'", KEYSPACE, currentCounterTable()));

        execute(String.format("UPDATE %s.%s set value = value - ? WHERE key = 'key1' AND column1 = 'ck1' AND column2 = 'counter2'", KEYSPACE, currentCounterTable()), 2L);
        execute(String.format("UPDATE %s.%s set value = value - ? WHERE key = 'key2' AND column1 = 'ck1' AND column2 = 'counter2'", KEYSPACE, currentCounterTable()), 100L);

        UntypedResultSet resultSet = execute(String.format("select * from %s.%s", KEYSPACE, currentCounterTable()));
        assertRows(resultSet,
                   row("key1", "ck1", "counter1", 11L),
                   row("key1", "ck1", "counter2", 3L),
                   row("key2", "ck1", "counter1", 110L),
                   row("key2", "ck1", "counter2", -95L));
    }

