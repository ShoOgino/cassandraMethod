    /**
     * returns the appropriate connection based on message type.
     */
    synchronized TcpConnection getConnection(Message msg) throws IOException
    {
        if (MessagingService.responseStage_.equals(msg.getMessageType()))
        {
            if (ackCon == null)
                ackCon = newCon();
            return ackCon;
        }
        else
        {
            if (cmdCon == null)
                cmdCon = newCon();
            return cmdCon;
        }
    }

