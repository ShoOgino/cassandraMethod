    private void addFunctionInternal(Function fun)
    {
        assert fun instanceof UDFunction || fun instanceof UDAggregate;

        KSMetaData oldKsm = getKSMetaData(fun.name().keyspace);
        assert oldKsm != null;
        KSMetaData newKsm = oldKsm.cloneWith(oldKsm.functions.with(fun));
        setKeyspaceDefinition(newKsm);
    }

