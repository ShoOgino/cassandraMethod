    /**
     * Get a list of IndexSearchers from the union of expression index types
     * @param command the query
     * @return the searchers needed to query the index
     */
    public List<SecondaryIndexSearcher> getIndexSearchersFor(ReadCommand command)
    {
        Map<String, Set<ColumnDefinition>> groupByIndexType = new HashMap<>();

        //Group columns by type
        for (RowFilter.Expression e : command.rowFilter())
        {
            SecondaryIndex index = getIndexForColumn(e.column());

            if (index == null || !index.supportsOperator(e.operator()))
                continue;

            Set<ColumnDefinition> columns = groupByIndexType.get(index.indexTypeForGrouping());

            if (columns == null)
            {
                columns = new HashSet<>();
                groupByIndexType.put(index.indexTypeForGrouping(), columns);
            }

            columns.add(e.column());
        }

        List<SecondaryIndexSearcher> indexSearchers = new ArrayList<>(groupByIndexType.size());

        //create searcher per type
        for (Set<ColumnDefinition> column : groupByIndexType.values())
            indexSearchers.add(getIndexForColumn(column.iterator().next()).createSecondaryIndexSearcher(column));

        return indexSearchers;
    }

