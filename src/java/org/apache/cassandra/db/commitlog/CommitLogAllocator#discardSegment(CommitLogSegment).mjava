    /**
     * Indicates that a segment file should be deleted.
     *
     * @param segment segment to be discarded
     */
    private void discardSegment(final CommitLogSegment segment)
    {
        size.addAndGet(-CommitLog.SEGMENT_SIZE);

        queue.add(new Runnable()
        {
            public void run()
            {
                segment.discard();
            }
        });
    }

