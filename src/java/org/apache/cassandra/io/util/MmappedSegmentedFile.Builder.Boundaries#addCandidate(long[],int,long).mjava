            private static int addCandidate(long[] boundaries, int fixedCount, long candidate)
            {
                // check how far we are from the last fixed boundary
                long delta = candidate - boundaries[fixedCount - 1];
                assert delta >= 0;
                if (delta != 0)
                {
                    if (delta <= MAX_SEGMENT_SIZE)
                        // overwrite the unfixed (potential) boundary if the resultant segment would still be mmappable
                        boundaries[fixedCount] = candidate;
                    else if (boundaries[fixedCount] == 0)
                        // or, if it is not initialised, we cannot make an mmapped segment here, so this is the fixed boundary
                        boundaries[fixedCount++] = candidate;
                    else
                        // otherwise, fix the prior boundary and initialise our unfixed boundary
                        boundaries[++fixedCount] = candidate;
                }
                return fixedCount;
            }

