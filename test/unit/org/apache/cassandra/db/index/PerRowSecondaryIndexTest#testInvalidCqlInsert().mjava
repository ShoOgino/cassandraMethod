    @Test
    public void testInvalidCqlInsert()
    {
        // test we can insert if the index validates the expression:
        QueryProcessor.executeInternal(String.format("INSERT INTO \"%s\".\"Indexed1\" (key, indexed) VALUES ('valid','valid')", KEYSPACE1));

        // test we can't insert if the index doesn't validate the key:
        try
        {
            QueryProcessor.executeInternal(String.format("INSERT INTO \"%s\".\"Indexed1\" (key, indexed) VALUES ('invalid','valid')", KEYSPACE1));
            fail("Query should have been invalid!");
        }
        catch (Exception e)
        {
            assertTrue(e.getCause() instanceof InvalidRequestException);
        }

        // test we can't insert if the index doesn't validate the columns:
        try
        {
            QueryProcessor.executeInternal(String.format("INSERT INTO \"%s\".\"Indexed1\" (key, indexed) VALUES ('valid','invalid')", KEYSPACE1));
            fail("Query should have been invalid!");
        }
        catch (Exception e)
        {
            assertTrue(e.getCause() instanceof InvalidRequestException);
        }
    }

