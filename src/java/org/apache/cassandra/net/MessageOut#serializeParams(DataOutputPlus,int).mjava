    private void serializeParams(DataOutputPlus out, int version) throws IOException
    {
        for (int ii = 0; ii < parameters.size(); ii += PARAMETER_TUPLE_SIZE)
        {
            ParameterType type = (ParameterType)parameters.get(ii + PARAMETER_TUPLE_TYPE_OFFSET);
            out.writeUTF(type.key);
            IVersionedSerializer serializer = type.serializer;
            Object parameter = parameters.get(ii + PARAMETER_TUPLE_PARAMETER_OFFSET);

            int valueLength = Ints.checkedCast(serializer.serializedSize(parameter, version));
            if (version >= MessagingService.VERSION_40)
                out.writeUnsignedVInt(valueLength);
            else
                out.writeInt(valueLength);

            serializer.serialize(parameter, out, version);
        }
    }

