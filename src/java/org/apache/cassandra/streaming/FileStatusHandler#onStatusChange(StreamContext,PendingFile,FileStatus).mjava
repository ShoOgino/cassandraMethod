    public static void onStatusChange(StreamContext context, PendingFile pendingFile, FileStatus streamStatus) throws IOException
    {
        if (FileStatus.Action.STREAM == streamStatus.getAction())
        {
            // file needs to be restreamed
            logger.warn("Streaming of file {} from {} failed: requesting a retry.", pendingFile, context);
            MessagingService.instance.sendOneWay(streamStatus.makeStreamStatusMessage(), context.host);
            return;
        }
        assert FileStatus.Action.DELETE == streamStatus.getAction() :
            "Unknown stream action: " + streamStatus.getAction();

        addSSTable(pendingFile);

        // send a StreamStatus message telling the source node it can delete this file
        if (logger.isDebugEnabled())
            logger.debug("Sending a streaming finished message for {} to {}", pendingFile, context);
        MessagingService.instance.sendOneWay(streamStatus.makeStreamStatusMessage(), context.host);
    }

